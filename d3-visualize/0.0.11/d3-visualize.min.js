// d3-visualize Version 0.0.11. Copyright 2017 quantmind.com.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-canvas-transition"),require("object-assign"),require("d3-array"),require("d3-random"),require("d3-collection"),require("d3-let"),require("d3-view"),require("d3-dsv"),require("d3-dispatch"),require("crossfilter"),require("d3-time-format"),require("d3-format"),require("d3-selection"),require("d3-scale"),require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","d3-canvas-transition","object-assign","d3-array","d3-random","d3-collection","d3-let","d3-view","d3-dsv","d3-dispatch","crossfilter","d3-time-format","d3-format","d3-selection","d3-scale","d3-shape"],e):e(t.d3={},t.d3,t.assign,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.crossfilter,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,function(t,e,n,i,r,a,o,s,u,l,d,c,h,f,p,m){"use strict";function v(t){var e=(t.headers.get("content-type")||"").split(";")[0];return"text/plain"===e||"text/csv"===e?t.text().then(u.csvParse):"application/json"===e?t.json():(H("Cannot load content type '"+e+"'"),[])}function g(t,e,n){o.isArray(t)&&(t={store:n,data:t,dimensions:{},series:a.map()}),Object.defineProperties(this,{_inner:{get:function(){return t}},store:{get:function(){return t.store}},data:{get:function(){return t.data}},dimensions:{get:function(){return t.dimensions}},series:{get:function(){return t.series}}}),this.serie=e}function y(t,e){var n=void 0;return e?(e.forEach(function(e){n=e(t),t=n||t}),t):t}function w(t,e,n,i){var r=i.dataName(o.pop(n,"name")),a=[];Object.defineProperties(t,{name:{get:function(){return r}},store:{get:function(){return i}},type:{get:function(){return e}},transforms:{get:function(){return a}},config:{get:function(){return n}}}),t.initialise(n),t.addTransforms(o.pop(n,"transforms")),i.sources.set(r,t),rt.call("init",void 0,t)}function b(t){var e=a.map();Object.defineProperties(this,{sources:{get:function(){return e}}}),this.transforms=n({},it),this.dataCount=0,this.model=t}function x(t,e){return"string"==typeof t&&t.indexOf("%")===t.length-1?ht(.01*parseFloat(t)*e):+t}function C(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=P(t),n.width?n.widthElement=S(t):n.width=ft),n.height||(n.height=D(t),n.height?n.heightElement=O(t):n.height=pt),n.height=x(n.height,n.width),n}function P(t){var e=_(t,"width");if(e)return k(e)}function D(t){var e=_(t,"width");if(e)return A(e)}function S(t){return _(t,"width")}function O(t){return _(t,"height")}function k(t){var e=t.getBoundingClientRect().width,n=f.select(t);return e-q(n.style("padding-left"))-q(n.style("padding-right"))}function A(t){var e=t.getBoundingClientRect().height,n=f.select(t);return e-q(n.style("padding-top"))-q(n.style("padding-bottom"))}function _(t,e){for(var n=t.node?t.node():t;n&&"BODY"!==n.tagName;){if(n.getBoundingClientRect()[e])return n;n=n.parentNode}}function q(t){return t&&"px"==t.substring(t.length-2)?+t.substring(0,t.length-2):0}function M(t){t.forEach(function(t){var e=t.removedNodes;e&&e.length&&e.forEach(function(t){"#text"!==t.nodeName&&(t.__visual__?j.call(t):f.select(t).selectAll(".d3-visual").each(j))})})}function j(){var t=this.__visual__;t?(t.destroy(),s.viewDebug('Removed "'+t.toString()+'" from DOM, '+lt.live.length+" live visuals left")):K("d3-visual without __visual__ object")}function E(t,e){function i(e){var n=this.initialise(e);Object.defineProperties(this,{element:{get:function(){return n}},sel:{get:function(){return f.select(n)}},paperType:{get:function(){return t}}})}return i.prototype=n({},wt,e),lt.papers[t]=i,i}function z(t){return t}function F(t){var e=t.dataStore,n=o.pop(t.options,"data");e||(e=new b(t.model),t.model.dataStore=e),e.addSources(n)}function T(t){var e=t.dataStore,n=o.pop(t,"data");n&&(o.isString(n)&&(n={source:n}),n.name||(n.name=t.model.uid),n=e.addSources(n),n?t.model.$set("data",n.name):K("Could not create data source "+n.name))}function R(t,e){var n=e.options[t];if(void 0!==n&&!o.isObject(n)){var i=n||0;e.options[t]={left:i,right:i,top:i,bottom:i}}}function N(t,e,n){return _t.reduce(function(i,r){return i[r]=x(t[r],qt.indexOf(r)>-1?e:n),i},{})}function W(t){return new t}function $(t,e){var i=t.records,r=t.data,a=t.model,o=e,s=void 0,u=void 0;e=o.splice(0,100),e.forEach(function(t){t.id?(s=t.id?i[t.id]:null,s?t=n(s,t):(r.push(t),i[t.id]=t)):r.push(t),a.columns.forEach(function(e){t[e.name]=e.$parse(t[e.name])})}),t.sel.select("tbody").selectAll("tr").data(r).enter().append("tr").attr("scope","row").selectAll("td").data(a.columns).enter().append("td").style("display",function(t){return t.hidden?"none":null}).html(function(t){return s=this.parentNode.__data__,u=s[t.name],t.$html(void 0===u?"":u)})}n=n&&n.hasOwnProperty("default")?n.default:n,d=d&&d.hasOwnProperty("default")?d.default:d;var B={sigma:.1,drift:0},L=function(t,e){e=n({},B,e);for(var a,o=i.range(0,+t,1),s=e.sigma,u=e.drift,l=[{x:0,y:0}],d=r.randomNormal(0,1),c=1;c<o.length;c++)a=u+s*d(),l[c]={x:c,y:l[c-1].y+a};return l},V={initialise:function(t){this._data=t.data},getConfig:function(t){return o.isArray(t)?{data:t}:o.isObject(t)&&o.isArray(t.data)?t:void 0},getData:function(){return s.resolvedPromise(this.asFrame(this._data))}},H=function(t){s.viewProviders.logger.warn("[d3-data-source] "+t)},U=["http","https","ws","wss"],I=function(t){return o.isString(t)&&U.indexOf(t.split("://")[0])>-1},Y={getConfig:function(t){return I(t)?{url:t}:o.isObject(t)&&t.url?t:void 0},initialise:function(t){this.url=t.url},getData:function(){var t=s.viewProviders.fetch,e=this;return t?t(this.url).then(v).then(function(t){return e.asFrame(t)}):(H("fetch provider not available, cannot submit"),s.resolvedPromise([]))}},X={initialise:function(t){this.source=t.source},getConfig:function(t){if(o.isObject(t)&&t.source)return o.isArray(t.source)||(t.source=[t.source]),t},getData:function(){var t=this.store,e=this,n=void 0;return Promise.all(this.source.map(function(e){return t.getData(e)})).then(function(t){return n=1===t.length?t[0]:e.mergeFrames(t),e.asFrame(n)})},mergeFrames:function(t){return t[0]}},G={initialise:function(t){this.expression=s.viewExpression(t.expression)},getConfig:function(t){if(o.isObject(t)&&t.expression)return t},getData:function(){var t=this,e=this.store.model;return s.resolvedPromise(this.expression.eval(e)).then(function(e){return t.asFrame(e)})}},J=function(t){return function(e){return e[t]}};g.prototype={size:function(){return this.data.length},new:function(t){return o.isArray(t)?new g(t,null,this.store):new g(this._inner,t)},cf:function(){return this._inner.cf||(this._inner.cf=d(this.data)),this._inner.cf},dimension:function(t,e,n){1===arguments.length&&(n=!0);var i=this.dimensions[t];if(i){if(n)return i;i.dispose()}return e||(e=J(t)),this.dimensions[t]=this.cf().dimension(e),this.dimensions[t]},add:function(){},map:function(t){return this.new(this.data.map(t))}};var K=function(t){s.viewProviders.logger.warn("[d3-visualize] "+t)},Q=function(t){function e(t){if(n){var e=t.dimension(n);return t.new(e.group())}}var n=t.dimension;return n||K('Filter transform requires a "dimenstion" entry'),e},Z=function(t){function e(t){if(n){if(i){var e,r=t.dimension(i),a=r.group().top(1/0),o=t.new([]);return a.forEach(function(i){e=t.new(r.filterExact(i.key).top(1/0)).dimension(n).group().top(1/0),o.series.set(i.key,t.new(e).dimension("key").top(1/0))}),o}return t.new(t.dimension(n).top(1/0))}return t}var n=t.sortby,i=t.groupby;return n||K('timeseries transform requires a "sortby" entry'),e},tt={dataSource:null,size:{width:null,height:"70%"}};tt.dateFormat="%d-%b-%y";var et={date:function(t){return c.utcParse(t.dateFormat||tt.dateFormat)},number:function(){return parseFloat}},nt=function(t){function e(t){var e=[];return i.each(function(t,n){o.isString(t)&&(t={type:t}),s=et[t.type],s?e.push([n,s(t)]):K("Cannot convert field "+n+" to type "+t.type)}),e.length&&(t=t.map(function(t){for(r=0;r<e.length;++r)t[e[r][0]]=e[r][1](t[e[r][0]]);return t})),t}t=n({},tt.dateFormat,t);var i=a.map(t.fields),r=void 0,s=void 0;return e},it=a.map({filter:Q,mapfields:nt,timeseries:Z}),rt=l.dispatch("init","data"),at={getConfig:function(){},initialise:function(){},getData:function(){},addTransforms:function(t){var e=this,n=void 0;t&&(o.isArray(t)||(t=[t]),t.forEach(function(t){n=it.get(t.type),n?e.transforms.push(n(t)):K('Transform "'+t.type+'" not known')}))},asFrame:function(t){return o.isArray(t)&&(t=t.map(function(t){return t.constructor!==Object&&(t={data:t}),t}),t=new g(t,null,this.store)),y(t,this.transforms)}},ot=n(a.map(),{events:rt,add:function(t,e){function i(e,n){w(this,t,e,n)}return i.prototype=n({},at,e),this.set(t,i),i},create:function(t,e){for(var n,i=this.values(),r=0;r<i.length;++r)if(n=i[r].prototype.getConfig(t))return new i[r](n,e)}});ot.add("array",V),ot.add("remote",Y),ot.add("composite",X),ot.add("expression",G),b.prototype={size:function(){return this.sources.size()},addSources:function(t){if(o.isString(t)&&(t={source:t}),o.isArray(t)){var e=this;return t.map(function(t){return ot.create(t,e)})}if(t)return ot.create(t,this)},addTransforms:function(t){n(this.transforms,t)},source:function(t,e){if(1===arguments.length)return this.sources.get(t);if(null===e){var n=this.sources.get(t);return this.sources.remove(t),n}return this.sources.set(t,e),this},clearCache:function(){this.sources.each(function(t){delete t.cachedFrame})},getData:function(t){var e=this.sources.get(t);if(!e)throw new Error("Data source "+t+" not available");return e.cachedFrame?s.resolvedPromise(e.cachedFrame):e.getData().then(function(t){return e.cachedFrame=t,t})},dataName:function(t){return this.dataCount++,t?""+t:this.source("default")?"source"+this.dataCount:"default"}};var st={formatDate:c.timeFormat("%d/%m/%Y"),formatDateTime:c.timeFormat("%a %e %b %X %Y"),load:function(t){var e=this,n=ot.create("https://unpkg.com/d3-format/locale/"+t+".json"),i=ot.create("https://unpkg.com/d3-time-format/locale/"+t+".json");return Promise.all([n.load().then(function(n){e.symbol=t,e.number=n,h.formatDefaultLocale(n)}),i.load().then(function(t){e.time=t,e.formatDate=c.timeFormat(t.date),e.formatDateTime=c.timeFormat(t.dateTime),c.timeFormatDefaultLocale(t)})])}},ut=["visual","container"],lt={live:[],types:{},papers:{},events:l.dispatch("before-init","after-init","before-draw","after-draw")},dt=n({},{initialise:function(){},draw:function(){},select:function(t){return f.select(t)},destroy:function(){},getModel:function(t){t||(t=this.visualType);var e=this.model[t];if(!e&&t in tt){var n=o.pop(this.options,t);this.visualParent?e=this.visualParent.getModel(t).$child(n):(e=this.model.$new(tt[t]),e.$update(n)),this.model[t]=e}return e}},s.viewBase),ct=function(t,e){function i(e,n,i,r){Object.defineProperties(this,{visualType:{get:function(){return t}},isViz:{get:function(){return-1===ut.indexOf(t)}}}),this.visualParent=i,this.model=i?i.model.$new():r||s.viewModel(),this.options=n||{},lt.events.call("before-init",void 0,this),this.initialise(e),lt.events.call("after-init",void 0,this)}var r=o.pop(e,"options");return r&&(tt[t]=r),i.prototype=n({},dt,e),lt.types[t]=i,i},ht=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},ft=400,pt="75%",mt=ct("visual",{options:{render:"svg",width:null,height:"70%",heightElement:null},initialise:function(t){if(!t)throw new Error("HTMLElement required by visual group");if(this.visualParent&&"container"!==this.visualParent.visualType)throw new Error("Visual parent can be a container only");Object.defineProperties(this,{element:{get:function(){return t}},sel:{get:function(){return f.select(t)}},size:{get:function(){return[this.width,this.height]}}}),this.sel.classed("d3-visual",!0),this.layers=[],this.drawCount=0,lt.live.push(this),t.__visual__=this},toString:function(){return"visual "+this.model.uid},draw:function(){this.drawCount?(this.drawCount++,this.clear()):(this.drawCount=1,this.fit()),lt.events.call("before-draw",void 0,this),this.layers.forEach(function(t){t.draw()}),lt.events.call("after-draw",void 0,this)},clear:function(){},addVisual:function(t){var e=o.pop(t,"type"),n=lt.types[e];if(n)return new n(this.element,t,this);K("Cannot add visual "+t.type)},fit:function(){var t=C(this.element.parentNode,this.getModel());this.width=t.width,this.height=t.height,this.sel.style("width",this.width+"px").style("height",this.height+"px")},resize:function(t){t||(t=C(this.element.parentNode,this.getModel()));var e=this.size;e[0]===t.width&&e[1]===t.height||(s.viewDebug('Resizing "'+this.toString()+'"'),this.width=t.width,this.height=t.height,this.sel.style("width",this.width+"px").style("height",this.height+"px"),this.draw())},destroy:function(){var t=lt.live.indexOf(this);t>-1&&lt.live.splice(t,1)}});if(o.inBrowser){new MutationObserver(M).observe(document.documentElement,{childList:!0,subtree:!0})}var vt=function(t){for(var e=[{},gt,yt],i=1;i<arguments.length;++i)e.push(arguments[i]);return ct(t,n.apply(void 0,e))},gt={initialise:function(t){var e=this.visualParent;if(e){if("visual"!==e.visualType)throw new Error("visual parent of "+this.visualType+' can only be "visual"')}else this.visualParent=e=new mt(t,this.options,null,this.model),this.model=e.model.$new(),this.options={};e.layers.push(this)},paper:function(){var t=this.getModel("visual"),e=this._paper;if(e&&e.paperType===t.render)return e;var n=lt.papers[t.render];if(!n)throw new Error("Unknown paper "+t.render);return e=new n(this),this._paper=e,e},translate:function(t,e){return o.isFunction(t)?function(n){return"translate("+(t(n)||0)+", "+(e(n)||0)+")"}:"translate("+t+", "+e+")"}},yt={draw:function(){var t=this;lt.events.call("before-draw",void 0,this),this.getData().then(function(e){e&&(t.doDraw(e),lt.events.call("after-draw",void 0,t))})}},wt={initialise:function(){},transition:function(){},size:function(t){return this.sel.attr("width",t.width).attr("height",t.height),this},group:function(t,e){e||(e="main");var n=this.sel;return n.selectAll("."+e).data([0]).enter().append("g").classed(e,!0),n.select("."+e)},dim:function(t){return t}},bt=E("svg",{initialise:function(t){return t.visualParent.sel.append("svg").attr("id",t.model.uid).classed(t.visualType,!0).node()}}),xt=ct("container"),Ct={props:["schema","datasource","plugins"],render:function(t,e,n){var i=this,r=this.select(n).html();return this.getSchema(t.schema,function(t){return o.isObject(t)||(t={}),i.build(t,r,e)})},getSchema:function(t,e){var n=this.model.visual;if(n&&n!==this.model&&o.isString(t)){var i=n.options.visuals[t];i&&(t=i)}return o.isString(t)?this.json(t).then(e):e(t)},build:function(){}},Pt=n({},Ct,{build:function(t,e,n){var i=this.model,r=this.createElement("div");return n.class&&r.attr("class",n.class),t.visuals||(t.visuals={}),i.visual=new xt(r.node(),t,i.visual),this.mountInner(r,e)}}),Dt=n({},Ct,{build:function(t){var e=this.createElement("div"),n=t.type||"visual",i=this.model,r={};return"visual"===n?r=t:r.visual=o.pop(t,"visual")||{},i.visual=new mt(e.node(),r,i.visual),"visual"!==n&&i.visual.addVisual(t),e},mounted:function(){this.model.visual.draw()}}),St={date:c.isoParse,string:function(t){return""+t}},Ot={number:function(t){return t},date:function(t){return st.formatDate(t)},boolean:function(t){return t}},kt=function(t){var e=[],n=void 0;if(!t)return e;if(o.isArray(t)&&(t={properties:t}),o.isObject(t.properties))for(var i in t.properties)n=t.properties[i],o.isObject(n)&&(n.name||(n.name=i),e.push(n));else Array.prototype.push.apply(e,t.properties);return e.map(function(t){return o.isObject(t)||(t={name:t}),t.label||(t.label=t.name),t.hidden||(t.hidden=!1),t.$parse||(t.$parse=St[t.type]||St.string),t.$html||(t.$html=Ot[t.type]||z),t})};if(gt.getData=function(){var t=this.model.data;return t?this.dataStore.getData(t):(K("Visual without data name, cannot get data"),s.resolvedPromise())},lt.events.on("before-init.data",function(t){t.isViz&&(t.data=o.pop(t.options,"data"))}),lt.events.on("after-init.data",function(t){Object.defineProperties(t,{dataStore:{get:function(){return t.visualParent?t.visualParent.dataStore:t.model.dataStore}}}),t.isViz?T(t):F(t)}),tt.resizeDelay||(tt.resizeDelay=200),o.inBrowser){var At=s.viewDebounce(function(){lt.live.forEach(function(t){return t.resize()})},tt.resizeDelay);f.select(window).on("resize.visuals",At)}tt.title={text:null,fontSize:"10px"},lt.events.on("after-init.title",function(t){var e=t.options.title;o.isString(e)&&(t.options.title={text:e})});var _t=["top","bottom","left","right"],qt=["left","right"];tt.margin={top:20,bottom:20,left:20,right:20},tt.padding={top:0,bottom:0,left:0,right:0},gt.boundingBox=function(){var t=this.visualParent.width,e=this.visualParent.height,n=N(this.getModel("margin"),t,e),i=N(this.getModel("padding"),t,e),r=_t.reduce(function(t,e){return t[e]=n[e]+i[e],t},{});return{width:t,height:e,margin:n,padding:n,total:r,innerWidth:t-r.left-r.right,innerHeight:e-r.top-r.bottom}},lt.events.on("after-init.margin",function(t){t.margin=R("margin",t),t.padding=R("padding",t)});var Mt=a.map();tt.color={scale:"cool",stroke:"#333",strokeOpacity:1,fillOpacity:1},Mt.set("viridis",function(){return p.scaleSequential(p.interpolateViridis)}),Mt.set("inferno",function(){return p.scaleSequential(p.interpolateInferno)}),Mt.set("magma",function(){return p.scaleSequential(p.interpolateMagma)}),Mt.set("plasma",function(){return p.scaleSequential(p.interpolatePlasma)}),Mt.set("warm",function(){return p.scaleSequential(p.interpolateWarm)}),Mt.set("cool",function(){return p.scaleSequential(p.interpolateCool)}),Mt.set("rainbow",function(){return p.scaleSequential(p.interpolateRainbow)}),Mt.set("cubehelix",function(){return p.scaleSequential(p.interpolateCubehelixDefault)}),gt.colorScale=function(){var t=this.getModel("color"),e=Mt.get(t.scale);if(!e)throw new Error("Unknown scale "+t.scale);return e()};var jt=function(t,e){return t.require("clusterize.js@0.17.6").then(function(t){return W(t)})},Et=function(t){return t},zt={over:!0,small:!0,bordered:!0,loadingClass:"table-info",loadingTextClass:"text-center"},Ft=function(t,e){var i=t.model.style;i.$update(n({},zt,e)),i.tableClass="table table-responsive",i.striped&&(i.tableClass+=" table-striped"),i.over&&(i.tableClass+=" table-hover"),i.bordered&&(i.tableClass+=" table-bordered"),i.small&&(i.tableClass+=" table-sm")},Tt={bootstrap:Ft,clusterize:jt,paginate:Et},Rt=n({},Ct,{model:function(){return{header:!0,columns:[],loadingData:!1,style:{tableClass:null,headerClass:null,headerRowClass:null,loadingClass:"loading",loadingTextClass:null}}},build:function(t){var e=this,n=this.model,i=t.plugins||[];if(this.records={},this.data=[],this.template='<table d3-class="[style.tableClass, loadingData ? \'loading\' : null]">\n<thead d3-class="style.headerClass">\n<tr d3-class="style.headerRowClass">\n  <th d3-for="col in columns"\n        d3-html="col.label"\n        d3-if="!col.hidden">\n  </th>\n</tr>\n<tr d3-if="loadingData" d3-class="style.loadingClass">\n    <td d3-attr-colspan="columns.length">\n        <p d3-class="style.loadingTextClass">loading data</p>\n    </td>\n</tr>\n</thead>\n<tbody></tbody>\n</table>',n.columns=kt(t),o.isArray(i)){var r=[],a=void 0;if(i.forEach(function(t){o.isString(t)&&(t={name:t}),Tt[t.name]?(a=Tt[t.name](e,t),o.isPromise(a)&&r.push(a)):K("Unknown table plugin "+t.name)}),r.length)return Promise.all(r).then(function(){return e.viewElement(e.template)})}else K("plugins should be an array");return this.viewElement(this.template)},mounted:function(){var t=this,e=this.model;if(e.dataLoader){var n=e.dataLoader.load(e.columns);n&&(e.loadingData=!0,n.then(function(n){e.loadingData=!1,$(t,n)},function(t){return e.loadingData=!1,t}))}}}),Nt={tabularPlugins:Tt,install:function(t){t.addComponent("dashboard",Pt),t.addComponent("visual",Dt),t.addComponent("tabular",Rt)}},Wt=function(t){return function(){return t}},$t=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Bt=function(t){return t},Lt=function(){function t(t){var a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,c=void 0,h=void 0,f=void 0,p=void 0,m=void 0,v=t.length,g=.5*r/i,y=new Array(v),w=new Array(v);for(a=0;a<v;++a)y[w[a]=a]=+e(t[a],a,t);for(w.sort(function(t,e){return $t(y[t],y[e])}),f=y[w[0]],d=null,a=v-1;a>=0;--a)u=[],null===d?u.push([0,0]):(h=d+p,c=h*g,u.push([-c,h]),u.push([c,h])),o=w[a],s=v-a-1,l=y[o]/f,m=Math.sqrt(l),d=i*m,p=a?n(m,s):0,h=d-p,c=h*g,u.push([c,h]),u.push([-c,h]),y[o]={index:s,value:y[o],fraction:l,points:u};return y}var e=Bt,n=Wt(0),i=1,r=1;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Wt(+n),t):e},t.base=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(i=e,t):i},t.pad=function(e){return arguments.length?(n="function"==typeof e?e:Wt(+e),t):n},t},Vt=vt("barchart",{options:{orientation:"vertical",stack:!1},doDraw:function(){}}),Ht={fill:function(t){function e(t,e){return n(e)}var n=this.colorScale().domain([0,t.length-1]);return e.scale=n,e},curve:function(t){var e=m[this.curveName(t)];return e||(K('Could not locate curve type "'+t+'"'),t=this.curveName("cardinalOpen"),e=m[t]),e},curveName:function(t){return"curve"!==t.substring(0,5)&&(t="curve"+t[0].toUpperCase()+t.substring(1)),t}},Ut=vt("linechart",Ht,{options:{lineWidth:1,curve:"cardinalOpen",x:"x",y:"y"},doDraw:function(t){var e=this,n=this.newRange(),i=this.getModel(),r=this.getModel("color"),a=J(i.x),o=J(i.y),s=t.series.values(),u=t.series.keys().map(function(t,i){return{index:i,label:t,range:e.range(s[i],a,o,n)}}),l=this.boundingBox(),d=this.paper(),c=d.size(l).group().attr("transform",this.translate(l.total.left,l.total.top)).selectAll(".line").data(s),h=this.fill(u),f=m.line().x(this.x(l,n.x)).y(this.y(l,n.y)).curve(this.curve(i.curve));c.enter().append("path").attr("class","line").attr("fill","none").attr("stroke",h).attr("stroke-opacity",0).attr("stroke-width",i.lineWidth).merge(c).attr("stroke",h).attr("stroke-opacity",r.strokeOpacity).attr("stroke-width",i.lineWidth).attr("d",f),c.exit().remove()},x:function(t,e){var n=this.getModel(),r=p.scaleLinear().domain(i.extent(e)).range([0,t.innerWidth]);return function(t){return r(t[n.x])}},y:function(t,e){var n=this.getModel(),r=p.scaleLinear().domain(i.extent(e)).range([t.innerHeight,0]);return function(t){return r(t[n.y])}},range:function(t,e,n,r){var a={x:i.extent(t,e),y:i.extent(t,n)};r&&(Array.prototype.push.apply(r.x,a.x),Array.prototype.push.apply(r.y,a.y))},newRange:function(){return{x:[],y:[]}}}),It=Math.PI,Yt=It/180,Xt={fill:function(t){function e(t){return n(t.index)}var n=this.colorScale().domain([0,t.length-1]);return e.scale=n,e},proportionalData:function(t,e){return t.dimension(e).top(1/0)}},Gt=vt("piechart",Xt,{options:{field:"data",startAngle:0,endAngle:360,sort:!1,innerRadius:0,padAngle:0,cornerRadius:0,color:null,lineWidth:1,colorOpacity:1,fillOpacity:1},doDraw:function(t){var e=this.getModel(),n=this.getModel("color"),i=e.field,r=this.boundingBox(),a=Math.min(r.innerWidth,r.innerHeight)/2,o=x(e.innerRadius,a),s=m.pie().padAngle(Yt*e.padAngle).startAngle(Yt*e.startAngle).endAngle(Yt*e.endAngle).value(function(t){return t[i]}),u=m.arc().innerRadius(o).outerRadius(a).cornerRadius(e.cornerRadius),l=this.paper(),d=s(this.proportionalData(t,i)),c=this.fill(d),h=l.size(r).group().attr("transform",this.translate(r.total.left+r.innerWidth/2,r.total.top+r.innerHeight/2)).selectAll(".slice").data(d);h.enter().append("path").attr("class","slice").attr("stroke",n.stroke).attr("stroke-opacity",0).attr("fill-opacity",0).attr("fill",c).attr("stroke-width",e.lineWidth).merge(h).attr("stroke",n.stroke).attr("stroke-opacity",n.strokeOpacity).attr("d",u).attr("fill",c).attr("fill-opacity",n.fillOpacity),h.exit().remove()}}),Jt=function(t){return{draw:function(e){t.forEach(function(t,n){n?e.lineTo(t[0],t[1]):e.moveTo(t[0],t[1])}),e.closePath()}}},Kt=vt("pyramidchart",Xt,{options:{field:"data",pad:0,lineWidth:1},doDraw:function(t){var e=this.getModel(),n=e.field,i=this.getModel("color"),r=this.boundingBox(),a=x(e.pad,Math.min(r.innerWidth,r.innerHeight)),o=Lt().base(r.innerWidth).height(r.innerHeight).pad(a).value(function(t){return t[n]}),s=o(this.proportionalData(t,n)),u=m.symbol().type(function(t){return Jt(t.points)}).size(1),l=this.fill(s),d=this.paper(),c=d.size(r).group().attr("transform",this.translate(r.total.left+r.innerWidth/2,r.total.top)).selectAll(".segment").data(s);c.enter().append("path").attr("class","segment").attr("stroke",i.stroke).attr("stroke-opacity",0).attr("fill-opacity",0).attr("fill",l).attr("stroke-width",e.lineWidth).merge(c).attr("stroke",i.stroke).attr("stroke-opacity",i.strokeOpacity).attr("d",u).attr("fill",l).attr("fill-opacity",i.fillOpacity),c.exit().remove()}}),Qt=vt("treemap",{requires:["d3-treemap"]});t.visualizeVersion="0.0.11",t.randomPath=L,t.DataStore=b,t.dataSources=ot,t.dataLocale=st,t.visuals=lt,t.Visual=mt,t.crateChart=vt,t.cratePaper=E,t.Svg=bt,t.visualComponents=Nt,t.colorScales=Mt,t.pyramid=Lt,t.BarChart=Vt,t.LineChart=Ut,t.PieChart=Gt,t.PyramidChart=Kt,t.Treemap=Qt,Object.defineProperty(t,"__esModule",{value:!0})});