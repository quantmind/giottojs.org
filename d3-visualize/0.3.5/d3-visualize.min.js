!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-let"),require("d3-array"),require("d3-random"),require("d3-collection"),require("d3-view"),require("d3-dsv"),require("crossfilter"),require("d3-dispatch"),require("d3-time-format"),require("d3-selection"),require("d3-transition"),require("d3-scale"),require("d3-format"),require("d3-axis"),require("d3-shape"),require("d3-color"),require("d3-svg-legend"),require("d3-brush")):"function"==typeof define&&define.amd?define(["exports","d3-let","d3-array","d3-random","d3-collection","d3-view","d3-dsv","crossfilter","d3-dispatch","d3-time-format","d3-selection","d3-transition","d3-scale","d3-format","d3-axis","d3-shape","d3-color","d3-svg-legend","d3-brush"],e):e(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.crossfilter,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,function(t,e,n,i,r,a,o,s,l,u,d,c,h,f,p,g,m,v,y){"use strict";function x(t,n,i){e.isArray(t)&&(t={store:i,data:t,dimensions:{},series:r.map()}),Object.defineProperties(this,{_inner:{get:function(){return t}},store:{get:function(){return t.store}},data:{get:function(){return t.data}},dimensions:{get:function(){return t.dimensions}},series:{get:function(){return t.series}},type:{get:function(){return"dataframe"}}}),this.serie=n}function b(t){this.frames=r.map(),Object.defineProperties(this,{store:{get:function(){return t}},type:{get:function(){return"frameCollection"}}})}function w(t,e){return t.reduce(function(t,n){return void 0!==e(n)&&(t+=1),t},0)}function k(t,n,i){if(e.isArray(i)?t=t.new(i):i&&(t=i),n.length){var r=n.splice(0,1)[0],a=r?r(t):null;return e.isPromise(a)?a.then(function(e){return k(t,n,e)}):k(t,n,a)}return t}function z(t){var n=r.map();Object.defineProperties(this,{sources:{get:function(){return n}}}),this.transforms=e.assign({},st),this.dataCount=0,this.model=t&&e.isFunction(t.$child)?t:a.viewModel(t)}function M(t,e){return"string"==typeof t&&t.indexOf("%")===t.length-1?ct(.01*parseFloat(t)*e):+t}function S(t,e){for(var n=t.node?t.node():t;n&&"BODY"!==n.tagName;){if(n.getBoundingClientRect()[e])return n;n=n.parentNode}}function _(t){return t&&"px"==t.substring(t.length-2)?+t.substring(0,t.length-2):0}function O(t){if(e.isArray(t))return t.map(O);if(e.isObject(t)){var n={};for(var i in t)n[i]=O(t[i]);return n}return t}function P(){var t=this.__visual__;t?(t.destroy(),a.viewDebug('Removed "'+t.toString()+'" from DOM, '+gt.live.length+" live visuals left")):Z("d3-visual without __visual__ object")}function A(t,n){function i(e,n){var i=this.initialise(e,n);Object.defineProperties(this,{element:{get:function(){return i}},sel:{get:function(){return d.select(i)}},paperType:{get:function(){return t}}})}return i.prototype=e.assign({},zt,n),gt.papers[t]=i,i}function C(t,n){var i=n.options[t];void 0===i||e.isObject(i)||(n.options[t]=E(i||0))}function T(t,e,n){return At.reduce(function(i,r){return i[r]=M(t[r],Ct.indexOf(r)>-1?e:n),i},{})}function W(t){delete t.__boundingBox,e.isArray(t.layers)&&t.layers.forEach(W)}function E(t){return{left:t,right:t,top:t,bottom:t}}function j(t,n,i,r){var a=Tt.get(t)(n).tickSize(i.tickSize);return null!==i.tickSizeOuter&&a.tickSizeOuter(i.tickSizeOuter),e.isDate(r)?a.tickFormat(u.timeFormat(i.timeFormat)):null!==i.format&&a.tickFormat(f.format(i.format)),a.ticks(i.ticks)}function q(t,e,n){t.select("path.domain").attr("stroke",e.stroke);var i=t.selectAll("text").attr("fill",e.stroke);if(e.hide){var r=n.range();Math.abs(r[0]-r[r.length-1])<e.hide?t.style("opacity",0):t.style("opacity",1)}e.rotate&&i.attr("transform","rotate("+e.rotate+")").style("text-anchor",e.ancor)}function H(t,e,n,i){this.data=t,this.stacked=i,this.x=e,this.y=n}function F(t){this.vertical=!0,this.init(t),this.sx.rangeRound([0,this.box.innerWidth]),this.sy.rangeRound([this.box.innerHeight,0])}function D(t){this.init(t),this.sx.rangeRound([0,this.box.innerHeight]),this.sy.rangeRound([0,this.box.innerWidth])}s=s&&s.hasOwnProperty("default")?s.default:s;var B={sigma:.1,drift:0},Y={initialise:function(t){this._data=t.data},getConfig:function(t){return e.isArray(t)?{data:t}:e.isObject(t)&&e.isArray(t.data)?t:void 0},getData:function(){return a.resolvedPromise(this.asFrame(this._data))}},R=function(t){a.viewProviders.logger.warn("[d3-data-source] "+t)},L=["http","https","ws","wss"],X=r.set(["text/plain","text/csv","application/vnd.ms-excel"]),G={getConfig:function(t){return function(t){return e.isString(t)&&L.indexOf(t.split("://")[0])>-1}(t)?{url:t}:e.isObject(t)&&t.url?t:void 0},initialise:function(t){this.url=t.url},getData:function(){var t=a.viewProviders.fetch,e=this;return t?t(this.url).then(function(t){var e=(t.headers.get("content-type")||"").split(";")[0];return X.has(e)?t.text().then(o.csvParse):"text/tab-separated-values"===e?t.text().then(o.tsvParse):"application/json"===e?t.json():(R("Cannot load content type '"+e+"'"),[])}).then(function(t){return e.asFrame(t)}):(R("fetch provider not available, cannot submit"),[])}},V=function(t){return function(e){return e[t]}};x.prototype={dataFrame:function(){return this},size:function(){return this.data.length},new:function(t){return e.isArray(t)?new x(t,null,this.store):new x(this._inner,t)},cf:function(){return this._inner.cf||(this._inner.cf=s(this.data)),this._inner.cf},dimension:function(t,e,n){1===arguments.length&&(n=!0);var i=this.dimensions[t];if(i){if(n)return i;i.dispose()}return e||(e=V(t)),this.dimensions[t]=this.cf().dimension(e),this.dimensions[t]},sortby:function(t,e){return this.new(this.dimension(t).top(e||1/0))},pivot:function(t,e,n,i){function r(r){var a=void 0,o=void 0;return function(s,l){return a=""+l[e],o=r*l[n],s[t]=l[t],a in s?s[a]+=o:s[a]=o,i in s?s[i]+=o:s[i]=o,s}}var a=this.dimension(t).group();return i||(i="total"),this.new(a.reduce(r(1),r(-1),Object).all().map(function(t){return t.value}))},add:function(){},map:function(t){return this.new(this.data.map(t))}};var $={initialise:function(t){this.source=t.source},getConfig:function(t){if(e.isObject(t)&&t.source)return e.isArray(t.source)||(t.source=[t.source]),t},getData:function(t){var e=this.store,n=this.source,i=this;return Promise.all(n.map(function(n){return e.getData(n,t)})).then(function(t){var r=void 0;return 1===t.length?r=t[0]:i.config.merge?r=i.mergeFrames(t):(r=new b(e),t.forEach(function(t,e){r.frames.set(n[e],t)})),i.asFrame(r)})},mergeFrames:function(t){return t[0]}};b.prototype={new:function(t){return new x(t,null,this.store)},dataFrame:function(){for(var t=this.frames.values(),e=0;e<t.length;++e)if("dataframe"===t[e].type)return t[e]}};var N={initialise:function(t){this.expression=a.viewExpression(t.expression)},getConfig:function(t){if(e.isObject(t)&&t.expression)return t},getData:function(t){var n=this,i=this.store.model.$child(t),r=this.expression.eval(i);return e.isPromise(r)?r.then(function(t){return n.asFrame(t)}):n.asFrame(r)}},K=function(t){function e(t){return r.validate(t)?function(e){return n(e,t)}:r.logError()}var n=t.transform,i=t.schema||{},r=a.viewProviders.jsonValidator?a.viewProviders.jsonValidator(t.schema):I;return i.type||(i.type="object"),e.schema=i,e},I={validate:function(){return!0}},U=K({schema:{description:"The filter transform removes objects from a data frame based on a provided filter expression",properties:{expr:{type:"string"}},required:["expr"]},transform:function(t,e){var n=a.viewExpression(e.expr);return t.data.reduce(function(e,i,r){return n.safeEval({d:i,index:r,frame:t})&&e.push(i),e},[])}}),Z=function(t,e){a.viewProviders.logger.warn("[d3-visualize] "+t),e&&a.viewProviders.logger.error(e.stack)},J=r.map({count:w,max:n.max,min:n.min,sum:n.sum,mean:n.mean,median:n.median,variance:n.variance,deviation:n.deviation}),Q=r.map({count:function(t){return t+1},sum:function(t,e){return t+e},max:Math.max,min:Math.min}),tt={dataSource:null,size:{width:null,height:"70%"}};tt.dateFormat="%d-%b-%y";var et={date:function(t){return u.utcParse(t.dateFormat||tt.dateFormat)},number:function(){return parseFloat}},nt=K({shema:{description:"map a field values into another type",properties:{fields:{type:"object"},dateFormat:{type:"string"}},required:["fields"]},transform:function(t,n){var i=[],a=void 0,o=void 0;return r.map(n.fields).each(function(t,n){e.isString(t)&&(t={type:t}),(o=et[t.type])?i.push([n,o(t)]):Z("Cannot convert field "+n+" to type "+t.type)}),i.length&&(t=t.map(function(t){for(a=0;a<i.length;++a)t[i[a][0]]=i[a][1](t[i[a][0]]);return t})),t}}),it=function(t,e,n){return void 0!==n&&(t=Math.min(t,n)),void 0===e?t:Math.max(t,e)},rt=K({shema:{description:"Create moving average series from existing one. The new series override the existing one unless the as array is provided",properties:{method:{type:"string"},alpha:{type:"number"},period:{type:"number"},fields:{type:"array",items:{type:"string"}},as:{type:"array",items:{type:"string"}}},required:["fields"]},transform:function(t,e){var n=e.as||[],i=e.method||"ema",r=void 0,a=void 0,o=void 0;e.fields.forEach(function(s,l){if(r=n[l]||s,"sma"===i){var u=Math.max(e.period||10,1),d=[],c=[];t.data.forEach(function(t,e){a=t[s],d.length===u&&(a-=c.splice(0,1)[0]),c.push(a),e&&(a+=d[d.length-1]),d.push(a),t[r]=a/d.length})}else{var h=it(e.alpha||.5,1-.999999,.999999);t.data.forEach(function(t,e){a=t[s],o=e?h*o+(1-h)*a:a,t[r]=o})}})}}),at=K({schema:{description:"Group entries which are below a given aggregate cutoff",properties:{field:{type:"string"},cutoff:{type:"number"}},required:["field","cutoff"]},transform:function(t,e){var i=V(e.field),r=n.sum(t.data,i),a=[],o=0;return t.dimension(e.field).bottom(1/0).reduce(function(t,n){return(o+=i(n))/r<e.cutoff?a.push(n):a?(a.push(n),(n={label:"other",children:a})[e.field]=o,a=null,t.push(n)):t.push(n),t},[])}}),ot=K({schema:{description:"Perfrom a difference for a group of fields along a dimension. It is possible to perform a difference for different groups",properties:{dimension:{type:"string"},period:{type:"integer",minimum:1},fields:{type:"array",items:{type:"string"}},as:{type:"array",items:{type:"string"}},groupby:{type:"string"}},required:["dimension","fields"]},transform:function(t,n){function i(t){var i=t.dimension(n.dimension),s=n.fields.reduce(function(t,e){return t[e]=0,t},{}),l=[],u=void 0,d=void 0;i.top(1/0).forEach(function(t,i){u=e.assign({},t),l.push(t),d=i>a?l.splice(0,1)[0]:s,n.fields.forEach(function(e,n){t[r[n]||e]=t[e]-d[e]}),o.push(u)})}var r=n.as||[],a=n.period||1,o=[];if(n.groupby){var s=t.dimension(n.groupby);s.group().all().forEach(function(e){return i(t.new(s.filterAll().filter(e.key).top(1/0)))})}else i(t.new());return o}}),st=e.assign(r.map({filter:U,aggregate:function(t){var n=t.fields,i=t.ops,r=t.as,a=t.groupby;return n||i?e.isArray(n)?(i||(i="count"),e.isString(i)&&(i=function(t,e){var n=new Array(t);return n.fill(e),n}(n.length,i)),e.isArray(i)?(i.length<n.length&&Z("Aggregate transforms expects an ops array with same length as fields"),r||(r=[]),e.isArray(r)?function(t){var e,o,s=[];return a?function(t){var e=void 0,o=void 0,s=void 0,l=n.map(function(t,e){return o=i[e],s=Q.get("count"),o&&((s=Q.get(o))||(s=Q.get("count"),Z("Operation "+o+" is not supported, use count"))),{field:t,as:r[e]||t,op:s}});return t.dimension(a).group().reduce(function(t,n){return l.reduce(function(t,i){return e=0,i.as in t&&(e=t[i.as]),t[i.as]=i.op(e,n[i.field]),t},t)},null,Object).all().map(function(t){return t.value[a]=t.key,t.value})}(t):(n.forEach(function(n,a){e=i[a],o=w,e&&((o=J.get(e))||(o=w,Z("Operation "+i[a]+" is not supported, use count"))),s.push({label:r[a]||n,data:o(t.data,function(t){return t[n]})})}),s)}:Z("Aggregate transform expects an array of as fields")):Z("Aggregate transform expects an array of ops")):Z("Aggregate transforms expect an array of fields"):function(t){var e=void 0;return t.data.reduce(function(t,n){for(e in n)e in t?t[e]+=1:t[e]=1;return t},{})}},mapfields:nt,timeseries:function(t){var e=t.sortby,n=t.groupby;return e||Z('timeseries transform requires a "sortby" entry'),function(t){if(e){if(n){var i,r=t.dimension(n),a=r.group().top(1/0),o=t.new([]);return a.forEach(function(n){i=t.new(r.filterExact(n.key).top(1/0)).dimension(e).group().top(1/0),o.series.set(n.key,t.new(i).dimension("key").top(1/0))}),o}return t.new(t.dimension(e).top(1/0))}return t}},crossfilter:function(t){var n=t.fields,i=t.query;return e.isArray(n)?e.isArray(i)?i.length!=n.length?Z("crossfilter transform expects an query array with same length as fields"):function(t){var r=void 0,a=void 0;return n.forEach(function(n,o){a=i[o],e.isString(a)&&(a=t.store.eval(a)),r=t.dimension(n).filterAll(),a&&r.filter(a)}),r?t.new(r.top(1/0)):t}:Z("crossfilter transform expects an array of query"):Z("crossfilter transform expects an array of fields")},movingaverage:rt,groupsmall:at,diff:ot}),{add:function(t,e){this.set(t,K(e))}}),lt=l.dispatch("init","data"),ut={getConfig:function(){},initialise:function(){},getData:function(){},addTransforms:function(t){var n=this,i=void 0;t&&(e.isArray(t)||(t=[t]),t.forEach(function(t){(i=st.get(t.type))?n.transforms.push(i(t)):Z('Transform type "'+t.type+'" not known')}))},asFrame:function(t){return e.isArray(t)&&(t=new x(t=t.map(function(t){return t.constructor!==Object&&(t={data:t}),t}),null,this.store)),function(t,e){return e?k(t,e.slice()):t}(t,this.transforms)}},dt=e.assign(r.map(),{events:lt,add:function(t,n){function i(n,i){!function(t,n,i,r){var a=r.dataName(e.pop(i,"name")),o=[];Object.defineProperties(t,{name:{get:function(){return a}},store:{get:function(){return r}},type:{get:function(){return n}},transforms:{get:function(){return o}},config:{get:function(){return i}}}),t.initialise(i),t.addTransforms(e.pop(i,"transforms")),r.sources.set(a,t),lt.call("init",void 0,t)}(this,t,n,i)}return i.prototype=e.assign({},ut,n),this.set(t,i),i},create:function(t,e){for(var n,i=this.values(),r=0;r<i.length;++r)if(n=i[r].prototype.getConfig(t))return new i[r](n,e)}});dt.add("array",Y),dt.add("remote",G),dt.add("composite",$),dt.add("expression",N),z.prototype={size:function(){return this.sources.size()},addSources:function(t){if(e.isString(t)&&(t={source:t}),e.isArray(t)){var n=this;return t.map(function(t){return dt.create(t,n)})}if(t)return dt.create(t,this)},addTransforms:function(t){e.assign(this.transforms,t)},source:function(t,e){if(1===arguments.length)return this.sources.get(t);if(null===e){var n=this.sources.get(t);return this.sources.remove(t),n}return this.sources.set(t,e),this},clearCache:function(){this.sources.each(function(t){delete t.cachedFrame})},getData:function(t,n){var i=this.sources.get(t);if(!i)throw new Error("Data source "+t+" not available");if(i.cachedFrame)return a.resolvedPromise(i.cachedFrame);var r=i.getData(n);return e.isPromise(r)||(r=a.resolvedPromise(r)),r.then(function(t){return i.config.cache&&(i.cachedFrame=t),t})},eval:function(t,e){var n=this.model.$child(e);return n.dataStore=this,a.viewExpression(t).safeEval(n)},dataName:function(t){if(this.dataCount++,t)return""+t;return this.source("default")?"source"+this.dataCount:"default"}};var ct=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},ht=400,ft="75%",pt=["visual","container"],gt={live:[],types:{},papers:{},options:tt,events:l.dispatch("before-init","after-init","resize","before-draw","after-draw")},mt=e.assign({},{initialise:function(){},draw:function(){},redraw:function(t){if(this.drawing){var e=this,n="after-draw."+this.toString();gt.events.on(n,function(){gt.events.on(n,null),e.redraw(t)})}else this.drawing=this.draw(t);return this.drawing},select:function(t){return d.select(t)},event:function(){return d.event},destroy:function(){},toString:function(){return this.visualType+"-"+this.model.uid},getModel:function(t){t||(t=this.visualType);var n=this.model[t];if(!n&&t in tt){var i=e.pop(this.options,t),r=this;this.visualParent?n=this.visualParent.getModel(t).$child(i):(n=this.model.$new(tt[t])).$update(i),this.model[t]=n,n.$on(function(){return r.redraw(!1)})}return n},idname:function(t){return t||(t=this.visualType),t+"-"+this.model.uid},modelProperty:function(t,e){var n=this.getModel()[t];return void 0===n?e[t]:n},dim:function(t,e,n,i){return it(M(t,e),n,i)},pop:function(t){if(t){var e=t.live.indexOf(this);e>-1&&t.live.splice(e,1)}},getVisualSchema:function(t){var n=this.options.visuals?this.options.visuals[t]:null,i=this.visualParent;if(i&&e.isString(n)?(t=n,n=i.getVisualSchema(t)):i&&!n&&(n=i.getVisualSchema(t)),e.isObject(n))return O(n)}},a.viewBase),vt=function(t,n){function i(e,n,i,r){Object.defineProperties(this,{visualType:{get:function(){return t}},isViz:{get:function(){return-1===pt.indexOf(t)}},visualRoot:{get:function(){return this.visualParent?this.visualParent.visualRoot:this}}}),this.visualParent=i,this.model=i?i.model.$new():r||a.viewModel(),this.options=n||{},this.drawing=!1,gt.events.call("before-init",void 0,this),this.initialise(e),gt.events.call("after-init",void 0,this)}var r=e.pop(n,"options");return r&&(tt[t]=r),i.prototype=e.assign({},mt,n),i.prototype.constructor=i,gt.types[t]=i,i},yt=vt("visual",{options:{render:"svg",width:null,height:"70%",heightElement:null},initialise:function(t){if(!t)throw new Error("HTMLElement required by visual group");if(this.visualParent&&"container"!==this.visualParent.visualType)throw new Error("Visual parent can be a container only");this.select(t).select(".paper").node()||this.select(t).append("div").classed("paper",!0),Object.defineProperties(this,{element:{get:function(){return t}},paperElement:{get:function(){return this.sel.select(".paper")}},sel:{get:function(){return d.select(t)}},size:{get:function(){return[this.width,this.height]}}}),this.sel.classed("d3-visual",!0),this.layers=[],this.drawCount=0,gt.live.push(this),t.__visual__=this,this.visualParent&&this.visualParent.live.push(this)},activate:function(){this.layers.forEach(function(t){return t.activate()})},deactivate:function(){this.layers.forEach(function(t){return t.deactivate()})},getVisual:function(){return this},draw:function(t){if(this.drawing)return Z(this.toString()+" already drawing"),this.drawing;this.drawCount?(this.drawCount++,this.clear()):(this.drawCount=1,this.fit());var e=this;return gt.events.call("before-draw",void 0,this),Promise.all(this.layers.map(function(e){return e.redraw(t)})).then(function(){delete e.drawing,gt.events.call("after-draw",void 0,e)},function(t){delete e.drawing,Z("Could not draw "+e.toString()+": "+t,t)})},clear:function(){},addVisual:function(t){var n=e.pop(t,"type"),i=gt.types[n];if(i)return new i(this.element,t,this);Z('Cannot add visual "'+n+'", not available')},fit:function(){return this.resize(null,!0),this},resize:function(t,e){t||(t=function(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=function(t){var e=S(t,"width");if(e)return function(t){var e=t.getBoundingClientRect().width,n=d.select(t),i=_(n.style("padding-left")),r=_(n.style("padding-right"));return e-i-r}(e)}(t),n.width?n.widthElement=function(t){return S(t,"width")}(t):n.width=ht),n.height||(n.height=function(t){var e=S(t,"width");if(e)return function(t){var e=t.getBoundingClientRect().height,n=d.select(t),i=_(n.style("padding-top")),r=_(n.style("padding-bottom"));return e-i-r}(e)}(t),n.height?n.heightElement=function(t){return S(t,"height")}(t):n.height=ft),n.height=it(M(n.height,n.width),void 0,window.innerHeight),n}(this.element.parentNode||this.element,this.getModel()));var n=this.size;return(e||n[0]!==t.width||n[1]!==t.height)&&(e||a.viewDebug('Resizing "'+this.toString()+'"'),this.width=t.width,this.height=t.height,this.paperElement.style("height",this.height+"px"),gt.events.call("resize",void 0,this),e||this.draw(!1)),this},paper:function(){var t=this.__paper,e=this.getModel().render;if(t&&t.paperType===e)return t;var n=gt.papers[e];if(!n)throw new Error("Unknown paper "+e);return t=new n(this),this.__paper=t,t},getPaperGroup:function(t){return this.paper().group(t)},destroy:function(){this.pop(this.visualParent),this.pop(gt)}});if(e.inBrowser){new MutationObserver(function(t){t.forEach(function(t){var e=t.removedNodes;e&&e.length&&e.forEach(function(t){t.querySelectorAll&&(t.__visual__?P.call(t):d.select(t).selectAll(".d3-visual").each(P))})})}).observe(document.documentElement,{childList:!0,subtree:!0})}var xt=function(t,e,n,i){return n.substring(0,e.length)!==e&&(n=""+e+n[0].toUpperCase()+n.substring(1)),i?t[n]:t[n]()},bt=function(t){a.viewProviders.visualPlugins&&(!function(t){var n=void 0,i=void 0;Object.keys(t).forEach(function(r){n=t[r].options,i=t[r].prototype,n&&(gt.options[r]=n),i&&e.assign(wt,i)})}(a.viewProviders.visualPlugins),a.viewProviders.visualPlugins=null);for(var n=[{},wt,kt],i=1;i<arguments.length;++i)n.push(arguments[i]);return vt(t,e.assign.apply(void 0,n))},wt={initialise:function(t){var n=this.visualParent;if(void 0!==this.options.active?this.active=e.pop(this.options,"active"):this.active=!0,n){if(!n.layers)throw new Error("visual parent of "+this.visualType+" does not have layers")}else this.visualParent=n=new yt(t,this.options,null,this.model),this.model=n.model.$new(),this.options={};n.layers.push(this)},paper:function(){return this.visualParent.paper()},activate:function(t){return this.active||(this.active=!0,this.group().transition(this.model.uid).on("end",function(){t&&t()}).style("opacity",1)),this},deactivate:function(t){return this.active&&(this.active=!1,this.group().transition(this.model.uid).on("end",function(){t&&t()}).style("opacity",0)),this},getVisual:function(){return this.visualParent.getVisual()},group:function(t){var e=this.visualType+"-"+this.model.uid,n=this.visualParent.getPaperGroup(e);return t&&t!==this.visualType?this.paper().childGroup(n,t):n},translate:function(t,n){return e.isFunction(t)?function(e){return"translate("+(t(e)||0)+", "+(n(e)||0)+")"}:"translate("+t+", "+n+")"},getScale:function(t){return e.isString(t)&&(t={type:t}),function(t,n){return(n.$events?n.$events.keys():Object.keys(n)).forEach(function(i){e.isFunction(t[i])&&t[i](n[i])}),t}(xt(h,"scale",t.type),t)},displayError:function(){}},kt={draw:function(t){var n=this;if(this.drawing)return Z(this.toString()+" already drawing"),this.drawing;var i=this,r=this.doDraw;if(this.paper().size(this.boundingBox(!0)),this.active){if(gt.events.call("before-draw",void 0,this),!1!==t||!this._drawArgs)return Promise.all([this.requires?a.require.apply(void 0,this.requires):[],this.getData()]).then(function(t){delete i.drawing;var a=t[1];a&&((t=e.isArray(t[0])?t[0]:[t[0]]).unshift(a),n._drawArgs=t,r.apply(i,t),gt.events.call("after-draw",void 0,i))},function(t){delete i.drawing,Z("Could not draw "+i.toString()+": "+t,t),n.displayError(t)});delete i.drawing,r.apply(i,this._drawArgs),gt.events.call("after-draw",void 0,i)}}},zt={initialise:function(){},transition:function(){},size:function(t){return this.sel.attr("width",t.width).attr("height",t.height),this},group:function(t,e){return this.childGroup(this.sel,t,e)},childGroup:function(t,e,n){e||(e="main");var i=t.selectAll("."+e).data([0]).enter().append("g").classed(e,!0);return n&&i.attr("transform",n).merge().attr("transform",n),t.select("."+e)},dim:function(t){return t}},Mt=A("svg",{initialise:function(t,e){e||t.model.uid;var n=t.paperElement.select("svg#"+e);return n.size()||(n=t.paperElement.append("svg").attr("id",e).classed(t.visualType,!0).style("position","absolute")),n.node()}}),St=A("div",{initialise:function(t){var e=t.model.uid,n=t.visualParent,i=n.paperElement.select("div#"+e);return i.size()||(i=n.paperElement.append("div").attr("id",e).classed(n.visualType,!0).style("position","absolute")),i.node()},size:function(t){return this.sel.style("width",t.width+"px").style("height",t.height+"px"),this},childGroup:function(t,e){return e||(e="main"),t.selectAll("."+e).data([0]).enter().append("div").classed(e,!0),t.select("."+e)}});tt.menu={display:!1,height:"8%",maxHeight:50,minHeight:20},gt.events.on("after-init.menu",function(t){if("visual"===t.visualType){t.getModel("menu").display&&(t.menu=t.sel.insert("nav",":first-child").classed("d3-nav navbar p-1",!0),t.menu.append("h4").classed("title",!0))}}),gt.events.on("before-draw.menu",function(t){t&&t.menu&&function(t){var e=t.getModel("menu"),n=t.dim(e.height,t.height,e.minHeight,e.maxHeight);t.menu.style("height",n+"px")}(t)});var _t=r.map(),Ot=r.map();if(gt.options.dataContext={$format:function(t,e){var n=_t.get(t);return n||(n=f.format(t),_t.set(t,n)),n(e)},$formatTime:function(t,e){var n=Ot.get(t);return n||(n=u.timeFormat(t),Ot.set(t,n)),n(e)}},wt.getData=function(){var t=this.model.data;return t?this.dataStore.getData(t,{$visual:this}):(Z("Visual "+this.visualType+" without data name, cannot get data"),a.resolvedPromise())},wt.getContext=function(t){return this.dataStore.model.$child(t)},gt.events.on("before-init.data",function(t){t.isViz&&(t.data=e.pop(t.options,"data"))}),gt.events.on("after-init.data",function(t){Object.defineProperties(t,{dataStore:{get:function(){return t.model.root.dataStore}}}),t.isViz?function(t){var n=t.dataStore,i=e.pop(t,"data");i&&(e.isString(i)&&(i={source:i}),i.name||(i.name=t.model.uid),(i=n.addSources(i))?t.model.$set("data",i.name):Z("Could not create data source "+i.name))}(t):function(t){var n=t.dataStore,i=e.pop(t.options,"data");n||(n=new z(t.getModel("dataContext")),t.model.root.dataStore=n),n.addSources(i)}(t)}),gt.options.font={size:"3%",minSize:10,maxSize:20,stroke:"#333",family:null},wt.font=function(t,e){e=e||this.getModel("font");var n=this.getModel(),i=this.dim(e.size,t.height,e.minSize,e.maxSize);return n.fontSizeMultiplier&&(i*=n.fontSizeMultiplier),i},tt.resizeDelay||(tt.resizeDelay=200),e.inBrowser){var Pt=a.viewDebounce(function(){gt.live.forEach(function(t){return t.resize()})},tt.resizeDelay);d.select(window).on("resize.visuals",Pt)}tt.title={text:null,size:"3%",minSize:15,maxSize:25,offset:["10%",0]},gt.events.on("before-init.title",function(t){var n=t.options.title;e.isString(n)&&(t.options.title={text:n})}),gt.events.on("after-draw.title",function(t){var e=t.getModel("title"),n=t;if("visual"===n.visualType)delete n.__title;else{if(!t.isViz)return;n=t.visualParent}if(e.text)if(n.menu&&!n.__title)n.__title=e,function(t,e){var n=function(t){return+t.substring(0,t.length-2)}(t.menu.style("height")),i=e.maxSize?Math.min(n-4,e.maxSize):n-4,r=t.dim(e.size,t.width,e.minSize,i);t.menu.select(".title").html(e.text).style("font-size",r+"px").style("line-height",n+"px")}(n,e);else if(t.isViz){var i=t.boundingBox(!0),r=t.getModel("font"),a=e.stroke||r.stroke,o=t.font(i,e),s=t.group().selectAll("text.chartitle").data([e.text]),l=t.dim(e.offset[0],i.vizHeight),u=t.dim(e.offset[1],i.vizWidth),d=t.translate(i.margin.left+i.innerWidth/2+u,l);s.enter().append("text").classed("chartitle",!0).attr("transform",d).style("text-anchor","middle").style("font-size",o).style("fill",a).text(function(t){return t}).merge(s).transition().attr("transform",d).style("font-size",o).style("fill",a).text(function(t){return t})}});var At=["top","bottom","left","right"],Ct=["left","right"];tt.margin={top:20,bottom:20,left:20,right:20},tt.padding={top:0,bottom:0,left:0,right:0},wt.boundingBox=function(t){if(t&&W(this),!this.__boundingBox){var e=this.visualParent.width,n=this.visualParent.height,i=T(this.getModel("padding"),e,n),r=e-i.left-i.right,a=n-i.top-i.bottom,o=T(this.getModel("margin"),r,a),s=At.reduce(function(t,e){return t[e]=o[e]+i[e],t},{});this.__boundingBox={margin:o,padding:i,total:s,width:e,height:n,vizWidth:r,vizHeight:a,innerWidth:e-s.left-s.right,innerHeight:n-s.top-s.bottom,$nomargins:function(){return{width:this.innerWidth,height:this.innerHeight,margin:E(0),padding:E(0),total:E(0),innerWidth:this.innerWidth,innerHeight:this.innerHeight,$nomargins:this.$nomargins}}}}return this.__boundingBox},gt.events.on("after-init.margin",function(t){t.margin=C("margin",t),t.padding=C("padding",t)}),gt.events.on("before-draw.margin",function(t){t.isViz&&W(t)});var Tt=r.map({top:p.axisTop,bottom:p.axisBottom,left:p.axisLeft,right:p.axisRight}),Wt={ticks:5,tickSize:6,tickSizeOuter:null,rotate:null,ancor:"end",format:null,timeFormat:"%Y-%m-%d",stroke:"#333",hide:null,title:null,titleRotate:null,titleOffset:.7};gt.options.xAxis=e.assign({location:"bottom"},Wt),gt.options.yAxis=e.assign({location:"left"},Wt),wt.xAxis1=function(t,e,n,i){var r=this.getModel("xAxis"),a=j(t,e,r,i),o=this.group("x-axis");return this.applyTransform(o,this.translateAxis(t,n)),q(o.transition(this.transition("x-axis")).call(a),r,e),r.title&&this.axisTitle(o,t,e,n,r),o},wt.yAxis1=function(t,e,n,i){var r=this.getModel("yAxis"),a=j(t,e,r,i),o=this.group("y-axis");return this.applyTransform(o,this.translateAxis(t,n)),q(o.transition(this.transition("x-axis")).call(a),r,e),r.title&&this.axisTitle(o,t,e,n,r),o},wt.axis=function(t,e){return Tt.get(t)(e)},wt.axisTitle=function(t,e,n,i,r){var a=t.selectAll("text.title").data([r.title]),o=r.titleRotate||0,s=0,l=0;o||"right"!==e&&"left"!==e||(o=-90),"left"==e&&(s=-r.titleOffset*i.margin.left,l=i.innerHeight/2);var u="translate("+s+","+l+") rotate("+o+")",d=this.font(i);a.enter().append("text").classed("title",!0).attr("transform",u).style("text-anchor","middle").style("font-size",d).style("fill",r.stroke).text(function(t){return t}).merge(a).transition().attr("transform",u).style("font-size",d).style("fill",r.stroke).text(function(t){return t})},wt.translateAxis=function(t,e){return"top"===t||"left"===t?this.translate(e.margin.left,e.margin.top):"bottom"===t?this.translate(e.margin.left,e.margin.top+e.innerHeight):this.translate(e.margin.left+e.innerWidth,e.margin.top)};var Et=r.map({circle:g.symbolCircle,square:g.symbolSquare,star:g.symbolStar}),jt=r.map({ascending:g.stackOrderAscending,descending:g.stackOrderDescending,insideout:g.stackOrderInsideOut,none:g.stackOrderNone,reverse:g.stackOrderReverse}),qt=r.map({expand:g.stackOffsetExpand,diverging:g.stackOffsetDiverging,none:g.stackOffsetNone,silhouette:g.stackOffsetSilhouette,wiggle:g.stackOffsetWiggle});wt.getSymbol=function(t){var e=Et.get(t);return g.symbol().type(e)},wt.getStack=function(){var t=this.getModel();if(t.stack){var e=g.stack();return t.stackOrder&&e.order(jt.get(t.stackOrder)),t.stackOffset&&e.offset(qt.get(t.stackOffset)),e}return null};var Ht=r.map();tt.color={scale:"cool",scaleMinPoints:6,scaleOffset:0,stroke:"#333",strokeOpacity:1,fillOpacity:1},Ht.set("viridis",function(){return h.scaleSequential(h.interpolateViridis)}),Ht.set("inferno",function(){return h.scaleSequential(h.interpolateInferno)}),Ht.set("magma",function(){return h.scaleSequential(h.interpolateMagma)}),Ht.set("plasma",function(){return h.scaleSequential(h.interpolatePlasma)}),Ht.set("warm",function(){return h.scaleSequential(h.interpolateWarm)}),Ht.set("cool",function(){return h.scaleSequential(h.interpolateCool)}),Ht.set("rainbow",function(){return h.scaleSequential(h.interpolateRainbow)}),Ht.set("cubehelix",function(){return h.scaleSequential(h.interpolateCubehelixDefault)}),wt.colors=function(t,i){var r=this.getModel("color"),a=!1,o=void 0,s=void 0;if(e.isArray(r.scale))s=this.getScale("ordinal").range(r.scale);else{if(!(o=Ht.get(r.scale)))throw new Error("Unknown scale "+r.scale);e.isObject(o)||(o={scale:o}),void 0===o.minPoints&&(o.minPoints=r.scaleMinPoints),s=o.scale(),a=o.reversed}if(e.isFunction(s.interpolator)){var l=r.scaleOffset,u=t+l,d=Math.max(u,o.minPoints),c=a?[d-1,0]:[0,d-1];s.domain(c);var h=void 0;return n.range(l,Math.min(u,d)).map(function(t){return h=m.color(s(t)),h.opacity=i,h})}var f=s.range().slice();a&&f.reverse();for(var p=void 0,g=void 0,v=void 0,y=0;y<r.scaleOffset;++y)f.push(f.shift());return n.range(t).map(function(){return p=f.shift(),g=m.color(p),v=m.color(p),g.opacity=i,f.push(""+v.brighter(.2)),g})},wt.fill=function(t){function e(t,e){return r[e]}var n=this.getModel("color"),i=this.modelProperty("fillOpacity",n),r=this.colors(t.length,i);return e.colors=r,e},wt.stroke=function(t){function e(t,e){return r[e]}var n=this.getModel("color"),i=this.modelProperty("strokeOpacity",n),r=this.colors(t.length,i);return e.colors=r,e},wt.linearGradient=function(t,e,n,i){var r=this.paper().sel,a=r.select("defs");a.node()||(a=r.append("defs"));var o=a.selectAll("#"+i).data([0]),s=m.color(t);s.opacity=.1,o.enter().append("linearGradient").attr("id",i).attr("x1","0%").attr("y1","0%").attr("x2","vertical"===n?"0%":"100%").attr("y2","vertical"===n?"100%":"0%");var l=a.select("#"+i).selectAll("stop").data([{offset:"0%",color:t},{offset:"100%",color:s}]);return l.enter().append("stop").merge(l).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),"url(#"+i+")"},tt.legend={location:"top-right",orient:"vertical",fontSize:"3%",title:"",titleWidth:"20%",labelFormat:null,titleMinWidth:30,titleMaxWidth:60,minFontSize:10,maxFontSize:20,offset:[10,10],shapeWidth:15,shapeHeight:15,hide:300};var Ft={color:v.legendColor,size:v.legendSize,symbol:v.legendSymbol};wt.legend=function(t,n){var i=this.getModel(),r=this.getModel("legend"),a=this.getModel("font"),o=e.pop(t,"type")||i.legendType,s=Math.max(n.vizHeight,n.vizWidth),l=this.dim(r.fontSize,s,r.minFontSize,r.maxFontSize),u=Ft[o];if(r.location){if(!u)return Z("Could not load legend "+o);if(u=u().orient(r.orient),r.title&&(u.title(r.title),r.titleWidth)){var d=this.dim(r.titleWidth,s,r.titleMinWidth,r.titleMaxWidth);u.titleWidth(d)}r.labelFormat&&u.labelFormat(r.labelFormat),u.shapeWidth(r.shapeWidth).shapeHeight(r.shapeHeight);for(var c in t)u[c](t[c]);var h=this.group("legend").style("font-size",l+"px").html("").call(u),f=h.node().getBBox(),p=Dt.get(r.location).call(this,f,n,r),g=this.translate(p.x,p.y);h.selectAll("text").style("fill",r.stroke||a.stroke),this.applyTransform(h,g),r.hide&&(s<r.hide?h.style("opacity",0):h.style("opacity",1))}};var Dt=r.map({top:function(t,e,n){var i=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2,y:i}},bottom:function(t,e,n){var i=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2,y:e.vizHeight-t.height-i}},right:function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth);return{x:e.vizWidth-t.width-i,y:e.margin.top+(e.innerHeight-t.height)/2}},left:function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth);return{x:e.margin.left-i,y:e.margin.top+(e.innerHeight-t.height)/2}},"top-left":function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth),r=this.dim(n.offset[1],e.vizHeight);return{x:e.margin.left+(e.innerWidth-t.width)/2+i,y:r}},"top-right":function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth),r=this.dim(n.offset[1],e.vizHeight);return{x:e.vizWidth-t.width-i,y:r}},"bottom-left":function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth),r=this.dim(n.offset[1],e.vizHeight);return{x:t.width+i,y:e.vizHeight-t.height-r}},"bottom-right":function(t,e,n){var i=this.dim(n.offset[0],e.vizWidth),r=this.dim(n.offset[1],e.vizHeight);return{x:e.vizWidth-t.width-i,y:e.vizHeight-t.height-r}}}),Bt=function(t){return function(){return t}},Yt=function(t){return e.isFunction(t)?t:Bt(t)},Rt=function(t){return t},Lt=r.map({darker:function(){function t(t,e){var n=t.getModel("mouse"),i=m.color(e.style("fill")),r=i.darker(n.darkerFactor);e.node().__mouse_over__.fill=i,e.style("fill",r)}return t.out=function(t,e){var n=e.node().__mouse_over__.fill;n&&e.style("fill",n)},t}(),fill:function(){function t(t,e){var n=t.getModel("mouse"),i=m.color(e.style("fill"));e.node().__mouse_over__.fill=i,e.transition().style("fill",n.fillColor)}return t.out=function(t,e){var n=e.node().__mouse_over__.fill;n&&e.transition().style("fill",n)},t}()});gt.options.mouse={over:["darker"],darkerFactor:.5,fillColor:"#addd8e"},wt.mouseOver=function(){var t=this,e=this.getModel("mouse");return function(n,i){this.__mouse_over__||(this.__mouse_over__={});var r=t.select(this),a=void 0;e.over.forEach(function(e){(a=Lt.get(e))?a(t,r,n,i):Z("Unknown mouse strategy "+e)})}},wt.mouseOut=function(){var t=this,e=this.getModel("mouse");return function(n,i){this.__mouse_over__||(this.__mouse_over__={});var r=t.select(this),a=void 0;e.over.forEach(function(e){(a=Lt.get(e))?a.out(t,r,n,i):Z("Unknown mouse strategy "+e)})}},gt.options.tooltip={location:"top",offset:[10,10],html:""},e.inBrowser?wt.tooltip=function(){function t(){return null===s&&(s=d.select(document.body).append("div").classed("d3-tooltip",!0).style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box").node(),l=d.select(document.body).append("svg").style("opacity",0).style("pointer-events","none").node().createSVGPoint()),d.select(s)}function e(){}function n(t){for(;null==t.getScreenCTM&&null==t.parentNode;)t=t.parentNode;var e={},n=t.getScreenCTM(),i=t.getBBox(),r=i.width,a=i.height,o=i.x,s=i.y;return l.x=o,l.y=s,e.nw=l.matrixTransform(n),l.x+=r,e.ne=l.matrixTransform(n),l.y+=a,e.se=l.matrixTransform(n),l.x-=r,e.sw=l.matrixTransform(n),l.y-=a/2,e.w=l.matrixTransform(n),l.x+=r,e.e=l.matrixTransform(n),l.x-=r/2,l.y-=a/2,e.n=l.matrixTransform(n),l.y+=a,e.s=l.matrixTransform(n),e}var i=Yt("top"),a=Yt([0,0]),o=Yt(" "),s=null,l=null,u=r.map({top:function(t,e){var i=n(t);return{left:i.n.x-s.offsetWidth/2,top:i.n.y-s.offsetHeight-e[1]}},bottom:function(t,e,n){return{top:e.total.left+(e.innerWidth-t.width)/2,left:e.height-t.height-n.offsetY}},right:function(t,e){var i=n(t);return{left:i.e.x+e[0],top:i.e.y-s.offsetHeight/2}},left:function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:n.offsetY}},"top-left":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:n.offsetY}},"top-right":function(t,e,n){return{x:e.width-t.width-n.offsetX,y:n.offsetY}},"bottom-left":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:e.height-t.height-n.offsetY}},"bottom-right":function(t,e,n){return{x:e.total.left+(e.innerWidth-t.width)/2,y:e.height-t.height-n.offsetY}}}),c=u.keys();return e.show=function(n){var r,s=Array.prototype.slice.call(arguments),l=t(),d=o.apply(this,s)||"",h=a.apply(this,s),f=i.apply(this,s),p=document.documentElement.scrollTop||document.body.scrollTop,g=document.documentElement.scrollLeft||document.body.scrollLeft;l.html(d).style("opacity",1).style("pointer-events","all");for(var m=c.length;m--;)l.classed(c[m],!1);return r=u.get(f).call(this,n,h),l.classed(f,!0).style("top",r.top+p+"px").style("left",r.left+g+"px"),e},e.hide=function(){return t().style("opacity",0).style("pointer-events","none"),e},e.location=function(t){return arguments.length?(i=null===t?t:Yt(t),e):i},e.html=function(t){return arguments.length?(o=null===t?t:Yt(t),e):o},e.offset=function(t){return arguments.length?(a=null==t?t:Yt(t),e):a},e}():wt.tooltip=Rt,Lt.set("tooltip",function(){function t(t,e,n,i){var r=t.tooltipHtml(e,n,i);if(r){var a=t.getModel("tooltip");t.tooltip.location(a.location).offset(a.offset).html(r).show(e.node())}}return t.out=function(t){t.tooltip.hide()},t}()),wt.tooltipHtml=function(t,e,n){var i=this.getModel("tooltip");if(i.html)return this.dataStore.eval(i.html,{d:e,index:n,model:this.getModel()})},gt.options.expand={location:"top-right",expandText:"expand",collapseText:"collapse",height:15,width:15,radius:3,offset:[0,0],stroke:"#adadad",fill:"#fff",fillOver:"#e6e6e6",textColor:"#111"},gt.events.on("after-draw.expand",function(t){function e(){t.select(this).select("rect.button").attr("fill",i.fill)}var n=t.visualParent;if(t.isViz&&!(n.layers.length<=1)){var i=t.getModel("expand");if(t.__expanded||i.location&&function(t){return t.left||t.right||t.top||t.bottom}(t.getModel("padding"))){var r=t.getModel("font"),a=t.boundingBox(),o=t.group("expand"),s=o.node(),l=Math.floor(.8*Math.min(i.width,i.height)),u=t.__expanded?i.collapseText:i.expandText,d=!1;o.select("rect").size()||(d=!0,o.attr("cursor","pointer").on("mouseover",function(){t.select(this).select("rect.button").attr("fill",i.fillOver)}).on("mouseout",e),o.append("rect").classed("button",!0).attr("x",0).attr("y",0).attr("rx",i.radius).attr("ry",i.radius).attr("width",i.width).attr("height",i.height).attr("stroke",i.stroke).attr("fill",i.fill).attr("cursor","pointer"),o.append("text").attr("x",i.width/2).attr("y",i.height/2).attr("fill",i.textColor).attr("font-family",i.fontFamily||r.family).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",l),o.append("rect").classed("placeholder",!0).attr("x",0).attr("y",0).attr("rx",i.radius).attr("ry",i.radius).attr("width",i.width).attr("height",i.height).attr("stroke","none").attr("fill","transparent").on("click",function(){var i=t.getModel("padding");if(e.call(this),t.__expanded){var r=t.__expanded.padding;delete t.__expanded,n.activate(),At.forEach(function(t){r[t]&&(i[t]=r[t])})}else t.__expanded={padding:At.reduce(function(t,e){return i[e]&&(t[e]=i[e],i[e]=0),t},{})},n.deactivate(),t.activate();n.redraw(!1)})),o.select("text").text(function(){return u});var c=Dt.get(i.location).call(t,s.getBBox(),a,i);d||(o=o.transition(t.transition("expand"))),o.attr("transform",t.translate(c.x,c.y))}}}),gt.options.transition={duration:250,delay:0,ease:null},wt.transition=function(t){var e=this.idname(t),n=this.getModel("transition");return c.transition(e).duration(n.duration)},wt.applyTransform=function(t,e){t.attr("transform")||t.attr("transform",e),t.transition().attr("transform",e)},wt.brushX=function(){return y.brushX()},wt.brushY=function(){return y.brushY()},wt.brush=function(){return y.brush()};var Xt=vt("container",{initialise:function(){this.live=[],this.visualParent&&this.visualParent.live.push(this)},draw:function(t){if(this.drawing)return Z(this.toString()+" already drawing"),this.drawing;var e=this;return gt.events.call("before-draw",void 0,e),Promise.all(this.live.map(function(e){return e.redraw(t)})).then(function(){delete e.drawing,gt.events.call("after-draw",void 0,e)})},destroy:function(){this.pop(this.visualParent)}}),Gt={props:["schema","datasource","plugins","options"],render:function(t,n,i){var r=this,a=this.select(i).html();return this.getSchema(t.schema,function(i){return e.isObject(i)||(i={}),i=e.assign({},t.options,i),r.build(i,a,n)})},getSchema:function(t,n){var i=this.model.visual;if(i&&i!==this.model&&e.isString(t)){var r=i.getVisualSchema(t);r&&(t=r)}return e.isString(t)?this.json(t).then(n).catch(function(e){Z("Could not reach "+t+": "+e,e)}):n(t)},build:function(){}},Vt=e.assign({},Gt,{build:function(t,e,n){var i=this.model,r=this.createElement("div"),a=i.root;return n.class&&r.attr("class",n.class),t.visuals||(t.visuals={}),i.visual=new Xt(r.node(),t,i.visual,i.visual?null:i.$new()),a.visualDashboard||(a.visualDashboard=i.visual),r.html(e)}}),$t=e.assign({},Gt,{build:function(t,n,i){var r,a=this.createElement("div"),o=t.type||"visual",s=this.model,l=e.pop(t,"visualDrawOnMount"),u={};return i.class&&a.attr("class",i.class),"visual"===o?(r=e.pop(t,"layers"),u=t):u.visual=e.pop(t,"visual")||{},void 0!==l&&(s.visualDrawOnMount=l),s.visual=new yt(a.node(),u,s.visual,s.visual?null:s.$new()),"visual"!==o?s.visual.addVisual(t):r&&r.forEach(function(t){return s.visual.addVisual(t)}),a},mounted:function(){!1!==this.model.visualDrawOnMount&&this.model.visual.redraw()}}),Nt={install:function(t){t.addComponent("dashboard",Vt),t.addComponent("visual",$t)}},Kt=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},It=function(){function t(t){var a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,d=void 0,c=void 0,h=void 0,f=void 0,p=void 0,g=void 0,m=t.length,v=.5*r/i,y=new Array(m),x=new Array(m);for(a=0;a<m;++a)y[x[a]=a]=+e(t[a],a,t);for(x.sort(function(t,e){return Kt(y[t],y[e])}),f=y[x[0]],d=null,a=m-1;a>=0;--a)l=[],null===d?l.push([0,0]):(c=(h=d+p)*v,l.push([c,h]),l.push([-c,h])),o=x[a],s=m-a-1,u=y[o]/f,g=Math.sqrt(u),c=(h=(d=i*g)-(p=a?n(g,s):0))*v,l.push([-c,h]),l.push([c,h]),y[o]={index:s,value:y[o],fraction:u,points:l,data:t[o]};return y}var e=Rt,n=Bt(0),i=1,r=1;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Bt(+n),t):e},t.base=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(i=e,t):i},t.pad=function(e){return arguments.length?(n="function"==typeof e?e:Bt(+e),t):n},t},Ut=function(t,e){var n=t[0],i=(t[1]-n)/e,r=Math.floor(Math.log10(i)),a=Math.pow(10,r);i/a>5&&(a*=10);var o=(a*=.1)*Math.ceil(i/a),s=a*Math.floor(n/a);return[s,s+e*o]},Zt=function(t,e,n){return.299*(t=m.color(t)).r+.587*t.g+.114*t.b>186?n||"#000":e||"#fff"},Jt=function(t,e,n){e=Yt(e),t.each(function(t,i){var r=d.select(this),a=parseFloat(r.attr("dy"))||0,o=e(t,i),s=r.text().split("\n"),l=void 0,u=void 0,c=void 0,h=r.text(null).append("tspan").attr("x",0).attr("dy",a+"em");s.forEach(function(t,e){for(c=[],u=t.split(/\s+/).reverse(),e&&(h=r.append("tspan").attr("x",0).attr("dy",1.2+a+"em"));l=u.pop();)c.push(l),h.text(c.join(" ")),h.node().getComputedTextLength()>o&&c.length>1&&(c.pop(),h.text(c.join(" ")),c=[l],h=r.append("tspan").attr("x",0).attr("dy",1.2+a+"em").text(l))}),n&&r.selectAll("tspan").each(n)})},Qt=function(){function t(t){var s=!1,l=void 0,u=void 0,d=void 0;return e&&(u=t.dimension(e).group().top(1/0).map(function(t){return t.key}).sort()).length<=1&&(u=null),u?(t=t.pivot(n,e,i),r&&(t=t.sortby("total")),l=t.data,a&&(o&&(l=function(t){return t}(l)),l=a.keys(u)(l),s=!0)):(l=t.data,u=[i]),s||(l=u.map(function(t,e){return d=l.map(function(e){return d=[0,e[t]],d.data=e,d}),d.index=e,d.key=t,d})),new H(l,n,i,s)}var e=null,n="x",i="y",r=!1,a=null,o=!1;return t.groupby=function(n){return arguments.length?(e=n,t):e},t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(i=e,t):i},t.normalize=function(e){return arguments.length?(o=e,t):o},t.stack=function(e){return arguments.length?(stack=e,t):a},t};H.prototype={rangeX:function(){return this.range(this.x)},rangeY:function(){return this.range()},range:function(t){var e=void 0,i=void 0;return i=t?this.data.reduce(function(i,r){return e=n.extent(r,function(e){return e.data[t]}),i.push(e[0]),i.push(e[1]),i},[]):this.data.reduce(function(t,i){return e=n.extent(i,function(t){return t[0]}),t.push(e[0]),t.push(e[1]),e=n.extent(i,function(t){return t[1]}),t.push(e[0]),t.push(e[1]),t},[]),n.extent(i)}};var te={curveBasisClosed:g.curveBasisClosed,curveBasisOpen:g.curveBasisOpen,curveBasis:g.curveBasis,curveBundle:g.curveBundle,curveCardinalClosed:g.curveCardinalClosed,curveCardinalOpen:g.curveCardinalOpen,curveCardinal:g.curveCardinal,curveCatmullRomClosed:g.curveCatmullRomClosed,curveCatmullRomOpen:g.curveCatmullRomOpen,curveCatmullRom:g.curveCatmullRom,curveLinearClosed:g.curveLinearClosed,curveLinear:g.curveLinear,curveMonotoneX:g.curveMonotoneX,curveMonotoneY:g.curveMonotoneY,curveNatural:g.curveNatural},ee={curve:function(t){var e=xt(te,"curve",t,!0);return e||(Z('Could not locate curve type "'+t+'"'),e=g.curveNatural),e},range:function(t,e,i,r){var a={x:n.extent(t,e),y:n.extent(t,i)};r&&(Array.prototype.push.apply(r.x,a.x),Array.prototype.push.apply(r.y,a.y))},newRange:function(){return{x:[],y:[]}},x:function(t,e){var i=this.getModel(),r=this.getScale(i.scaleX).domain(n.extent(e)).range([0,t.innerWidth]);return function(t){return r(t[i.x])}},y:function(t,e,i){var r=this.getModel(),a=this.getScale(r.scaleY).domain(n.extent(e)).range([t.innerHeight,0]);return 2===arguments.length&&(i=function(t){return t[r.y]}),function(t){return a(i(t))}}},ne=bt("linechart",ee,{options:{lineWidth:1,curve:"natural",x:"x",y:"y",groupby:null,scaleX:"linear",scaleY:"linear",axisX:!0,axisY:!0},doDraw:function(t){function n(t,e){return m[e]}var i=this.getModel(),r=i.x,a=i.y,o=this.boundingBox(),s=Qt().groupby(i.groupby).x(r).y(a)(t),l=s.rangeX(),u=s.rangeY(),d=this.getScale(i.scaleX).domain(l).rangeRound([0,o.innerWidth]),c=this.getScale(i.scaleY).domain(u).rangeRound([o.innerHeight,0]).nice(),h=this.group(),f=this.group("chart"),p=f.selectAll(".line").data(s.data),m=this.stroke(s.data).colors,v=0,y=g.line().x(function(t){return d(t.data[r])+v}).y(function(t){return c(t[1])}).curve(this.curve(i.curve));this.applyTransform(h,this.translate(o.padding.left,o.padding.top)),this.applyTransform(f,this.translate(o.margin.left,o.margin.top)),e.isFunction(d.bandwidth)&&(d.domain(s.data[0].map(function(t){return t.data[r]})),v=d.bandwidth()/2),p.enter().append("path").attr("class","line").attr("fill","none").attr("stroke",n).attr("stroke-width",i.lineWidth).attr("d",y).merge(p).transition().attr("stroke",n).attr("stroke-width",i.lineWidth).attr("d",y),p.exit().transition().style("opacity",0).remove(),i.axisX&&this.xAxis1(!0===i.axisX?"bottom":i.axisX,c,o),i.axisY&&this.yAxis1(!0===i.axisY?"left":i.axisY,c,o)}}),ie={center:"middle",top:"hanging",bottom:"baseline",outside:"baseline"},re={center:function(t,e){return e/2},top:function(t,e,n){return n},bottom:function(t,e,n){return e-n},outside:function(t,e,n){return-n}},ae=bt("barchart",ee,{options:{orientation:"vertical",sortby:null,stack:!0,stackOrder:"descending",waffle:!1,normalize:!1,scaleX:{type:"band",padding:.2},scaleY:"linear",x:"x",y:"y",label:null,labelLocation:"center",labelOffset:10,labelWidth:.7,radius:0,groupby:null,axisY:!0,axisX:!0,valueformat:".1f",legendType:"color",legendLabel:"label"},doDraw:function(t){var e=this.getModel(),n=t.data,i=this.boundingBox(),r=this.group(),a=this.group("chart"),o=e.x,s=e.y,l=e.groupby,u="vertical"===e.orientation?new F(this):new D(this),d=void 0,c=!1;if(this.applyTransform(r,this.translate(i.padding.left,i.padding.top)),this.applyTransform(a,this.translate(i.margin.left,i.margin.top)),l&&(d=t.dimension(l).group().top(1/0).map(function(t){return t.key})).length<=1&&(d=null),d){var h=t.pivot(o,l,s);"y"===e.sortby&&(h=h.sortby("total")),n=h.data,u.sz.domain(d).range(this.fill(d).colors),e.stack&&(e.normalize&&(n=this.normalize(h)),c=!0)}else u.sz.domain([s]).range(this.fill([s]).colors),c=!0;var f=n.map(function(t){return t[o]});u.sx.domain(f),c||!d?u.stacked(a,n,d):u.grouped(a,n,d),u.axis(f),u.legend(d)}}),oe={init:function(t){this.viz=t,this.model=t.getModel(),this.box=t.boundingBox(),this.sx=t.getScale(this.model.scaleX),this.sy=t.getScale(this.model.scaleY),this.sz=t.getScale("ordinal")},legend:function(t){this.model.legendType&&t&&this.viz.legend({scale:this.sz},this.box)},stacked:function(t,e,i){function r(t){return f(t[1-M])-f(t[M])}function a(t){return h(t.data[g])}function o(t){return f(t[M])}function s(t){return t.forEach(function(e){e.key=t.key,e.value=e.data[t.key]}),t}function l(t,e){var n=k(t,e)+b(t,e)/2,i=z(t,e)+T(t,w(t,e),E);return v.translate(n,i)}function u(t){return Zt(p(t.key),"#fff",_.stroke)}function d(t,e){return v.dataStore.eval(O,{d:t,index:e})}var c=this.viz.getModel("color"),h=this.sx,f=this.sy,p=this.sz,g=this.model.x,m=this.model.y,v=this.viz,y=this.model.radius,x=t.selectAll(".group"),b=void 0,w=void 0,k=void 0,z=void 0,M=void 0,S=void 0;if(i?this.sy.domain([0,n.max(e,function(t){return t.total})]).nice():(this.sy.domain([0,n.max(e,function(t){return t[m]})]).nice(),i=[this.model.y]),this.vertical?(k=a,z=o,b=h.bandwidth,w=r,M=1):(k=o,z=a,b=r,w=h.bandwidth,M=0),e=v.getStack().keys(i)(e),(x=x.data(e)).exit().transition().style("opacity",0).remove(),(S=x.enter().append("g").classed("group",!0).attr("fill",function(t){return p(t.key)}).merge(x).attr("fill",function(t){return p(t.key)}).attr("stroke",v.modelProperty("stroke",c)).attr("stroke-opacity",v.modelProperty("strokeOpacity",c)).selectAll("rect").data(s)).enter().append("rect").attr("x",k).attr("y",z).attr("height",w).attr("width",b).attr("rx",y).attr("ry",y).on("mouseover",v.mouseOver()).on("mouseout",v.mouseOut()).merge(S).transition().attr("x",k).attr("y",z).attr("height",w).attr("width",b),S.exit().transition().style("opacity",0).remove(),this.model.label){var _=v.getModel("font"),O=this.model.label,P=v.font(this.box)+"px",A=t.selectAll(".labels").data(e),C=this.vertical?ie[this.model.labelLocation]||"baseline":"middle",T=re[this.model.labelLocation],W=this.model.labelWidth,E=this.model.labelOffset;(S=A.enter().append("g").classed("labels",!0).merge(A).selectAll("text").data(s)).enter().append("text").classed("label",!0).attr("transform",l).style("fill",u).style("font-size",P).text(d).merge(S).text(d).style("font-size",P).call(Jt,function(t){return W*b(t)},function(){v.select(this).attr("alignment-baseline",C).attr("text-anchor","middle")}).transition(v.transition("text")).attr("transform",l).style("fill",u)}},grouped:function(t,e,i){function r(t){return l(t[c])}function a(t){return u(t.value)}function o(t){return u(0)-u(t.value)}var s=this.viz.getModel("color"),l=this.sx,u=this.sy,d=this.sz,c=this.model.x,h=this.viz,f=this.model.radius,p=l.paddingInner(),g=h.getScale("band").domain(i).paddingInner(.5*p),m=t.selectAll(".group"),v=void 0,y=void 0,x=void 0,b=void 0;u.domain([0,n.max(e,function(t){return i.reduce(function(e,n){return Math.max(e,t[n])},0)})]).nice(),this.vertical?(g.rangeRound([0,l.bandwidth()]),x=r,v=g.bandwidth,y=o):(x=r,y=g.bandwidth,v=o),(m=m.data(e)).exit().remove(),(b=m.enter().append("g").classed("group",!0).attr("transform",function(t){return h.translate(x(t),0)}).merge(m).attr("transform",function(t){return h.translate(x(t),0)}).selectAll("rect").data(function(t){return i.map(function(e){return{key:e,value:t[e]}})})).exit().transition().style("opacity",0).remove(),b.enter().append("rect").attr("x",function(t){return g(t.key)}).attr("y",a).attr("rx",f).attr("ry",f).attr("height",y).attr("width",v).attr("stroke",s.stroke).attr("stroke-opacity",0).attr("fill",function(t){return d(t.key)}).on("mouseover",h.mouseOver()).on("mouseout",h.mouseOut()).merge(b).transition(h.transition("rect")).attr("x",function(t){return g(t.key)}).attr("y",a).attr("height",y).attr("width",v).attr("stroke",s.stroke).attr("stroke-opacity",s.strokeOpacity).attr("fill",function(t){return d(t.key)}),b.exit().remove()}};F.prototype=e.assign({},oe,{axis:function(t){this.model.axisX&&this.viz.xAxis1(!0===this.model.axisX?"bottom":this.model.axisX,this.sx,this.box,t[0]),this.model.axisY&&this.viz.yAxis1(!0===this.model.axisY?"left":this.model.axisY,this.sy,this.box)}}),D.prototype=e.assign({},oe,{axis:function(t){this.model.axisX&&this.viz.xAxis1(!0===this.model.axisX?"left":this.model.axisX,this.sx,this.box,t[0]),this.model.axisY&&this.viz.yAxis1(!0===this.model.axisY?"bottom":this.model.axisY,this.sy,this.box)}});var se=bt("boxchart",ee,{options:{orientation:"vertical",lineWidth:1,x:"x",y:"y",scaleX:"linear",scaleY:"linear",gradient:!0},doDraw:function(t){var e=this.getModel(),i=this.getDataInfo(t),r=this.boundingBox(),a=function(){function t(t){var d=this;t.each(function(c,f){var p=(c=c.map(o).sort(n.ascending)).length,g=c[0],m=c[p-1],v=c.quartiles=l(c),y=s&&s(c),x=y&&y.map(function(t){return c[t]}),b=y?n.range(0,y[0]).concat(n.range(y[1]+1,p)):n.range(p),w=h.scaleLinear().domain(a&&a.call(d,c,f)||[g,m]).range([i,0]),k=d.__chart__||h.scaleLinear().domain([0,1/0]).range(w.range());d.__chart__=w;var z=t.selectAll("line.center").data(x?[x]:[]);z.enter().insert("line","rect").attr("class","center").attr("x1",e/2).attr("y1",function(t){return k(t[0])}).attr("x2",e/2).attr("y2",function(t){return k(t[1])}).style("opacity",1e-6).transition().duration(r).style("opacity",1).attr("y1",function(t){return w(t[0])}).attr("y2",function(t){return w(t[1])}),z.transition().duration(r).style("opacity",1).attr("y1",function(t){return w(t[0])}).attr("y2",function(t){return w(t[1])}),z.exit().transition().duration(r).style("opacity",1e-6).attr("y1",function(t){return w(t[0])}).attr("y2",function(t){return w(t[1])}).remove();var M=t.selectAll("rect.box").data([v]);M.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(t){return k(t[2])}).attr("width",e).attr("height",function(t){return k(t[0])-k(t[2])}).transition().duration(r).attr("y",function(t){return w(t[2])}).attr("height",function(t){return w(t[0])-w(t[2])}),M.transition().duration(r).attr("y",function(t){return w(t[2])}).attr("height",function(t){return w(t[0])-w(t[2])});var S=t.selectAll("line.median").data([v[1]]);S.enter().append("line").attr("class","median").attr("x1",0).attr("y1",k).attr("x2",e).attr("y2",k).transition().duration(r).attr("y1",w).attr("y2",w),S.transition().duration(r).attr("y1",w).attr("y2",w);var _=t.selectAll("line.whisker").data(x||[]);_.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",k).attr("x2",e).attr("y2",k).style("opacity",1e-6).transition().duration(r).attr("y1",w).attr("y2",w).style("opacity",1),_.transition().duration(r).attr("y1",w).attr("y2",w).style("opacity",1),_.exit().transition().duration(r).attr("y1",w).attr("y2",w).style("opacity",1e-6).remove();var O=t.selectAll("circle.outlier").data(b,Number);O.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",e/2).attr("cy",function(t){return k(c[t])}).style("opacity",1e-6).transition().duration(r).attr("cy",function(t){return w(c[t])}).style("opacity",1),O.transition().duration(r).attr("cy",function(t){return w(c[t])}).style("opacity",1),O.exit().transition().duration(r).attr("cy",function(t){return w(c[t])}).style("opacity",1e-6).remove();var P=u||w.tickFormat(8),A=t.selectAll("text.box").data(v);A.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(t,e){return 1&e?6:-6}).attr("x",function(t,n){return 1&n?e:0}).attr("y",k).attr("text-anchor",function(t,e){return 1&e?"start":"end"}).text(P).transition().duration(r).attr("y",w),A.transition().duration(r).text(P).attr("y",w);var C=t.selectAll("text.whisker").data(x||[]);C.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",e).attr("y",k).text(P).style("opacity",1e-6).transition().duration(r).attr("y",w).style("opacity",1),C.transition().duration(r).text(P).attr("y",w).style("opacity",1),C.exit().transition().duration(r).attr("y",w).style("opacity",1e-6).remove()})}var e=1,i=1,r=0,a=null,o=Number,s=function(t){return[0,t.length-1]},l=function(t){return[n.quantile(t,.25),n.quantile(t,.5),n.quantile(t,.75)]},u=null;return t.width=function(n){return arguments.length?(e=n,t):e},t.height=function(e){return arguments.length?(i=e,t):i},t.tickFormat=function(e){return arguments.length?(u=e,t):u},t.duration=function(e){return arguments.length?(r=e,t):r},t.domain=function(e){return arguments.length?(a=null===e?e:Bt(e),t):a},t.value=function(e){return arguments.length?(o=e,t):o},t.whiskers=function(e){return arguments.length?(s=e,t):s},t.quartiles=function(e){return arguments.length?(l=e,t):l},t}(),o=this.paper().size(r),s=V(e.x),l=o.group().attr("transform",this.translate(r.total.left,r.total.top)).selectAll(".box").data(i.data),u=t.groupby(e.x),d=this.getScale(e.scaleX).domain(n.extent(t.data,s)),c=r.innerWidth;"vertical"===e.orientation?d.range([0,r.innerWidth]):(d.range([0,r.innerHeight]),c=this.innerHeight),a.width(this.dim(e.width,c,c/u.length-2)),l.enter().append("g").classed("box",!0).call(a)}}),le=bt("areachart",ee,{options:{lineWidth:1,curve:"natural",x:"x",y:"y",groupby:null,scaleX:"linear",scaleY:"linear",gradient:!0,lineDarken:.2,stack:!0,stackOrder:"none",axisX:!0,axisY:!0},doDraw:function(t){function e(t){return h(t.data[a])}function n(t){return f(t[1])}var i=this,r=this.getModel(),a=r.x,o=r.y,s=this.getModel("color"),l=this.boundingBox(),u=Qt().groupby(r.groupby).stack(this.getStack()).x(a).y(o)(t),d=u.rangeX(),c=u.rangeY(),h=this.getScale(r.scaleX).domain(d).rangeRound([0,l.innerWidth]),f=this.getScale(r.scaleY).domain(c).rangeRound([l.innerHeight,0]).nice(),p=this.group(),v=this.group("chart"),y=v.selectAll(".areagroup").data(u.data),x=this.colors(u.data.length),b=r.gradient?x.map(function(t,e){return i.linearGradient(t,l,"vertical","fill"+i.model.uid+"-"+e)}):x,w=this.curve(r.curve);this.applyTransform(p,this.translate(l.padding.left,l.padding.top)),this.applyTransform(v,this.translate(l.margin.left,l.margin.top)),y.exit().transition().style("opacity",0).remove();var k=y.enter().append("g").classed("areagroup",!0).merge(y).selectAll("path").data(function(t){var i=g.area().curve(w).x(e).y1(n).y0(function(t){return f(t[0])}),a=g.line().curve(w).x(e).y(n),o=m.color(x[t.index]);return[{type:"area",data:t,draw:i(t),stroke:"none",fill:b[t.index]},{type:"line",data:t,draw:a(t),fill:"none",stroke:o.darker(r.lineDarken)}]});k.enter().append("path").attr("class",function(t){return t.type}).attr("fill",function(t){return t.fill}).attr("stroke",function(t){return t.stroke}).attr("d",function(t){return t.draw}).merge(k).transition(this.transition("area")).attr("d",function(t){return t.draw}).attr("fill",function(t){return t.fill}).attr("stroke",function(t){return t.stroke}).attr("fill-opacity",s.fillOpacity).attr("stroke-width",r.lineWidth).attr("stroke-opacity",s.strokeOpacity),k.exit().transition().style("opacity",0).remove(),r.axisX&&this.xAxis1(!0===r.axisX?"bottom":r.axisX,h,l,d[0]),r.axisY&&this.yAxis1(!0===r.axisY?"left":r.axisY,f,l,c[0]),u.data.length>1&&this.legend({type:"color",scale:this.getScale("ordinal").range(x).domain(u.data.map(function(t){return t.key}))},l)},ticks:function(t,e){return Math.max(Math.floor(t/e),1)}}),ue=Math.PI/180,de={proportionalData:function(t,e){return t.dimension(e).top(1/0)},total:function(t){function e(e){return n+=e[t],e[t]}var n=0;return e.total=function(){return n},e}},ce=bt("piechart",de,{options:{field:"data",label:"label",startAngle:0,endAngle:360,sort:!1,innerRadius:0,padAngle:0,cornerRadius:0,lineWidth:1,fractionFormat:".1%",legendType:"color",legendLabel:"label + ' - ' + format(fraction)",center:null,centerOpacity:1,centerFontSize:"7%"},doDraw:function(t){var e=this.getModel(),n=this.getModel("color"),i=e.field,o=this.boundingBox(),s=Math.min(o.innerWidth,o.innerHeight)/2,l=M(e.innerRadius,s),u=this.total(i),d=g.pie().padAngle(ue*e.padAngle).startAngle(ue*e.startAngle).endAngle(ue*e.endAngle).value(u),c=g.arc().innerRadius(l).outerRadius(s).cornerRadius(e.cornerRadius),p=this.group(),m=this.group("chart"),v=d(this.proportionalData(t,i)),y=this.fill(v),x=m.selectAll(".slice").data(v);if(this.applyTransform(p,this.translate(o.padding.left,o.padding.top)),this.applyTransform(m,this.translate(o.margin.left+o.innerWidth/2,o.margin.top+o.innerHeight/2)),x.enter().append("path").attr("class","slice").attr("stroke",n.stroke).attr("stroke-opacity",0).attr("fill",y).attr("stroke-width",e.lineWidth).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(x).transition().attr("stroke",n.stroke).attr("stroke-opacity",n.strokeOpacity).attr("d",c).attr("fill",y),x.exit().transition().remove(),e.center){var b=r.map(v.reduce(function(t,e){return t[e.data.label]=e,t})),w=this.dataStore.eval(e.center,{total:u.total(),d:b});if(w){var k=this.getModel("font"),z=this.dim(e.centerFontSize,o.innerWidth),S=m.selectAll(".info").data([w]);S.enter().append("text").attr("class","info").attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-size",z+"px").style("fill-opacity",0).merge(S).text(w).style("fill-opacity",e.centerOpacity).style("fill",k.stroke).call(Jt,1.5*(l||s))}}if(e.legendType){u=u.total();var _=a.viewExpression(e.legendLabel),O=f.format(e.fractionFormat),P=v.map(function(t,n){return _.eval({d:t,value:t.value,format:O,total:u,fraction:t.value/u,label:t.data[e.label]||n})});this.legend({scale:h.scaleOrdinal().domain(P).range(y.colors)},o)}}}),he=bt("pyramidchart",de,{options:{field:"data",label:"label",pad:.005,lineWidth:1,inverted:!1,funnel:!1,legendType:"color",invereted:!1,legendLabel:"label + ' - ' + format('.1%', fraction)"},doDraw:function(t){var e=this.getModel(),n=e.field,i=this.getModel("color"),r=this.boundingBox(),o=(e.funnel?function(){function t(t){var a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,d=void 0,c=void 0,h=0,f=0,p=t.length,g=new Array(p),m=new Array(p),v=i/p;for(a=0;a<p;++a)g[m[a]=a]=+e(t[a],a,t);for(m.sort(function(t,e){return Kt(g[t],g[e])}),u=g[m[0]],a=0;a<p;++a)o=m[a],l=g[o]/u,s=[[(d=r*l)/2,f+(c=h)],[-d/2,f+c],[-d/2,f+v-(h=i*(a===p-1?0:.5*n(l,a)))],[d/2,f+v-h]],f+=v,g[o]={index:a,value:g[o],fraction:l,points:s,data:t[o]};return g}var e=Rt,n=Bt(0),i=1,r=1;return t.value=function(n){return arguments.length?(e="function"==typeof n?n:Bt(+n),t):e},t.base=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(i=e,t):i},t.pad=function(e){return arguments.length?(n="function"==typeof e?e:Bt(+e),t):n},t}():It()).pad(e.pad).value(function(t){return t[n]}),s=this.getScale("linear").rangeRound([0,r.innerWidth]),l=this.getScale("linear").rangeRound(e.inverted?[r.innerHeight,0]:[0,r.innerHeight]),u=t.new(o(this.proportionalData(t,n))).dimension("fraction").bottom(1/0),d=g.symbol().type(function(t){return function(t){return{draw:function(e){t.forEach(function(t,n){n?e.lineTo(t[0],t[1]):e.moveTo(t[0],t[1])}),e.closePath()}}}(t.points.map(function(t){return[s(t[0]),l(t[1])]}))}).size(1),c=this.fill(u),h=this.group(),f=this.group("chart"),p=f.style("shape-rendering","crispEdges").selectAll(".segment").data(u);if(this.applyTransform(h,this.translate(r.padding.left,r.padding.top)),this.applyTransform(f,this.translate(r.margin.left+r.innerWidth/2,r.margin.top)),p.enter().append("path").attr("class","segment").attr("stroke",i.stroke).attr("stroke-opacity",0).attr("fill",c).attr("stroke-width",e.lineWidth).attr("d",d).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(p).transition().attr("stroke",i.stroke).attr("stroke-opacity",i.strokeOpacity).attr("d",d).attr("fill",c),p.exit().remove(),e.legendType){var m=a.viewExpression(e.legendLabel),v=this,y=u.map(function(t,n){return m.eval(v.getContext({d:t,value:t.value,fraction:t.fraction,label:t.data[e.label]||n}))});this.legend({scale:this.getScale("ordinal").domain(y).range(c.colors)},r)}}}),fe=bt("treemap",{requires:["d3-hierarchy"],options:{label:"label",field:"data",padding:2,tile:"resquarify",format:","},doDraw:function(t,e){function n(t){return[t]}function i(t){var e=void 0;return t.map(function(t){return(e=t.children)&&(t._children=i(e),delete t.children),t})}var r=this,a=this.getModel(),o=this.getModel("font"),s=this.boundingBox(),l=V(a.label),u=V(a.field),d=f.format(a.format),c=e.hierarchy(function(t){return t={children:i(t)},t[a.label]="root",t}(t.data)).sum(u).sort(function(t,e){return e.value-t.value}).eachBefore(function(t){t.parent?(t.data._counter=t.parent.data._counter,t.parent.data._counter++):t.data._counter=0}),h=e.treemap().tile(xt(e,"treemap",a.tile,!0)).size([s.innerWidth,s.innerHeight]).round(!0).padding(a.padding),p=this.fill(c.children).colors,g=this.group().attr("transform",this.translate(s.total.left,s.total.top)).style("shape-rendering","crispEdges"),m=h(c).leaves(),v=g.selectAll("g").data(m),y=this;this.paper().size(s),v.exit().remove();var x=(v=v.enter().append("g").attr("transform",function(t){return r.translate(t.x0,t.y0)}).merge(v).attr("transform",function(t){return r.translate(t.x0,t.y0)})).selectAll("rect").data(n);x.enter().append("rect").attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).attr("fill",function(t){return p[t.data._counter]}).attr("stroke","none").on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(x).transition().attr("width",function(t){return t.x1-t.x0}).attr("height",function(t){return t.y1-t.y0}).attr("fill",function(t){return p[t.data._counter]}),(x=v.selectAll("text").data(n)).enter().append("text").style("fill",function(t){return Zt(p[t.data._counter],"#fff",o.stroke)}).selectAll("tspan").data(function(t){var e=y.font({height:Math.min(t.x1-t.x0,t.y1-t.y0)}),n=l(t.data).split(/(?=[A-Z][^A-Z])/g);return n.push(d(t.value)),n.map(function(t){return{size:e,text:t}})}).enter().append("tspan").style("font-size",function(t){return t.size}).attr("x",4).attr("y",function(t,e){return 1.5*t.size+1.2*e*t.size}).text(function(t){return t.text})}}),pe=bt("text",{options:{label:"label",data:"data",text:'label + " " + data',sizeReduction:.7},doDraw:function(t){function e(t,e){return n.translate((e+.5)*d,0)}var n=this,i=this.getModel(),r=this.getModel("font"),a=this.boundingBox(),o=this.font(a),s=this.group(),l=this.group("chart"),u=l.selectAll("text").data(t.data),d=a.innerWidth/t.data.length,c=.4*d,h=this.dataStore,f=this.modelProperty("stroke",r);this.applyTransform(s,this.translate(a.padding.left,a.padding.top)),this.applyTransform(l,this.translate(a.margin.left,a.margin.top+a.innerHeight/2)),u.enter().append("text").attr("transform",e).attr("text-anchor","middle").attr("alignment-baseline","middle").style("fill",f).merge(u).attr("transform",e).text(function(t){return h.eval(i.text,t)}).style("fill",f).call(Jt,c,function(t,e){var r=o;e&&(r=i.sizeReduction*o),n.select(this).attr("font-size",r+"px")}),s.exit().remove()}}),ge=bt("heatmap",ee,{options:{shape:"square",layout:"heatmap",buckets:10,pad:.005,x:"x",y:"y",z:"data",label:null,axisX:!0,axisY:!0,reverseColors:!0,tableColors:null},doDraw:function(t){function e(t){return t.data[r.label]}function i(t){return Zt(t.color,"#fff",o.stroke)}var r=this.getModel(),a=this.getModel("color"),o=this.getModel("font"),s=r.layout,l=this.boundingBox(),u=n.extent(t.data,V(r.z));u[0]<0&&"punchcard"===s&&(s="heatmap");var d=this.heatmap(s,t,l,u),c=(l.innerWidth-d.width)/2,h=(l.innerHeight-d.height)/2,f=this.getSymbol(r.shape).size(function(t){return t.size*t.size}),p=this.group(),g=this.group("chart"),m=g.selectAll(".shape").data(d.data);if(this.applyTransform(p,this.translate(l.padding.left,l.padding.top)),this.applyTransform(g,this.translate(l.margin.left+c,l.margin.top+h)),n.range[0]<0&&"punchcard"===s&&(s="heatmap"),m.enter().append("path").classed("shape",!0).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).attr("fill",function(t){return t.color}).attr("fill-opacity",0).attr("stroke-opacity",0).attr("stroke",a.stroke).attr("d",f).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(m).transition(this.transition()).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).attr("fill-opacity",a.fillOpacity).attr("fill",function(t){return t.color}).attr("stroke-opacity",a.strokeOpacity).attr("stroke",a.stroke).attr("d",f),r.label&&"heatmap"===s){var v=this.font(l)+"px",y=g.selectAll(".labels").data(d.data);y.enter().append("text").classed("labels",!0).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).style("text-anchor","middle").style("alignment-baseline","middle").style("fill",i).style("font-size",v).text(e).merge(y).text(e).style("font-size",v).call(Jt,Math.ceil(.8*d.size)).transition(this.transition("text")).attr("transform",function(t){return"translate("+t.x+", "+t.y+")"}).style("fill",i)}var x={innerWidth:d.width,innerHeight:d.height,margin:{top:l.margin.top+h,left:l.margin.left+c}};r.axisX&&this.xAxis1(!0===r.axisX?"bottom":r.axisX,d.scaleX,x),r.axisY&&this.yAxis1(!0===r.axisY?"left":r.axisY,d.scaleY,x),"heatmap"===s?this.legend({type:"color",shape:r.shape,scale:d.colors},l):"punchcard"===s&&this.legend({type:"size",shape:r.shape,scale:d.sizes},l)},heatmap:function(t,e,i,a){var o=this.getModel(),s=o.pad,l=o.x,u=o.y,d=o.z,c=e.dimension(o.x).group().size(),h=e.dimension(o.y).group().size(),f=Math.min(o.buckets,c*h),p=(1-s*(c+1))*i.innerWidth/c,g=(1-s*(h+1))*i.innerHeight/h,m=[],v=[],y=[],x=r.map(),b=r.map(),w=void 0,k=void 0,z=void 0,M=void 0,S=void 0,_=void 0,O=void 0,P=void 0,A=void 0,C=void 0;if(p<g?(P=p,A=i.innerWidth,C=h*(P+(s*=A))+s):(P=g,C=i.innerHeight,A=c*(P+(s*=C))+s),a=Ut(a,f),"heatmap"===t){var T=this.fill(n.range(f)).colors;o.reverseColors&&(T=T.reverse()),_=this.getScale("quantile").range(T).domain(a),O=function(){return 1}}else{var W=this.colors(1)[0];_=function(){return W},O=this.getScale("quantile").range(n.range(f).map(function(t){return(t+1)/f})).domain(a)}return e.data.forEach(function(t){w=t[l],k=t[u],z=t[d],x.has(w)||(x.set(w,v.length),v.push(w)),b.has(k)||(b.set(k,y.length),y.push(k)),M=x.get(w),S=b.get(k),m.push({i:M,j:S,x:s+P/2+M*(P+s),y:s+P/2+S*(P+s),color:_(z),size:P*O(z),data:t})}),{data:m,size:P,width:A,height:C,scaleX:this.getScale("band").domain(v).range([0,A]),scaleY:this.getScale("band").domain(y).range([0,C]),colors:_,sizes:O}}}),me=bt("geochart",{requires:["d3-geo","topojson","d3-geo-projection"],options:{geometry:"countries",geoKey:"id",dataKey:"id",dataLabelKey:"label",dataValueKey:"value",buckets:10,choroplethScale:"quantile",boundGeometry:null,boundScaleFactor:.9,projection:null,graticule:!1,leaflet:!1,scale:200,mouseover:["darken","tooltip"]},doDraw:function(t,e){var n=this.getGeoData(t);if(!n)return Z("Topojson data not available - cannot draw topology");this._geoPath||this.createGeoPath(e,n),this.update(e,n)},update:function(t,e){var n=this.getModel(),i=this.getModel("color"),r=this.boundingBox(),a=this.group(),o=this.group("geo"),s=this._geoPath,l=e.topology.objects[n.geometry],u=l?t.feature(e.topology,l).features:null,d=u?o.selectAll(".geometry").data(u):null,c="none";if(!d){var h=Object.keys(e.topology.objects).map(function(t){return'"'+t+'"'}).join(", ");return Z('Could not find *geometry* "'+n.geometry+'" in ['+h+"] - cannot draw geochart")}a.transition(this.transition("group0")).attr("transform",this.translate(r.padding.left,r.padding.top)),o.transition(this.transition("group1")).attr("transform",this.translate(r.margin.left,r.margin.top)),this.center(t,e),e.data&&(c=this.choropleth(e.data,r)),d.enter().append("path").attr("class","geometry").attr("d",s).style("fill","none").style("stroke",i.stroke).style("stroke-opacity",0).style("fill-opacity",0).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(d).transition(this.transition("geometry")).attr("d",s).style("stroke",i.stroke).style("stroke-opacity",i.strokeOpacity).style("fill",c).style("fill-opacity",i.fillOpacity),d.exit().remove()},createGeoPath:function(t,e){var n,i=this.getModel(),r=xt(t,"geo",e.projection).scale(i.scale),a=t.geoPath().projection(r),o=this;if(this._geoPath=a,this.center(t,e),i.leaflet){var s="leaflet-"+i.uid,l=this.paper();this.visualParent.paper.append("div").attr("id",s),(n=new t.Map(s,{center:[37.8,-96.9],zoom:4}).addLayer(new t.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"))).getPanes().overlayPane.appendChild(l.element),r=t.transform({point:function(e,i){var r=n.latLngToLayerPoint(new t.LatLng(i,e));this.stream.point(r.x,r.y)}}),n.on("viewreset",function(){return o.update(t,e)})}return a},getGeoData:function(t){var e={};if("frameCollection"===t.type?t.frames.each(function(t){"Topology"===t.type?e.topology=t:"dataframe"===t.type&&(e.data=t)}):"Topology"===t.type&&(e.topology=t),e.topology){var n=this.getModel();return n.projection?e.projection=n.proection:e.projection="kavrayskiy7",e}},center:function(t,e){var n=this.getModel();if(n.boundGeometry){var i=this._geoPath,r=i.projection(),a=this.boundingBox(),o=e.topology.objects[n.boundGeometry],s=o?t.feature(e.topology,o).features:null;if(!s)return Z('Could not find *boundGeometry* "'+n.boundGeometry+'" for centering - skip centering geochart');r.scale(1).translate([0,0]);var l=i.bounds(s[0]),u=l[0],d=l[1],c=(d[0]-u[0])/a.innerWidth,h=(d[1]-u[1])/a.innerHeight,f=Math.round(n.boundScaleFactor/Math.max(c,h)),p=[(a.innerWidth-f*(d[0]+u[0]))/2,(a.innerHeight-f*(d[1]+u[1]))/2];r.scale(f).translate(p)}},choropleth:function(t,e){var i=this.getModel(),r=Math.min(i.buckets,t.data.length),a=i.dataKey,o=i.dataLabelKey,s=i.dataValueKey,l=i.geoKey,u=Ut(n.extent(t.data,V(s)),r),d=this.getScale(i.choroplethScale).range(this.colors(r).reverse()).domain(u),c=t.data.reduce(function(t,e){return t[e[a]]=e,t},{}),h=void 0,f=void 0;return this.legend({type:"color",scale:d},e),function(t){return h=t.properties[l]||t[l],f=c[h],t.choropleth={label:f[o]||h,value:f[s],color:d(f[s])},t.choropleth.color}}}),ve=bt("geochart2",{requires:["d3-geo","topojson","d3-geo-projection"],options:{geometry:"countries",geoKey:"id",dataKey:"id",dataLabelKey:"label",dataValueKey:"value",neighbors:!1,buckets:10,choroplethScale:"quantile",boundGeometry:null,boundScaleFactor:.9,projection:"kavrayskiy7",graticule:!1,leaflet:!1,scale:200,mouseover:["darken","tooltip"]},doDraw:function(t,e){var n=function(t){var e={};return"frameCollection"===t.type?t.frames.each(function(t){"Topology"===t.type?e.topology=t:"dataframe"===t.type&&(e.data=t.data)}):"Topology"===t.type&&(e.topology=t),e}(t);if(!n.topology)return Z("Topojson data not available - cannot draw topology");this._geoPath||this.createGeoPath(e,n),this.update(e,n)},update:function(t,i){var r=this.getModel(),a=this.getModel("color"),o=this.boundingBox(),s=this.group(),l=this.group("geo"),u=this._geoPath,d=function(t,i,r){var a=r.geoKey,o=r.dataKey,s={},l=void 0,u=void 0,d=void 0;if(!i.topology)return Z("No topology object available");var c=i.topology.objects[r.geometry];if(!c)return Z("Topology object "+r.geometry+" is not available");var h=r.neighbors?t.neighbors(c.geometries):null;return l=t.feature(i.topology,c).features,i.data&&(s=i.data.reduce(function(t,e){return t[e[o]]=e,t},{})),l=l.map(function(t){return d=t.properties,u=t[a]||d[a],{id:u,type:t.type,geometry:t.geometry,data:e.assign({},d,s[u])}}),h&&l.forEach(function(t,e){t.neighbors=h[e],t.rank=n.max(t.neighbors,function(t){return l[t].rank})+1|0}),l}(t,i,r);if(!d){var c=Object.keys(i.topology.objects).map(function(t){return'"'+t+'"'}).join(", ");return Z('Could not find *geometry* "'+r.geometry+'" in ['+c+"] - cannot draw geochart")}s.transition(this.transition("group0")).attr("transform",this.translate(o.padding.left,o.padding.top)),l.transition(this.transition("group1")).attr("transform",this.translate(o.margin.left,o.margin.top));var h=l.selectAll(".geometry").data(d),f=this.choropleth(d,o);this.center(t,i),h.enter().append("path").attr("class","geometry").attr("d",u).style("fill","none").style("stroke",this.modelProperty("stroke",a)).on("mouseover",this.mouseOver()).on("mouseout",this.mouseOut()).merge(h).transition(this.transition("geometry")).attr("d",u).style("stroke",this.modelProperty("stroke",a)).style("fill",f).style("fill-opacity",a.fillOpacity),h.exit().remove()},createGeoPath:function(t,e){var n,i=this.getModel(),r=xt(t,"geo",i.projection).scale(i.scale),a=t.geoPath().projection(r),o=this;if(this._geoPath=a,this.center(t,e),i.leaflet){var s="leaflet-"+i.uid,l=this.paper();this.visualParent.paper.append("div").attr("id",s),(n=new t.Map(s,{center:[37.8,-96.9],zoom:4}).addLayer(new t.TileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"))).getPanes().overlayPane.appendChild(l.element),r=t.transform({point:function(e,i){var r=n.latLngToLayerPoint(new t.LatLng(i,e));this.stream.point(r.x,r.y)}}),n.on("viewreset",function(){return o.update(t,e)})}return a},center:function(t,e){var n=this.getModel();if(n.boundGeometry){var i=this._geoPath,r=i.projection(),a=this.boundingBox(),o=e.topology.objects[n.boundGeometry],s=o?t.feature(e.topology,o).features:null;if(!s)return Z('Could not find *boundGeometry* "'+n.boundGeometry+'" for centering - skip centering geochart');r.scale(1).translate([0,0]);var l=i.bounds(s[0]),u=l[0],d=l[1],c=(d[0]-u[0])/a.innerWidth,h=(d[1]-u[1])/a.innerHeight,f=Math.round(n.boundScaleFactor/Math.max(c,h)),p=[(a.innerWidth-f*(d[0]+u[0]))/2,(a.innerHeight-f*(d[1]+u[1]))/2];r.scale(f).translate(p)}},choropleth:function(t,e){var i=this.getModel(),r=i.dataLabelKey,a=i.dataValueKey,o=void 0,s=void 0,l=void 0,u=void 0;return i.neighbors?(o=V("rank"),u=(s=n.extent(t,o))[1]+1):(o=function(t){return t.data[a]},u=Math.min(i.buckets,t.length),s=Ut(n.extent(t,o),u)),l=this.getScale(i.choroplethScale).range(this.colors(u).reverse()).domain(s),this.legend({type:"color",scale:l},e),function(t){return t.label=t.data[r]||t.id,t.value=o(t),t.color=l(t.value),t.color}}}),ye={initialise:function(t){wt.initialise.call(this,t);var n=this.getLayers();e.isArray(n)&&n.length||(Z("a composite chart requires layers"),n=[]),Object.defineProperties(this,{element:{get:function(){return this.visualParent.element}},paperElement:{get:function(){return this.visualParent.paperElement}},sel:{get:function(){return this.visualParent.sel}},width:{get:function(){return this.boundingBox().innerWidth}},height:{get:function(){return this.boundingBox().innerHeight}}});var i=this,a=r.set(),o=void 0,s=void 0,l=void 0;this.layers=[],n.forEach(function(t){t=e.assign({},t),s=e.pop(t,"type"),(l=gt.types[s])?(t[s]=e.assign({},t[s],i.options[s]),(o=new l(i.element,t,i)).requires&&o.requires.forEach(function(t){return a.add(t)})):Z('Cannot add visual type "'+s+'", not available')}),this.requires=a.values(),this.requires.length||delete this.requires},getLayers:function(){},layerOptions:function(t){return e.assign(t,this.options)},getPaperGroup:function(t){var e=this.boundingBox(),n=this.group("layers");return this.applyTransform(n,this.translate(e.margin.left,e.margin.top)),this.paper().childGroup(n,t)},doDraw:function(t,e){var n=this.boundingBox();this.applyTransform(this.group(),this.translate(n.padding.left,n.padding.top)),this.layers.forEach(function(n){return n.doDraw(t,e)})}};t.visualizeVersion="0.3.5",t.randomPath=function(t,r){r=e.assign({},B,r);for(var a,o=n.range(0,+t,1),s=r.sigma,l=r.drift,u=[{x:0,y:0}],d=i.randomNormal(0,1),c=1;c<o.length;c++)a=l+s*d(),u[c]={x:c,y:u[c-1].y+a};return u},t.DataStore=z,t.dataSources=dt,t.visuals=gt,t.createChart=bt,t.createPaper=A,t.Svg=Mt,t.Div=St,t.visualTransform=K,t.visualTransforms=st,t.visualComponents=Nt,t.colorScales=Ht,t.pyramid=It,t.niceRange=Ut,t.slugify=function(t){t=(t=t.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var e="/_,:;",n=0,i=e.length;n<i;n++)t=t.replace(new RegExp(e.charAt(n),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(n));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")},t.Visual=yt,t.BarChart=ae,t.BoxChart=se,t.LineChart=ne,t.AreaChart=le,t.PieChart=ce,t.PyramidChart=he,t.Treemap=fe,t.TextChart=pe,t.Heatmap=ge,t.GeoChart=me,t.GeoChart2=ve,t.createCompositeChart=function(t){for(var n=[{},wt,kt,ye],i=1;i<arguments.length;++i)n.push(arguments[i]);return vt(t,e.assign.apply(void 0,n))},Object.defineProperty(t,"__esModule",{value:!0})});