// https://github.com/quantmind/d3-quant Version 0.4.2. Copyright 2017 quantmind.com.
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("d3-array")):"function"==typeof define&&define.amd?define("d3-quant",["exports","d3-array"],r):r(t.d3=t.d3||{},t.d3)}(this,function(t,r){"use strict";function n(t){return new e(t)}function e(t){function r(){if(0===h)return h++,o.slice();for(var r=[],e=1,a=h-1;1==(1&a);)a>>=1,e++;for(n=0;n<t;n++)s[n]^=i[n][e],r[n]=s[n]/l;return h++,r}if(t<1||t>v.length)throw new Error("Out of range dimension");var n,e=[],i=[],o=[],s=[],a=v,h=0;for(Object.defineProperties(this,{dimension:{get:function(){return t}},count:{get:function(){return h}}}),this.next=r,n=0;n<=c;n++)e.push(0);for(n=0;n<t;n++)i[n]=e.slice(),s[n]=0,o[n]=0;for(n=1;n<=c;n++)i[0][n]=1<<c-n;for(var u=1;u<t;u++){var f=a[u].split(/\s+/),p=+f[1],d=+f[2],g=[0];for(n=0;n<p;n++)g.push(+f[3+n]);for(n=1;n<=p;n++)i[u][n]=g[n]<<c-n;for(n=p+1;n<=c;n++){i[u][n]=i[u][n-p]^i[u][n-p]>>p;for(var m=1;m<=p-1;m++)i[u][n]^=(d>>p-1-m&1)*i[u][n-m]}}}function i(t,r){for(var n=0,e=0;e<t.length;e++)n+=Math.pow(r[e]-t[e],2);return Math.sqrt(n)}function o(t){return t instanceof o?t:(new s).addTenure(t)}function s(){this.$months=0,this.$days=0,Object.defineProperties(this,{years:{get:function(){return Math.trunc(this.$months/12)}},months:{get:function(){return this.$months%12}},weeks:{get:function(){return Math.trunc(this.$days/7)}},days:{get:function(){return this.$days%7}},totalDays:{get:function(){return 30*this.$months+this.$days}}})}function a(){return new h}function h(){this.root=null}function u(t){this.score="number"==typeof t?t:t.score,this.value=t.value,this.parent=null,this.left=null,this.right=null,this.red=!1,Object.defineProperty(this,"root",{get:function(){return this.parent?this.parent.root:this}})}function f(t){var r;return t.parent&&t.parent.red?(t.parent===t.parent.parent.left?(r=t.parent.parent.right,r&&r.red?(t.parent.red=!1,r.red=!1,t.parent.parent.red=!0,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,p(t)),t.parent.red=!1,t.parent.parent.red=!0,d(t.parent.parent))):(r=t.parent.parent.left,r&&r.red?(t.parent.red=!1,r.red=!1,t.parent.parent.red=!0,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,d(t)),t.parent.red=!1,t.parent.parent.red=!0,p(t.parent.parent))),f(t)):(t=t.root,t.red=!1,t)}function p(t){var r=t.right;t.right=r.left,r.left&&(r.left.parent=t),r.parent=t.parent,t.parent&&(t===t.parent.left?t.parent.left=r:t.parent.right=r),r.left=t,t.parent=r}function d(t){var r=t.left;t.left=r.right,r.right&&(r.right.parent=t),r.parent=t.parent,t.parent&&(t===t.parent.right?t.parent.right=r:t.parent.left=r),r.right=t,t.parent=r}var c=52,l=2<<51,v=["d       s       a       m_i","2       1       0       1","3       2       1       1 3","4       3       1       1 3 1","5       3       2       1 1 1","6       4       1       1 1 3 3","7       4       4       1 3 5 13","8       5       2       1 1 5 5 17","9       5       4       1 1 5 5 5","10      5       7       1 1 7 11 1"];e.prototype={generate:function(t){for(var r=[],n=0;n<t;++n)r.push(this.next());return r}};var g=Object.freeze({euclidean:i}),m=function(){var t,n,e=300,i={centroids:function(t){return arguments.length?(n=t,i):n},maxIters:function(t){return arguments.length?(e=+t,i):e},distance:function(r){return arguments.length?(r=r||"euclidean","string"==typeof r&&(r=g[r]),t=r,i):t},randomCentroids:function(t,r){var n=t.slice(0);return n.sort(function(){return Math.round(Math.random())-.5}),n.slice(0,r)},classify:function(r){var e=1/0,i=0,o=void 0,s=void 0;for(o=0;o<n.length;o++)s=t(r,n[o]),s<e&&(e=s,i=o);return i},cluster:function(t,e){var o,s,a,h=0,u=!0,f=t.length;n||(n=i.randomCentroids(t,f),i.centroids(n));var p=n.length,d=new Array(p);if(f<p)throw Error("Number of points less than the number of clusters in K-means classification");for(;u&&h<i.maxIters();){for(u=!1,++h,a=0;a<p;++a)d[a]={centroid:n[a],points:[],indices:[]};for(s=0;s<f;s++)a=i.classify(t[s]),d[a].points.push(t[s]),d[a].indices.push(s);for(o=[],a=0;a<p;++a){if(!d[a].points.length){o=i.randomCentroids(t,p);break}o.push(r.mean(d[a].points))}for(a=0;a<p;++a)if(o[a]!=n[a]){n=o,u=!0;break}i.centroids(n),e&&e(d,h)}return d}};return i.distance("euclidean")},y=function(t,r,n){function e(t,r){var n=t/h|0,e=r/h|0,i=Math.max(n-2,0),o=Math.max(e-2,0),a=Math.min(n+3,u),d=Math.min(e+3,f);for(e=o;e<d;++e){var c=e*u;for(n=i;n<a;++n)if(l=p[c+n]){var l,v=l[0]-t,g=l[1]-r;if(v*v+g*g<s)return!1}}return!0}function i(t,r){var n=[t,r];return d.push(n),p[u*(r/h|0)+(t/h|0)]=n,++l,++c,n}var o=30,s=n*n,a=3*s,h=n*Math.SQRT1_2,u=Math.ceil(t/h),f=Math.ceil(r/h),p=new Array(u*f),d=[],c=0,l=0;return function(){if(!l)return i(Math.random()*t,Math.random()*r);for(;c;){for(var n=Math.random()*c|0,h=d[n],u=0;u<o;++u){var f=2*Math.PI*Math.random(),p=Math.sqrt(Math.random()*a+s),v=h[0]+p*Math.cos(f),g=h[1]+p*Math.sin(f);if(0<=v&&v<t&&0<=g&&g<r&&e(v,g))return i(v,g)}d[n]=d[--c],d.length=c}}},M={Y:"Years",M:"Months",W:"Weeks",D:"Days"};s.prototype=o.prototype={addTenure:function(t){if(t instanceof o)this.$months+=t.$months,this.$days+=t.$days;else{var r,n,e=(""+t).toUpperCase(),i="DWMY",s=0,a=i[s],h=1;for("-"===e[0]&&(h=-1,e=e.substring(1));e.length;){if(!a)throw new Error('Unknown period "'+t+'"');if(r=e.indexOf(a),r!=-1){for(n=0;r-n-1>=0&&+e[r-n-1]===+e[r-n-1];)n++;if(!n)throw new Error('Unknown period "'+t+'"');this["add"+M[a]](h*e.substring(r-n,r)),e=e.substring(0,r-n)+e.substring(r+1)}else a=i[++s]}}return this},addDays:function(t){this.$days+=t},addWeeks:function(t){this.$days+=7*t},addMonths:function(t){this.$months+=t},addYears:function(t){this.$months+=12*t}};var w=function(t,r){return r?Math.round(t*(r=Math.pow(10,r)))/r:Math.round(t)};h.prototype=a.prototype={insert:function(t,r){this.root?this.root=this.root.insert(t,r):(this.root=new u(t),r&&r(this.root))},size:function(){return this.root?this.root.size():0},maxDepth:function(){return this.root?this.root.maxDepth():0},traverse:function(t){this.root?this.root.traverse(t):null},traverseInOrder:function(t){this.root?this.root.traverseInOrder(t):null},nodes:function(){return this.root?this.root.nodes():[]},links:function(){return this.root?this.root.links():[]}},u.prototype={insert:function(t,r){var n,e="number"==typeof t?t:t.score;if(e>this.score){if(this.right)return this.right.insert(t);this.right=n=new u(e)}else{if(this.left)return this.left.insert(t);this.left=n=new u(e)}n.red=!0,n.parent=this;var i=f(n);return r&&r(n),i},size:function(){var t=0;return this.traverse(function(){t++}),t},depth:function(){return this.parent?this.parent.depth()+1:0},maxDepth:function(){var t=this.left?this.left.maxDepth()+1:0,r=this.right?this.right.maxDepth()+1:0;return Math.max(t,r)},traverse:function(t){t(this),this.left&&this.left.traverse(t),this.right&&this.right.traverse(t)},traverseInOrder:function(t){this.left&&this.left.traverseInOrder(t),t(this),this.right&&this.right.traverseInOrder(t)},nodes:function t(){var t=[];return this.traverseInOrder(function(r){t.push(r)}),t},links:function t(){var t=[];return this.traverse(function(r){r.parent&&t.push({source:r.parent.index,target:r.index})}),t}};var b="0.4.2";t.sobol=n,t.kmeans=m,t.poisson=y,t.period=o,t.round=w,t.binaryTree=a,t.quantVersion=b,Object.defineProperty(t,"__esModule",{value:!0})});