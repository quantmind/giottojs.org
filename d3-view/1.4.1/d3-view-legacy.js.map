{"version":3,"file":"d3-view-legacy.js","sources":["../src/utils/htmlprops.js","../src/directives/attr.js","../src/directives/html.js","../src/utils/debounce.js","../src/utils/sel.js","../src/directives/types/type.js","../src/directives/types/input.js","../src/directives/types/checkbox.js","../src/directives/types/select.js","../src/directives/types/index.js","../src/directives/value.js","../src/directives/on.js","../src/core/getdirs.js","../src/utils/slice.js","../src/require.js","../src/utils/providers.js","../src/utils/warn.js","../src/core/selection.js","../src/utils/template.js","../src/utils/http.js","../src/utils/select.js","../src/core/base.js","../src/core/transition.js","../src/parser/jsep.js","../src/parser/eval.js","../src/parser/expression.js","../src/utils/uid.js","../src/model/dispatch.js","../src/model/as.js","../src/model/string.js","../src/utils/object.js","../src/model/set.js","../src/model/connect.js","../src/model/on.js","../src/model/update.js","../src/model/off.js","../src/model/change.js","../src/model/isreactive.js","../src/model/owner.js","../src/model/data.js","../src/model/emit.js","../src/model/array.js","../src/model/main.js","../src/core/directive.js","../src/utils/maybeJson.js","../src/utils/map.js","../src/utils/data.js","../src/core/cache.js","../src/utils/dashify.js","../src/core/component.js","../src/directives/for.js","../src/directives/if.js","../src/directives/index.js","../src/core/clean.js","../src/main.js","../src/utils/dom.js","../src/forms/utils.js","../src/forms/field.js","../src/forms/field-set.js","../src/forms/validators.js","../src/forms/validate.js","../src/forms/field-input.js","../src/forms/field-textarea.js","../src/forms/field-select.js","../src/forms/field-submit.js","../src/forms/responses.js","../src/forms/actions.js","../src/forms/form.js","../src/forms/plugin.js","../src/forms/bootstrap/error.js","../src/forms/bootstrap/label.js","../src/forms/bootstrap/form-group.js","../src/forms/bootstrap/input-group.js","../src/forms/bootstrap/check.js","../src/forms/bootstrap/submit.js","../src/forms/bootstrap/help.js","../src/forms/bootstrap/plugin.js","../src/utils/slugify.js"],"sourcesContent":["export default new Map([\n    ['disabled', 'disabled'],\n    ['readonly', 'readOnly'],\n    ['required', 'required']\n]);\n","import {isArray} from 'd3-let';\n\nimport properties from '../utils/htmlprops';\n\n\n//\n//  d3-attr-<attr> directive\n//  ==============================\n//\n//  Create a one-way binding between a model and a HTML element attribute\n//\nexport default {\n\n    create (expression) {\n        if (!this.arg) return this.logWarn('Cannot bind to empty attribute. Specify :<attr-name>');\n        return expression;\n    },\n\n    refresh (model, value) {\n        if (this.arg === 'class') return this.refreshClass(value);\n        if (isArray(value)) return this.logWarn(`Cannot apply array to attribute ${this.arg}`);\n        var prop = properties.get(this.arg);\n        if (prop) this.sel.property(prop, value || false);\n        else this.sel.attr(this.arg, value || null);\n    },\n\n    refreshClass (value) {\n        var sel = this.sel;\n\n        if (!isArray(value)) value = [value];\n\n        if (this.oldValue)\n            this.oldValue.forEach(entry => {\n                if (entry)\n                    sel.classed(entry, false);\n            });\n\n        this.oldValue = value.map(entry => {\n            var exist = true;\n            if (isArray(entry)) {\n                exist = entry[1];\n                entry = entry[0];\n            }\n            if (entry)\n                sel.classed(entry, exist);\n            return entry;\n        });\n    }\n\n};\n","import {isString, isNumber} from 'd3-let';\n//\n//  d3-html\n//  =============\n//  attach html or text to the innerHtml property and mount components if required\n//\n//  Usage:\n//      <div id=\"foo\" d3-html=\"output\"></div>\nexport default {\n\n    refresh (model, html) {\n        if (isNumber(html)) html = ''+html;\n        if (isString(html)) {\n            var dir = this,\n                sel = this.sel,\n                transition = this.passes ? this.transition(sel) : null;\n            if (transition) {\n                transition.style('opacity', 0).on('end', () => {\n                    sel.html(html);\n                    dir.selectChildren().mount();\n                    dir.transition(sel).style('opacity', 1);\n                });\n            } else {\n                sel.html(html);\n                this.selectChildren().mount();\n            }\n        }\n    }\n};\n","import {timeout} from 'd3-timer';\n\n//\n// Evaluate a callback (optional) with given delay (optional)\n//\n// if delay is not given or 0, the callback is evaluated at the next tick\n// of the event loop.\n// Calling this method multiple times in the same event loop tick produces\n// always the initial promise\nexport default function (callback, delay) {\n    let promise = null,\n        self, args;\n\n    function debounce () {\n        self = this;\n        args = arguments;\n        if (promise !== null) return promise;\n\n        promise = new Promise((resolve, reject) => {\n\n            timeout(() => {\n                promise = null;\n                try {\n                    resolve(callback ? callback.apply(self, args) : undefined);\n                } catch (err) {\n                    reject(err);\n                }\n            }, delay);\n        });\n\n        return promise;\n    }\n\n    debounce.promise = function () {\n        return promise;\n    };\n\n    return debounce;\n}\n","import {select} from 'd3-selection';\n\n\nexport default function (o) {\n\n    Object.defineProperty(o, 'sel', {\n        get () {\n            return select(this.el);\n        }\n    });\n\n    return o;\n}\n","import {assign} from 'd3-let';\n\nimport debounce from '../../utils/debounce';\nimport sel from '../../utils/sel';\n\n\nconst base = {\n\n    on (model, attrName) {\n        var refresh = refreshFunction(this, model, attrName),\n            uid = model.uid;\n\n        // DOM => model binding\n        this.sel\n            .on(`input.${uid}`, refresh)\n            .on(`change.${uid}`, refresh);\n    },\n\n    off (model) {\n        var uid = model.uid;\n        this.sel\n            .on(`input.${uid}`, null)\n            .on(`change.${uid}`, null);\n    },\n\n    value (value) {\n        if (arguments.length)\n            this.sel.property('value', value);\n        else\n            return this.sel.property('value');\n    }\n};\n\n\nexport function createValueType (proto) {\n\n    function ValueType(el) {\n        sel(this).el = el;\n    }\n\n    ValueType.prototype = assign({}, base, proto);\n\n    return ValueType;\n}\n\n\nexport function refreshFunction (vType, model, attrName) {\n\n    return debounce(() => {\n        model.$set(attrName, vType.value());\n    });\n}\n","import {createValueType} from './type';\n\nexport default createValueType();\n","import {createValueType} from './type';\n\nexport default createValueType({\n    value (value) {\n        if (arguments.length)\n            this.sel.property('checked', value);\n        else\n            return this.sel.property('checked');\n    }\n});\n","import {isArray} from 'd3-let';\nimport {select} from 'd3-selection';\n\nimport {createValueType} from './type';\n\n\nexport default createValueType({\n\n    value (value) {\n        var sel = this.sel,\n            options = sel.selectAll('option'),\n            values = value,\n            opt;\n\n        if (arguments.length) {\n            if (!isArray(values)) values = [value || ''];\n            options.each(function () {\n                opt = select(this);\n                value = opt.attr('value') || '';\n                opt.property('selected', values.indexOf(value) > -1);\n            });\n        } else {\n            values = [];\n            options.each(function () {\n                opt = select(this);\n                if (opt.property('selected'))\n                    values.push(opt.attr('value') || '');\n            });\n            if (sel.property('multiple')) return values;\n            else return values[0] || '';\n        }\n    }\n});\n","import input from './input';\nimport checkbox from './checkbox';\nimport select from './select';\n\nexport default {\n    input,\n    textarea: input,\n    select,\n    checkbox\n};\n","import types from './types/index';\n\n//\n//  d3-value directive\n//  ===================\n//\n//  Two-way data binding for HTML elements supporting the value property\nexport default {\n\n    create (expression) {\n        var type = this.sel.attr('type'),\n            tag = this.el.tagName.toLowerCase(),\n            ValueType = types[type] || types[tag];\n\n        if (!ValueType) {\n            this.logWarn(`Cannot apply d3-value directive to ${tag}`);\n            return;\n        }\n        this.tag = new ValueType(this.el);\n        return expression;\n    },\n\n    mount (model) {\n        var expr = this.expression;\n        // TODO: relax this constraint\n        if (expr.parsed.type !== expr.codes.IDENTIFIER) {\n            this.logWarn(`support identifiers only, got \"${expr.parsed.type}\": ${this.expression}`);\n            return;\n        }\n        var attrName = this.expression.expr;\n        //\n        // Create the model reactive attribute\n        model.$set(attrName, this.tag.value());\n        // register dom event\n        this.tag.on(model, attrName);\n        return model;\n    },\n\n    refresh (model, value) {\n        this.tag.value(value);\n    },\n\n    destroy (model) {\n        this.tag.off(model);\n    }\n};\n","//\n//  d3-on directive\n//\n//  A one-way data binding from dom events to model properties/methods\n//  Event listeners are on the DOM, not on the model\nexport default {\n\n    mount (model) {\n        var eventName = this.arg || 'click',\n            expr = this.expression;\n\n        // DOM event => model binding\n        this.on(this.sel, `${eventName}.${this.uid}`, event => {\n            var md = model.$child();\n            md.$event = event;\n            expr.eval(md);\n        });\n\n        this.bindDestroy(model);\n        // Does not return the model so that model data binding is not performed\n    },\n\n    destroy () {\n        var eventName = this.arg || 'click';\n        this.on(this.sel, `${eventName}.${this.uid}`, null);\n    }\n};\n","// No value, it has its own directive\nconst attributes = ['name', 'class', 'disabled', 'readonly', 'required', 'href'];\n\n\nexport default function (element, vm) {\n    const dirs = new Directives();\n\n    for (let i = 0; i < element.attributes.length; ++i) {\n        let attr = element.attributes[i],\n            bits = attr.name.split('-'),\n            dirName = bits[0] === 'd3' ? bits[1] : null,\n            arg;\n\n        if (dirName) {\n            if (vm) {\n                arg = bits.slice(2).join('-');\n                if (!arg && attributes.indexOf(dirName) > -1) {\n                    arg = dirName;\n                    dirName = 'attr';\n                }\n                var directive = vm.directives.get(dirName);\n                if (directive) dirs.add(directive(element, attr, arg));\n                else vm.logWarn(`${element.tagName} cannot find directive \"${dirName}\". Did you forget to register it?`);\n            }\n        } else\n            dirs.attrs[attr.name] = attr.value;\n    }\n\n    return dirs;\n}\n\n\n// Directives container\nfunction Directives () {\n    this.attrs = {};\n    this.all = [];\n}\n\n\nDirectives.prototype = {\n\n    size () {\n        return this.all.length;\n    },\n\n    pop: function (dir) {\n        var index = this.all.indexOf(dir);\n        if (index > -1) {\n            dir.removeAttribute();\n            this.all.splice(index, 1);\n        }\n        return dir;\n    },\n\n    add (dir) {\n        this.all.push(dir);\n    },\n\n    forEach (callback) {\n        this.all.forEach(callback);\n    },\n\n    preMount () {\n        let dir;\n        for (let i=0; i<this.all.length; ++i) {\n            dir = this.all[i];\n            if (dir.preMount()) return this.pop(dir);\n        }\n    },\n\n    execute (model) {\n        if (!this.size()) return;\n        return Promise.all(this.all.map(d => d.execute(model)));\n    }\n};\n","export default function (obj, idx=0) {\n    return Array.prototype.slice.call(obj, idx);\n}\n","const isAbsolute = new RegExp('^([a-z]+://|//)'),\n    isRelative = new RegExp('^[.]{0,2}/'),\n    hasOwnProperty = Array.prototype.hasOwnProperty;\n\nexport const viewLibs = new Map;\nexport const isAbsoluteUrl = url => isAbsolute.test(url);\n\n\nexport const viewResolve = (name, options) => {\n    var dist = viewLibs.get(name),\n        main = name,\n        path = null,\n        base = typeof location !== 'undefined' ? location : '';\n\n    if (options) {\n        if (typeof options.base === 'string') base = options.base;\n        path = removeFrontSlash(options.path);\n    }\n\n    if (dist) {\n        path = path || dist.main;\n        main = removeBackSlash(dist.origin || main);\n        if (dist.version)\n            main = `${name}@${dist.version}`;\n        if (path)\n            main = `${main}/${path}`;\n    } else if (path) {\n        if (isAbsolute.test(main))\n            main = new URL(main, base).origin;\n        else if (isRelative.test(main))\n            main = '';\n        main = `${main}/${path}`;\n    }\n\n    if (isAbsolute.test(main)) {\n        return main;\n    } else if (isRelative.test(main)) {\n        return new URL(main, base).href;\n    } else {\n        if (!main.length || /^[\\s._]/.test(main) || /\\s$/.test(main)) throw new Error(\"illegal name\");\n        return \"https://unpkg.com/\" + main;\n    }\n};\n\n\nexport const viewRequireFrom = (resolver, root) => {\n    const modules = new Map,\n        queue = [],\n        map = queue.map,\n        some = queue.some,\n        getRoot = () => {\n            return (!root && typeof window !== 'undefined') ? window : root;\n        },\n        requireRelative = base => {\n            return name => {\n                var url = resolver(name + \"\", base), module = modules.get(url);\n                if (!module) modules.set(url, module = new Promise((resolve, reject) => {\n                    root = getRoot();\n                    const script = root.document.createElement(\"script\");\n                    script.onload = function() {\n                        try { resolve(queue.pop()(requireRelative(url))); }\n                        catch (error) { reject(new Error(\"invalid module\")); }\n                        script.remove();\n                    };\n                    script.onerror = function() {\n                        reject(new Error(\"unable to load module\"));\n                        script.remove();\n                    };\n                    script.async = true;\n                    script.src = url;\n                    root.define = define;\n                    root.document.head.appendChild(script);\n                }));\n                return module;\n            };\n        },\n        requireOne = requireRelative(null);\n\n    function require (name) {\n        return arguments.length > 1 ? Promise.all(map.call(arguments, requireOne)).then(merge) : requireOne(name);\n    }\n\n    require.root = getRoot;\n\n    define.amd = {};\n\n    return require;\n\n    function define (name, dependencies, factory) {\n        if (arguments.length < 3) factory = dependencies, dependencies = name;\n        if (arguments.length < 2) factory = dependencies, dependencies = [];\n        queue.push(some.call(dependencies, isexports) ? function(require) {\n            var exports = {};\n            return Promise.all(map.call(dependencies, function(name) {\n                return isexports(name += \"\") ? exports : require(name);\n            })).then(function(dependencies) {\n                factory.apply(null, dependencies);\n                return exports;\n            });\n        } : function(require) {\n            return Promise.all(map.call(dependencies, require)).then(function(dependencies) {\n                return typeof factory === \"function\" ? factory.apply(null, dependencies) : factory;\n            });\n        });\n    }\n};\n\nexport const viewRequire = viewRequireFrom(viewResolve);\n\n// INTERNALS\n\nconst isexports = name => (name + \"\") === \"exports\";\n\n\nconst removeFrontSlash = path => {\n    if (typeof path === 'string' && path.substring(0, 1) === '/') path = path.substring(1);\n    return path;\n};\n\n\nconst removeBackSlash = path => {\n    if (typeof path === 'string' && path.substring(path.length-1) === '/') path = path.substring(0, path.substring);\n    return path;\n};\n\n\nconst merge = modules => {\n    var o = {}, i = -1, n = modules.length, m, k;\n    while (++i < n) {\n        for (k in (m = modules[i])) {\n            if (hasOwnProperty.call(m, k)) {\n                if (m[k] == null) Object.defineProperty(o, k, {get: getter(m, k)});\n                else o[k] = m[k];\n            }\n        }\n    }\n    return o;\n};\n\n\nconst getter = (object, name) => {\n    return () => object[name];\n};\n","import {logger, inBrowser, isFunction, assign} from 'd3-let';\nimport {viewResolve, viewRequire} from '../require';\n\n\nlogger.debug = null;\n\n\nexport default assign({\n    //\n    require: viewRequire,\n    //\n    resolve: viewResolve,\n    //\n    // log messages\n    logger: logger,\n    //\n    // callbacks when page is loaded in browser\n    readyCallbacks: [],\n    // Set/unset debug\n    setDebug (active) {\n        if (!arguments.length || active)\n            this.logger.debug = isFunction(active) ? active : defaultDebug;\n        else\n            this.logger.debug = null;\n    }\n}, function () {\n    if (inBrowser) {\n        return assign({\n            fetch: window.fetch,\n            location: window.location\n        }, window.d3);\n    }\n}());\n\n\nfunction defaultDebug (msg) {\n    this.info(msg);\n}\n","import providers from './providers';\n\nconst prefix = '[d3-view]';\n\n\nexport default msg => {\n    providers.logger.warn(`${prefix} ${msg}`);\n};\n","import {select, selection} from 'd3-selection';\n\nimport getdirs from './getdirs';\nimport slice from '../utils/slice';\nimport warn from '../utils/warn';\n\n\n// Extend selection prototype with new methods\nselection.prototype.mount = mount;\nselection.prototype.view = view;\nselection.prototype.model = model;\nselection.prototype.directives = directives;\n\n\nfunction directives (vm) {\n    const node = this.node();\n    let dirs = node.__d3_directives__;\n    if (dirs === undefined) {\n        dirs = getdirs(node, vm);\n        // no point in storing the directive object if there are no directives or the node is not a component\n        node.__d3_directives__ = dirs.size() || getComponent(node, vm) ? dirs : null;\n    }\n    return dirs ? dirs : getdirs(node);\n}\n\n\nfunction model () {\n    var vm = this.view();\n    return vm ? vm.model : null;\n}\n\n\nfunction view (value) {\n    if (arguments.length) {\n        return this.property(\"__d3_view__\", value);\n    } else {\n        var element = this.node(),\n            view = element ? element.__d3_view__ : null,\n            parent = element ? element.parentNode : null;\n\n        while (parent && !view) {\n            view = parent.__d3_view__;\n            parent = parent.parentNode;\n        }\n        return view;\n    }\n}\n\n//\n// mount function on a d3 selection\n// Use this function to mount the selection\n// This method returns nothing or a promise\nfunction mount (data) {\n    var promises = [];\n    this.each(function () {\n        var view = select(this).view();\n        if (view) promises.push(mountElement(this, view, data));\n        else warn('Cannot mount, no view object available to mount to');\n    });\n    return Promise.all(promises);\n}\n\n// INTERNALS\n\n// mount an element into a given model\nconst mountElement = (element, vm, data) => {\n    if (!element || !element.tagName) return;\n\n    var component = getComponent(element, vm),\n        directives = select(element).directives(vm),\n        preMount = directives.preMount();\n\n    if (preMount)\n        return preMount.execute(vm.model);\n    else {\n        if (component) {\n            return component({parent: vm}).mount(element, data).then(cm => {\n                directives.execute(cm.model);\n                return cm;\n            });\n        }\n        else {\n            directives.execute(vm.model);\n            return Promise.all(slice(element.children).map(c => mountElement(c, vm, data)));\n        }\n    }\n};\n\n\nconst getComponent = (element, vm) => {\n    return vm.components.get(element.tagName.toLowerCase());\n};\n","import {isString} from 'd3-let';\nimport {select} from 'd3-selection';\n\nimport warn from './warn';\nimport providers from './providers';\n\n\nexport const template = (source, context) => {\n    if (isString(source)) {\n        if (context) {\n            var s = compile(source);\n            if (!s) return source;\n            source = s;\n        }\n        else\n            return source;\n    }\n    return source(context);\n};\n\n\nexport const htmlElement = (source, context, ownerDocument) => {\n    ownerDocument = ownerDocument || document;\n    var el = select(ownerDocument.createElement('div'));\n    el.html(template(source, context));\n    var children = el.node().children;\n    if (children.length !== 1) warn(`viewElement function should return one root element only, got ${children.length}`);\n    return children[0];\n};\n\n\nconst compile = text => {\n    var compile = providers.compileTemplate;\n    if (compile) return compile(text);\n    warn('No compileTemplate function available in viewProviders, cannot render template');\n};\n","\n\nexport function HttpResponse (response, data) {\n    this.response = response;\n    this.data = data;\n    this.status = response.status;\n    this.headers = response.headers;\n    this.description = response.statusText;\n}\n\n\nexport function HttpError (response, data, description) {\n    this.response = response;\n    this.data = data;\n    this.status = response.status;\n    this.headers = response.headers;\n    this.description = description || response.statusText;\n}\n\n\nexport function jsonResponse (response) {\n    var ct = (response.headers.get('content-type') || '').split(';')[0];\n    if (ct === 'application/json')\n        return response.json().then(data => new HttpResponse(response, data));\n    else {\n        var msg = response.status < 300 ? `Expected \"application/json\" content type, got \"${ct}\"` : null;\n        throw new HttpError(response, null, msg);\n    }\n}\n\n\nexport function textResponse (response) {\n    if (response.status < 300)\n        return response.text().then(data => new HttpResponse(response, data));\n    else {\n        throw new HttpError(response);\n    }\n}\n\nHttpError.prototype = Error.prototype;\n","import {isFunction} from 'd3-let';\nimport {select} from 'd3-selection';\n\n\nexport default el => (!el || !isFunction(el.size)) ? select(el) : el;\n","import {select, selectAll, event} from 'd3-selection';\n\nimport providers from '../utils/providers';\nimport {htmlElement, template} from '../utils/template';\nimport {jsonResponse, textResponse} from '../utils/http';\nimport asSelect from '../utils/select';\nimport {viewResolve, viewRequireFrom} from '../require';\n\n//\n//  Base d3-view Object\n//  =====================\n//\nexport default {\n    // available once mounted\n    // this is the browser window.document unless we are mounting on jsdom\n    ownerDocument: null,\n    //\n    // d3-view object\n    isd3: true,\n    //\n    providers: providers,\n    //\n    // Create a view element from a template and optional context\n    viewElement (source, context, ownerDocument) {\n        return htmlElement(source, context, ownerDocument || this.ownerDocument);\n    },\n    //\n    select (selector) {\n        if (typeof selector === \"string\")\n            return select(this.ownerDocument || document).select(selector);\n        return select(selector);\n    },\n    //\n    selectAll (selector) {\n        if (typeof selector === \"string\")\n            return select(this.ownerDocument || document).selectAll(selector);\n        return selectAll(selector);\n    },\n    //\n    // Shortcut for fetch function in providers\n    fetch (url, options) {\n        var fetch = providers.fetch;\n        return arguments.length == 1 ? fetch(url) : fetch(url, options);\n    },\n    //\n    fetchText (url, ...x) {\n        return this.fetch(url, ...x).then(textResponse);\n    },\n    //\n    json (url, ...x) {\n        return this.fetch(url, ...x).then(jsonResponse);\n    },\n    //\n    // render a template from a url\n    renderFromUrl (url, context, asElement=true) {\n        var cache = this.cache;\n        if (cache.has(url))\n            return Promise.resolve(render(cache.get(url), context, asElement));\n        return this.fetchText(url).then(response => {\n            cache.set(url, response.data);\n            return render(response.data, context, asElement);\n        });\n    },\n    //\n    // render from a distribution name. Use d3-require resolve method to find the url\n    renderFromDist (dist, path, context, asElement=true) {\n        var resolve = providers.resolve;\n        return this.renderFromUrl(resolve(dist, {path: path}), context, asElement);\n    },\n    //\n    on (el, name, callback) {\n        el = asSelect(el);\n        if (callback === null) return el.on(name, null);\n        else el.on(name, () => callback(event));\n    },\n    //\n    selectChildren (el) {\n        if (!arguments.length) el = this.el;\n        return this.selectAll(Array.prototype.slice.call(el.children));\n    },\n    //\n    domEvent () {\n        return event;\n    },\n    //\n    logError (err) {\n        if (err.stack) providers.logger.error(err);\n        else providers.logger.error(`[${this.name}] ${err}`);\n        return this;\n    },\n    //\n    logWarn (msg) {\n        providers.logger.warn(`[${this.name}] ${msg}`);\n        return this;\n    },\n    //\n    logInfo (msg) {\n        providers.logger.info(`[${this.name}] ${msg}`);\n        return this;\n    },\n    //\n    logDebug (msg) {\n        if (providers.logger.debug)\n            providers.logger.debug(`[${this.name}] ${msg}`);\n        return this;\n    },\n\n    require () {\n        const root = this.ownerDocument.defaultView;\n        if (!root.d3) root.d3 = {};\n        let require = root.d3.require;\n        if (!require) {\n            if (this.providers.require.root() === root) require = this.providers.require;\n            else require = viewRequireFrom(viewResolve, root);\n            root.d3.require = require;\n        }\n        return require.apply(undefined, arguments);\n    }\n};\n\n\nfunction render (text, context, asElement) {\n    return asElement ? htmlElement(text, context) : template(text, context);\n}\n","import {assign, isFunction} from 'd3-let';\n\nimport providers from '../utils/providers';\nimport base from './base';\n\n\nproviders.transition = {\n    duration: 0\n};\n\n\nexport default assign(base, {\n    //\n    // return a transition object if possible\n    transition (sel) {\n        if (!arguments.length) sel = this.sel;\n        var duration = this.transitionDuration(sel);\n        if (duration > 0) return sel.transition(this.uid).duration(duration);\n    },\n\n    transitionDuration (sel) {\n        if (!arguments.length) sel = this.sel;\n        if (sel && isFunction(sel.transition) && sel.size()) {\n            var duration = sel.attr('data-transition-duration');\n            return +(duration === null ? providers.transition.duration : duration);\n        }\n        return 0;\n    }\n});\n","// Code originally from https://github.com/soney/jsep\n// Copyright (c) 2013 Stephen Oney, http://jsep.from.so/\n// Code modified and adapted to work with d3-view\n\n// This is the full set of types that any JSEP node can be.\n// Store them here to save space when minified\nexport const code = {\n    COMPOUND: 'Compound',\n    IDENTIFIER: 'Identifier',\n    MEMBER_EXP: 'MemberExpression',\n    LITERAL: 'Literal',\n    THIS_EXP: 'ThisExpression',\n    CALL_EXP: 'CallExpression',\n    UNARY_EXP: 'UnaryExpression',\n    BINARY_EXP: 'BinaryExpression',\n    LOGICAL_EXP: 'LogicalExpression',\n    CONDITIONAL_EXP: 'ConditionalExpression',\n    ARRAY_EXP: 'ArrayExpression'\n};\n\nvar PERIOD_CODE = 46, // '.'\n    COMMA_CODE  = 44, // ','\n    SQUOTE_CODE = 39, // single quote\n    DQUOTE_CODE = 34, // double quotes\n    OPAREN_CODE = 40, // (\n    CPAREN_CODE = 41, // )\n    OBRACK_CODE = 91, // [\n    CBRACK_CODE = 93, // ]\n    QUMARK_CODE = 63, // ?\n    SEMCOL_CODE = 59, // ;\n    COLON_CODE  = 58, // :\n\n    throwError = function(message, index) {\n        var error = new Error(message + ' at character ' + index);\n        error.index = index;\n        error.description = message;\n        throw error;\n    },\n\n// Operations\n// ----------\n\n// Set `t` to `true` to save space (when minified, not gzipped)\n    t = true,\n// Use a quickly-accessible map to store all of the unary operators\n// Values are set to `true` (it really doesn't matter)\n    unary_ops = {'-': t, '!': t, '~': t, '+': t},\n// Also use a map for the binary operations but set their values to their\n// binary precedence for quick reference:\n// see [Order of operations](http://en.wikipedia.org/wiki/Order_of_operations#Programming_language)\n    binary_ops = {\n        '||': 1, '&&': 2, '|': 3,  '^': 4,  '&': 5,\n        '==': 6, '!=': 6, '===': 6, '!==': 6,\n        '<': 7,  '>': 7,  '<=': 7,  '>=': 7,\n        '<<':8,  '>>': 8, '>>>': 8,\n        '+': 9, '-': 9,\n        '*': 10, '/': 10, '%': 10\n    },\n// Get return the longest key length of any object\n    getMaxKeyLen = function(obj) {\n        var max_len = 0, len;\n        for(var key in obj) {\n            if((len = key.length) > max_len && obj.hasOwnProperty(key)) {\n                max_len = len;\n            }\n        }\n        return max_len;\n    },\n    max_unop_len = getMaxKeyLen(unary_ops),\n    max_binop_len = getMaxKeyLen(binary_ops),\n// Literals\n// ----------\n// Store the values to return for the various literals we may encounter\n    literals = {\n        'true': true,\n        'false': false,\n        'null': null\n    },\n// Except for `this`, which is special. This could be changed to something like `'self'` as well\n    this_str = 'this',\n// Returns the precedence of a binary operator or `0` if it isn't a binary operator\n    binaryPrecedence = function(op_val) {\n        return binary_ops[op_val] || 0;\n    },\n// Utility function (gets called from multiple places)\n// Also note that `a && b` and `a || b` are *logical* expressions, not binary expressions\n    createBinaryExpression = function (operator, left, right) {\n        var type = (operator === '||' || operator === '&&') ? code.LOGICAL_EXP : code.BINARY_EXP;\n        return {\n            type: type,\n            operator: operator,\n            left: left,\n            right: right\n        };\n    },\n    // `ch` is a character code in the next three functions\n    isDecimalDigit = function(ch) {\n        return (ch >= 48 && ch <= 57); // 0...9\n    },\n    isIdentifierStart = function(ch) {\n        return (ch === 36) || (ch === 95) || // `$` and `_`\n                (ch >= 65 && ch <= 90) || // A...Z\n                (ch >= 97 && ch <= 122) || // a...z\n                (ch >= 128 && !binary_ops[String.fromCharCode(ch)]); // any non-ASCII that is not an operator\n    },\n    isIdentifierPart = function(ch) {\n        return (ch === 36) || (ch === 95) || // `$` and `_`\n                (ch >= 65 && ch <= 90) || // A...Z\n                (ch >= 97 && ch <= 122) || // a...z\n                (ch >= 48 && ch <= 57) || // 0...9\n                (ch >= 128 && !binary_ops[String.fromCharCode(ch)]); // any non-ASCII that is not an operator\n    },\n\n    // Parsing\n    // -------\n    // `expr` is a string with the passed in expression\n    jsep = function(expr) {\n        // `index` stores the character number we are currently at while `length` is a constant\n        // All of the gobbles below will modify `index` as we move along\n        var index = 0,\n            charAtFunc = expr.charAt,\n            charCodeAtFunc = expr.charCodeAt,\n            exprI = function(i) { return charAtFunc.call(expr, i); },\n            exprICode = function(i) { return charCodeAtFunc.call(expr, i); },\n            length = expr.length,\n\n            // Push `index` up to the next non-space character\n            gobbleSpaces = function() {\n                var ch = exprICode(index);\n                // space or tab\n                while(ch === 32 || ch === 9) {\n                    ch = exprICode(++index);\n                }\n            },\n\n            // The main parsing function. Much of this code is dedicated to ternary expressions\n            gobbleExpression = function() {\n                var test = gobbleBinaryExpression(),\n                    consequent, alternate;\n                gobbleSpaces();\n                if(exprICode(index) === QUMARK_CODE) {\n                    // Ternary expression: test ? consequent : alternate\n                    index++;\n                    consequent = gobbleExpression();\n                    if(!consequent) {\n                        throwError('Expected expression', index);\n                    }\n                    gobbleSpaces();\n                    if(exprICode(index) === COLON_CODE) {\n                        index++;\n                        alternate = gobbleExpression();\n                        if(!alternate) {\n                            throwError('Expected expression', index);\n                        }\n                        return {\n                            type: code.CONDITIONAL_EXP,\n                            test: test,\n                            consequent: consequent,\n                            alternate: alternate\n                        };\n                    } else {\n                        throwError('Expected :', index);\n                    }\n                } else {\n                    return test;\n                }\n            },\n\n            // Search for the operation portion of the string (e.g. `+`, `===`)\n            // Start by taking the longest possible binary operations (3 characters: `===`, `!==`, `>>>`)\n            // and move down from 3 to 2 to 1 character until a matching binary operation is found\n            // then, return that binary operation\n            gobbleBinaryOp = function() {\n                gobbleSpaces();\n                var to_check = expr.substr(index, max_binop_len), tc_len = to_check.length;\n                while(tc_len > 0) {\n                    if(binary_ops.hasOwnProperty(to_check)) {\n                        index += tc_len;\n                        return to_check;\n                    }\n                    to_check = to_check.substr(0, --tc_len);\n                }\n                return false;\n            },\n\n            // This function is responsible for gobbling an individual expression,\n            // e.g. `1`, `1+2`, `a+(b*2)-Math.sqrt(2)`\n            gobbleBinaryExpression = function() {\n                var node, biop, prec, stack, biop_info, left, right, i;\n\n                // First, try to get the leftmost thing\n                // Then, check to see if there's a binary operator operating on that leftmost thing\n                left = gobbleToken();\n                biop = gobbleBinaryOp();\n\n                // If there wasn't a binary operator, just return the leftmost node\n                if(!biop) {\n                    return left;\n                }\n\n                // Otherwise, we need to start a stack to properly place the binary operations in their\n                // precedence structure\n                biop_info = { value: biop, prec: binaryPrecedence(biop)};\n\n                right = gobbleToken();\n                if(!right) {\n                    throwError(\"Expected expression after \" + biop, index);\n                }\n                stack = [left, biop_info, right];\n\n                // Properly deal with precedence using [recursive descent](http://www.engr.mun.ca/~theo/Misc/exp_parsing.htm)\n                while((biop = gobbleBinaryOp())) {\n                    prec = binaryPrecedence(biop);\n\n                    if(prec === 0) {\n                        break;\n                    }\n                    biop_info = { value: biop, prec: prec };\n\n                    // Reduce: make a binary expression from the three topmost entries.\n                    while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {\n                        right = stack.pop();\n                        biop = stack.pop().value;\n                        left = stack.pop();\n                        node = createBinaryExpression(biop, left, right);\n                        stack.push(node);\n                    }\n\n                    node = gobbleToken();\n                    if(!node) {\n                        throwError(\"Expected expression after \" + biop, index);\n                    }\n                    stack.push(biop_info, node);\n                }\n\n                i = stack.length - 1;\n                node = stack[i];\n                while(i > 1) {\n                    node = createBinaryExpression(stack[i - 1].value, stack[i - 2], node);\n                    i -= 2;\n                }\n                return node;\n            },\n\n            // An individual part of a binary expression:\n            // e.g. `foo.bar(baz)`, `1`, `\"abc\"`, `(a % 2)` (because it's in parenthesis)\n            gobbleToken = function() {\n                var ch, to_check, tc_len;\n\n                gobbleSpaces();\n                ch = exprICode(index);\n\n                if(isDecimalDigit(ch) || ch === PERIOD_CODE) {\n                    // Char code 46 is a dot `.` which can start off a numeric literal\n                    return gobbleNumericLiteral();\n                } else if(ch === SQUOTE_CODE || ch === DQUOTE_CODE) {\n                    // Single or double quotes\n                    return gobbleStringLiteral();\n                } else if(isIdentifierStart(ch) || ch === OPAREN_CODE) { // open parenthesis\n                    // `foo`, `bar.baz`\n                    return gobbleVariable();\n                } else if (ch === OBRACK_CODE) {\n                    return gobbleArray();\n                } else {\n                    to_check = expr.substr(index, max_unop_len);\n                    tc_len = to_check.length;\n                    while(tc_len > 0) {\n                        if(unary_ops.hasOwnProperty(to_check)) {\n                            index += tc_len;\n                            return {\n                                type: code.UNARY_EXP,\n                                operator: to_check,\n                                argument: gobbleToken(),\n                                prefix: true\n                            };\n                        }\n                        to_check = to_check.substr(0, --tc_len);\n                    }\n\n                    return false;\n                }\n            },\n            // Parse simple numeric literals: `12`, `3.4`, `.5`. Do this by using a string to\n            // keep track of everything in the numeric literal and then calling `parseFloat` on that string\n            gobbleNumericLiteral = function() {\n                var number = '', ch, chCode;\n                while(isDecimalDigit(exprICode(index))) {\n                    number += exprI(index++);\n                }\n\n                if(exprICode(index) === PERIOD_CODE) { // can start with a decimal marker\n                    number += exprI(index++);\n\n                    while(isDecimalDigit(exprICode(index))) {\n                        number += exprI(index++);\n                    }\n                }\n\n                ch = exprI(index);\n                if(ch === 'e' || ch === 'E') { // exponent marker\n                    number += exprI(index++);\n                    ch = exprI(index);\n                    if(ch === '+' || ch === '-') { // exponent sign\n                        number += exprI(index++);\n                    }\n                    while(isDecimalDigit(exprICode(index))) { //exponent itself\n                        number += exprI(index++);\n                    }\n                    if(!isDecimalDigit(exprICode(index-1)) ) {\n                        throwError('Expected exponent (' + number + exprI(index) + ')', index);\n                    }\n                }\n\n\n                chCode = exprICode(index);\n                // Check to make sure this isn't a variable name that start with a number (123abc)\n                if(isIdentifierStart(chCode)) {\n                    throwError('Variable names cannot start with a number (' +\n                                number + exprI(index) + ')', index);\n                } else if(chCode === PERIOD_CODE) {\n                    throwError('Unexpected period', index);\n                }\n\n                return {\n                    type: code.LITERAL,\n                    value: parseFloat(number),\n                    raw: number\n                };\n            },\n\n            // Parses a string literal, staring with single or double quotes with basic support for escape codes\n            // e.g. `\"hello world\"`, `'this is\\nJSEP'`\n            gobbleStringLiteral = function() {\n                var str = '', quote = exprI(index++), closed = false, ch;\n\n                while(index < length) {\n                    ch = exprI(index++);\n                    if(ch === quote) {\n                        closed = true;\n                        break;\n                    } else if(ch === '\\\\') {\n                        // Check for all of the common escape codes\n                        ch = exprI(index++);\n                        switch(ch) {\n                            case 'n': str += '\\n'; break;\n                            case 'r': str += '\\r'; break;\n                            case 't': str += '\\t'; break;\n                            case 'b': str += '\\b'; break;\n                            case 'f': str += '\\f'; break;\n                            case 'v': str += '\\x0B'; break;\n                            default : str += '\\\\' + ch;\n                        }\n                    } else {\n                        str += ch;\n                    }\n                }\n\n                if(!closed) {\n                    throwError('Unclosed quote after \"'+str+'\"', index);\n                }\n\n                return {\n                    type: code.LITERAL,\n                    value: str,\n                    raw: quote + str + quote\n                };\n            },\n\n            // Gobbles only identifiers\n            // e.g.: `foo`, `_value`, `$x1`\n            // Also, this function checks if that identifier is a literal:\n            // (e.g. `true`, `false`, `null`) or `this`\n            gobbleIdentifier = function() {\n                var ch = exprICode(index), start = index, identifier;\n\n                if(isIdentifierStart(ch)) {\n                    index++;\n                } else {\n                    throwError('Unexpected ' + exprI(index), index);\n                }\n\n                while(index < length) {\n                    ch = exprICode(index);\n                    if(isIdentifierPart(ch)) {\n                        index++;\n                    } else {\n                        break;\n                    }\n                }\n                identifier = expr.slice(start, index);\n\n                if(literals.hasOwnProperty(identifier)) {\n                    return {\n                        type: code.LITERAL,\n                        value: literals[identifier],\n                        raw: identifier\n                    };\n                } else if(identifier === this_str) {\n                    return { type: code.THIS_EXP };\n                } else {\n                    return {\n                        type: code.IDENTIFIER,\n                        name: identifier\n                    };\n                }\n            },\n\n            // Gobbles a list of arguments within the context of a function call\n            // or array literal. This function also assumes that the opening character\n            // `(` or `[` has already been gobbled, and gobbles expressions and commas\n            // until the terminator character `)` or `]` is encountered.\n            // e.g. `foo(bar, baz)`, `my_func()`, or `[bar, baz]`\n            gobbleArguments = function(termination) {\n                var ch_i, args = [], node, closed = false;\n                while(index < length) {\n                    gobbleSpaces();\n                    ch_i = exprICode(index);\n                    if(ch_i === termination) { // done parsing\n                        closed = true;\n                        index++;\n                        break;\n                    } else if (ch_i === COMMA_CODE) { // between expressions\n                        index++;\n                    } else {\n                        node = gobbleExpression();\n                        if(!node || node.type === code.COMPOUND) {\n                            throwError('Expected comma', index);\n                        }\n                        args.push(node);\n                    }\n                }\n                if (!closed) {\n                    throwError('Expected ' + String.fromCharCode(termination), index);\n                }\n                return args;\n            },\n\n            // Gobble a non-literal variable name. This variable name may include properties\n            // e.g. `foo`, `bar.baz`, `foo['bar'].baz`\n            // It also gobbles function calls:\n            // e.g. `Math.acos(obj.angle)`\n            gobbleVariable = function() {\n                var ch_i, node;\n                ch_i = exprICode(index);\n\n                if(ch_i === OPAREN_CODE) {\n                    node = gobbleGroup();\n                } else {\n                    node = gobbleIdentifier();\n                }\n                gobbleSpaces();\n                ch_i = exprICode(index);\n                while(ch_i === PERIOD_CODE || ch_i === OBRACK_CODE || ch_i === OPAREN_CODE) {\n                    index++;\n                    if(ch_i === PERIOD_CODE) {\n                        gobbleSpaces();\n                        node = {\n                            type: code.MEMBER_EXP,\n                            computed: false,\n                            object: node,\n                            property: gobbleIdentifier()\n                        };\n                    } else if(ch_i === OBRACK_CODE) {\n                        node = {\n                            type: code.MEMBER_EXP,\n                            computed: true,\n                            object: node,\n                            property: gobbleExpression()\n                        };\n                        gobbleSpaces();\n                        ch_i = exprICode(index);\n                        if(ch_i !== CBRACK_CODE) {\n                            throwError('Unclosed [', index);\n                        }\n                        index++;\n                    } else if(ch_i === OPAREN_CODE) {\n                        // A function call is being made; gobble all the arguments\n                        node = {\n                            type: code.CALL_EXP,\n                            'arguments': gobbleArguments(CPAREN_CODE),\n                            callee: node\n                        };\n                    }\n                    gobbleSpaces();\n                    ch_i = exprICode(index);\n                }\n                return node;\n            },\n\n            // Responsible for parsing a group of things within parentheses `()`\n            // This function assumes that it needs to gobble the opening parenthesis\n            // and then tries to gobble everything within that parenthesis, assuming\n            // that the next thing it should see is the close parenthesis. If not,\n            // then the expression probably doesn't have a `)`\n            gobbleGroup = function() {\n                index++;\n                var node = gobbleExpression();\n                gobbleSpaces();\n                if(exprICode(index) === CPAREN_CODE) {\n                    index++;\n                    return node;\n                } else {\n                    throwError('Unclosed (', index);\n                }\n            },\n\n            // Responsible for parsing Array literals `[1, 2, 3]`\n            // This function assumes that it needs to gobble the opening bracket\n            // and then tries to gobble the expressions as arguments.\n            gobbleArray = function() {\n                index++;\n                return {\n                    type: code.ARRAY_EXP,\n                    elements: gobbleArguments(CBRACK_CODE)\n                };\n            },\n\n            nodes = [], ch_i, node;\n\n        while(index < length) {\n            ch_i = exprICode(index);\n\n            // Expressions can be separated by semicolons, commas, or just inferred without any\n            // separators\n            if(ch_i === SEMCOL_CODE || ch_i === COMMA_CODE) {\n                index++; // ignore separators\n            } else {\n                // Try to gobble each expression individually\n                if((node = gobbleExpression())) {\n                    nodes.push(node);\n                // If we weren't able to find a binary expression and are out of room, then\n                // the expression passed in probably has too much\n                } else if(index < length) {\n                    throwError('Unexpected \"' + exprI(index) + '\"', index);\n                }\n            }\n        }\n\n        // If there's only one expression just try returning the expression\n        if(nodes.length === 1) {\n            return nodes[0];\n        } else {\n            return {\n                type: code.COMPOUND,\n                body: nodes\n            };\n        }\n    };\n\n\n/**\n * @method jsep.addUnaryOp\n * @param {string} op_name The name of the unary op to add\n * @return jsep\n */\njsep.addUnaryOp = function(op_name) {\n    max_unop_len = Math.max(op_name.length, max_unop_len);\n    unary_ops[op_name] = t; return this;\n};\n\n/**\n * @method jsep.addBinaryOp\n * @param {string} op_name The name of the binary op to add\n * @param {number} precedence The precedence of the binary op (can be a float)\n * @return jsep\n */\njsep.addBinaryOp = function(op_name, precedence) {\n    max_binop_len = Math.max(op_name.length, max_binop_len);\n    binary_ops[op_name] = precedence;\n    return this;\n};\n\n/**\n * @method jsep.addLiteral\n * @param {string} literal_name The name of the literal to add\n * @param {*} literal_value The value of the literal\n * @return jsep\n */\njsep.addLiteral = function(literal_name, literal_value) {\n    literals[literal_name] = literal_value;\n    return this;\n};\n\n/**\n * @method jsep.removeUnaryOp\n * @param {string} op_name The name of the unary op to remove\n * @return jsep\n */\njsep.removeUnaryOp = function(op_name) {\n    delete unary_ops[op_name];\n    if(op_name.length === max_unop_len) {\n        max_unop_len = getMaxKeyLen(unary_ops);\n    }\n    return this;\n};\n\n/**\n * @method jsep.removeBinaryOp\n * @param {string} op_name The name of the binary op to remove\n * @return jsep\n */\njsep.removeBinaryOp = function(op_name) {\n    delete binary_ops[op_name];\n    if(op_name.length === max_binop_len) {\n        max_binop_len = getMaxKeyLen(binary_ops);\n    }\n    return this;\n};\n\n/**\n * @method jsep.removeLiteral\n * @param {string} literal_name The name of the literal to remove\n * @return jsep\n */\njsep.removeLiteral = function(literal_name) {\n    delete literals[literal_name];\n    return this;\n};\n\n\nexport default jsep;\n","import {code} from './jsep';\n\n\nexport function evaluate (self, expr, nested) {\n    switch(expr.type) {\n        case code.IDENTIFIER: return self[expr.name];\n        case code.LITERAL: return nested ? self[expr.value] : expr.value;\n        case code.ARRAY_EXP: return expr.elements.map((elem) => {return evaluate(self, elem);});\n        case code.LOGICAL_EXP:\n        case code.BINARY_EXP: return binaryExp(expr.operator, evaluate(self, expr.left), evaluate(self, expr.right));\n        case code.CALL_EXP: return callExpression(self, expr.callee, expr.arguments);\n        case code.MEMBER_EXP: return evaluate(evaluate(self, expr.object), expr.property, true);\n        case code.CONDITIONAL_EXP: return evaluate(self, expr.test) ? evaluate(self, expr.consequent) : evaluate(self, expr.alternate);\n        case code.UNARY_EXP: return unaryExp(expr.operator, evaluate(self, expr.argument));\n    }\n}\n\n// extract identifiers\nexport function identifiers (expr, all) {\n    if (arguments.length === 1) all = new Set;\n    switch(expr.type) {\n        case code.IDENTIFIER:\n            all.add(expr.name); break;\n        case code.ARRAY_EXP:\n            expr.elements.forEach(elem => identifiers(elem, all));\n            break;\n        case code.LOGICAL_EXP:\n        case code.BINARY_EXP:\n            identifiers(expr.left, all);\n            identifiers(expr.right, all);\n            break;\n        case code.CALL_EXP:\n            identifiers(expr.callee, all);\n            expr.arguments.forEach(elem => identifiers(elem, all));\n            break;\n        case code.MEMBER_EXP:\n            all.add(fullName(expr));\n            break;\n        case code.CONDITIONAL_EXP:\n            identifiers(expr.test, all);\n            identifiers(expr.consequent, all);\n            evaluate(expr.alternate, all);\n            break;\n        case code.UNARY_EXP:\n            identifiers(expr.argument, all);\n            break;\n    }\n    return all;\n}\n\n\nfunction callExpression (self, callee, args) {\n    var func;\n\n    args = args.map((arg) => {\n        return evaluate(self, arg);\n    });\n\n    if (callee.type !== code.IDENTIFIER) {\n        self = evaluate(self, callee.object);\n        callee = callee.property;\n    }\n\n    func = self[callee.name];\n    if (!func)\n        throw new EvalError(`callable \"${callee.name}\" not found in context`);\n    return func.apply(self, args);\n}\n\n\nfunction unaryExp (op, arg) {\n    if (!unaryFunctions[op])\n        unaryFunctions[op] = new Function(\"arg\", `return ${op} arg`);\n    return unaryFunctions[op](arg);\n}\n\n\nfunction binaryExp(op, a, b) {\n    if (!binaryFunctions[op])\n        binaryFunctions[op] = new Function(\"a\", \"b\", `return a ${op} b`);\n    return binaryFunctions[op](a, b);\n}\n\n\nfunction fullName (expr) {\n    if (expr.type === code.IDENTIFIER) return expr.name;\n    else return `${fullName(expr.object)}.${expr.property.name}`;\n}\n\nconst unaryFunctions = {};\nconst binaryFunctions = {};\n","// tiny javascript expression parser\nimport jsep, {code} from './jsep';\nimport {evaluate, identifiers} from './eval';\nimport warn from '../utils/warn';\n\n\nconst proto = {\n\n    eval (model) {\n        return evaluate(model, this.parsed);\n    },\n\n    safeEval (model) {\n        try {\n            return evaluate(model, this.parsed);\n        } catch (msg) {\n            warn(`Could not evaluate <<${this.expr}>> expression: ${msg}`);\n        }\n    },\n\n    // evaluate identifiers from a model\n    identifiers () {\n        return identifiers(this.parsed);\n    }\n};\n\n\nfunction Expression (expr) {\n    this.codes = code;\n    this.expr = expr;\n    this.parsed = jsep(expr);\n}\n\nExpression.prototype = proto;\n\n\nexport default function (expr) {\n    return new Expression(expr);\n}\n","let UID = 0;\nconst prefix = 'd3v';\n\n// Add a unique identifier to an object\nexport default function (o) {\n    var uid = prefix + (++UID);\n\n    if (arguments.length) {\n        Object.defineProperty(o, 'uid', {\n            get: function () {\n                return uid;\n            }\n        });\n\n        return o;\n    } else\n        return uid;\n}\n","import {dispatch} from 'd3-dispatch';\n\nimport debounce from '../utils/debounce';\n\n\nexport default () => {\n    let triggered = 0;\n\n    const events = dispatch('change');\n\n    function change () {\n        events.apply('change', this, arguments);\n        triggered +=1;\n    }\n\n    return {\n        change,\n        on (typename, callback) {\n            if (arguments.length < 2)\n                return events.on(typename);\n            events.on(typename, callback);\n            return this;\n        },\n        trigger: debounce(change),\n        triggered () {\n            return triggered;\n        }\n    };\n};\n","import uid from '../utils/uid';\nimport ddispatch from './dispatch';\n\n//\n// Initialise a model\nexport default function asModel (model, initials, parent, isolated) {\n    var events = new Map,\n        Child = null;\n\n    // event handler for any change in the model\n    events.set('', ddispatch());\n\n    Object.defineProperties(uid(model), {\n        $events: {\n            get () {\n                return events;\n            }\n        },\n        parent: {\n            get () {\n                return parent;\n            }\n        },\n        isolated: {\n            get () {\n                return isolated;\n            }\n        }\n    });\n    model.$child = $child;\n    model.$update(initials);\n\n    function $child (o) {\n        if (Child === null) Child = createChildConstructor(model);\n        return new Child(o);\n    }\n}\n\nfunction createChildConstructor (model) {\n\n    function Child (initials) {\n        asModel(this, initials, model, false);\n    }\n\n    Child.prototype = model;\n    return Child;\n}\n","const modelStr = \"[object d3Model]\";\n\n\nexport default function () {\n    return modelStr;\n}\n","// Check if a value is a vanilla javascript object\nexport default value => value && value.constructor === Object;\n","import {isFunction, isArray, isObject} from 'd3-let';\n\nimport providers from '../utils/providers';\nimport isVanillaObject from '../utils/object';\nimport ddispatch from './dispatch';\n\n\n//  $set a reactive attribute for a Model\n//\n//  Set the value of an attribute in the model\n//  If the attribute is not already reactive make it as such.\n//\nexport default function (key, value) {\n    // property not reactive - make it as such\n    if (key.substring(0, 1) === '$') {\n        if (this.constructor.prototype[key]) this.$logWarn(`Cannot set attribute method ${key}, it is protected`);\n        else this[key] = value;\n    } else if (!this.$events.get(key))\n        reactive(this, key, value);\n    else this[key] = value;\n}\n\n\nconst isModel = value => isObject(value) && value.toString() === '[object d3Model]';\n\n\nconst reactive = (model, key, value) => {\n    var lazy;\n\n    model.$events.set(key, ddispatch());\n\n    Object.defineProperty(model, key, property());\n\n    // Create a new model if value is an object\n    value = typeValue(value);\n    // Trigger the callback once for initialization\n    model.$change(key);\n\n    function update (newValue) {\n        if (lazy) newValue = lazy.get.call(model);\n        if (newValue === value) return;\n        // trigger lazy callbacks\n        //\n        // Fire model events\n        if (providers.logger.debug) {\n            var modelName = model.$$name || 'model';\n            providers.logger.debug(`[d3-model] updating ${modelName}.${key}`);\n        }\n        model.$change(key, value).$change();\n        value = typeValue (newValue, value);\n    }\n\n    function property () {\n        var prop = {\n                get: function () {\n                    return value;\n                }\n            };\n\n        if (isFunction(value)) value = {get: value};\n\n        // calculated attribute\n        if (isVanillaObject(value) && isFunction(value.get)) {\n            lazy = value;\n            value = lazy.get.call(model);\n\n            if (lazy.reactOn)\n                lazy.reactOn.forEach((name) => {\n                    model.$on(`${name}.${key}`, update);\n                });\n            else\n                model.$logWarn(`reactive lazy property ${key} does not specify 'reactOn' list or properties`);\n\n            if (isFunction(lazy.set)) prop.set = lazy.set;\n        } else\n            prop.set = update;\n\n        return prop;\n    }\n\n    function typeValue (newValue, oldValue) {\n        if (newValue === oldValue)\n            return oldValue;\n        else if (isArray(newValue))\n            return arrayValue(newValue, oldValue);\n        else if (isModel(oldValue))\n            return modelValue(newValue, oldValue);\n        else\n            return isVanillaObject(newValue) ? model.$new(newValue) : newValue;\n    }\n\n    function arrayValue (newValue, oldValue) {\n        if (isModel(oldValue)) oldValue.$off();\n        if (!isArray(oldValue)) oldValue = [];\n        for (let i=0; i<newValue.length; ++i)\n            newValue[i] = typeValue(newValue[i], oldValue[i]);\n        return newValue;\n    }\n\n    function modelValue (newValue, oldValue) {\n        if (isVanillaObject(newValue)) {\n            oldValue.$update(newValue);\n            return oldValue;\n        } else {\n            oldValue.$off();\n            return typeValue(newValue);\n        }\n    }\n};\n","import ddispatch from './dispatch';\n//\n//  Connect a model attribute with another model attribute\n//  The attribute is read-only on the model an it reacts on parent changes\nexport default function (attr, parentAttr, owner) {\n    if (this.$events.has(attr)) return this.$logWarn(`cannot connect ${attr} attribute, it is already reactive`);\n\n    parentAttr = parentAttr || attr;\n    owner = (owner || this).$owner(parentAttr);\n    if (!owner) return this.$logWarn(`cannot find model with attribute ${parentAttr}`);\n    //\n    const dd = ddispatch();\n    this.$events.set(attr, dd);\n    Object.defineProperty(this, attr, {\n        get () {\n            return owner[parentAttr];\n        },\n        set () {\n            this.$logWarn(`Cannot set \"${attr}\" value because it is owned by a parent model`);\n        }\n    });\n    owner.$events.get(parentAttr).on(`change.${this.uid}`, () => {\n        dd.change.apply(this, arguments);\n        if (owner != this) this.$events.get('').change.apply(this);\n    });\n}\n","import {isFunction} from 'd3-let';\n\nimport warn from '../utils/warn';\n\n\n// Add change callback to a model reactive attribute\nexport default function (name, callback) {\n\n    // When no name is provided, wait for changes on this model - no its parents\n    if (arguments.length === 1 && isFunction(name)) {\n        callback = name;\n        name = '';\n    }\n\n    var bits = name.split('.'),\n        key = bits[0],\n        event = getEvent(this, key);\n\n    if (!event) return warn(`Cannot bind to \"${key}\" - no such reactive property`);\n\n    // event from a parent model, add model uid to distinguish it from other child callbacks\n    if (!this.$events.get(key)) bits.push(this.uid);\n\n    bits[0] = 'change';\n    return event.on(bits.join('.'), callback);\n}\n\n\nfunction getEvent(model, name) {\n    var event = model.$events.get(name);\n    if (!event && model.parent) return getEvent(model.parent, name);\n    return event;\n}\n","// Update a model with reactive model data\nexport default function (data, replace) {\n    if (data) {\n        replace = arguments.length === 2 ? replace : true;\n        for (var key in data) {\n            if (replace || this[key] === undefined) this.$set(key, data[key]);\n        }\n    }\n    return this;\n}\n","// remove event handlers\nexport default function (attr) {\n    if (attr === undefined)\n        this.$events.forEach(event => removeEvent(event));\n    else {\n        var bits = attr.split('.'),\n            type = bits.splice(0, 1)[0],\n            event = this.$events.get(type);\n        if (event) removeEvent(event, bits.join('.'));\n    }\n}\n\n\nfunction removeEvent (event, name) {\n    if (name) event.on(`change.${name}`, null);\n    else event.on('change', null);\n}\n","import warn from '../utils/warn';\nimport slice from '../utils/slice';\n\n\n// trigger change event on a model reactive attribute\nexport default function (attribute) {\n    var name = arguments.length ? attribute : '',\n        event = this.$events.get(name),\n        args = slice(arguments, 1);\n    if (event) event.trigger.apply(this, args);\n    else if (!this.isolated) this.parent.$change(name);\n    else warn(`attribute '${name}' is not a reactive property this model`);\n    return this;\n}\n","//\n//check if an attribute is a reactive attribute for the model (or its prototypical parent)\nexport default function (attr) {\n    if (!this.$events.has(attr)) {\n        if (!this.parent || this.isolated) return false;\n        return this.parent.$isReactive(attr);\n    }\n    return true;\n}\n","//\n//  Return the model owning the reactive attribute attr\nexport default function (attr) {\n    if (!this.$events.has(attr)) return this.parent ? this.parent.$owner(attr) : undefined;\n    return this;\n}\n","const serialTypes = new Set([Boolean, String, Number]);\n\n\nexport default function () {\n    var model = this,\n        data = {},\n        keys = Array.from(this.$events.keys()).concat(Object.keys(this)),\n        value;\n\n    keys.forEach(key => {\n        if (key && key.substring(0, 1) !== '$') {\n            value = getValue(model[key]);\n            if (value !== undefined) data[key] = value;\n        }\n    });\n    return data;\n}\n\n\nfunction getValue (value) {\n    if (!value) return value;\n    else if (value.constructor === Array) return value.map(getValue);\n    else if (typeof value.$data === 'function') return value.$data();\n    else if (serialTypes.has(value.constructor)) return value;\n}\n","import {isFunction} from 'd3-let';\n\n//\n//  Emit a custom event Name up the chain of parent models\nexport default function (eventName, data) {\n    var name = '$' + eventName;\n    propagate(this, name, data, this);\n    return this;\n}\n\n\nfunction propagate (model, name, data, originModel) {\n    if (!model) return;\n    if (model.hasOwnProperty(name) && isFunction(model[name])) {\n        if (model[name](data, originModel) === false) return;\n    }\n    propagate(model.parent, name, data, originModel);\n}\n","export function $push (attr, value) {\n    var array = this[attr].slice();\n    array.push(value);\n    this[attr] = array;\n    return this;\n}\n\nexport function $splice (attr, idx, count) {\n    var array = this[attr].slice();\n    if (arguments.length == 2) array.splice(idx);\n    else if (arguments.length == 3) array.splice(idx, count);\n    this[attr] = array;\n    return this;\n}\n","import warn from '../utils/warn';\n\nimport asModel from './as';\nimport toString from './string';\nimport $set from './set';\nimport $connect from './connect';\nimport $on from './on';\nimport $update from './update';\nimport $off from './off';\nimport $change from './change';\nimport $isReactive from './isreactive';\nimport $owner from './owner';\nimport $data from './data';\nimport $emit from './emit';\nimport {$push, $splice} from './array';\n\n//\n//  Model class\n//\n//  The model is at the core of d3-view reactive data component\nfunction Model (initials, parent) {\n    asModel(this, initials, parent, true);\n}\n\nexport default function model (initials) {\n    return new Model(initials);\n}\n\nmodel.prototype = Model.prototype = {\n    constructor: Model,\n    // Public API methods\n    toString,\n    $on,\n    $change,\n    $connect,\n    $emit,\n    $update,\n    $set,\n    $new,\n    $off,\n    $isReactive,\n    $owner,\n    $data,\n    $push,\n    $splice,\n    $logWarn (msg) {\n        if (this.$$view) this.$$view.logWarn(msg);\n        else warn(msg);\n    }\n};\n\nObject.defineProperties(Model.prototype, {\n    root: {\n        get () {\n            return this.parent ? this.parent.root : this;\n        }\n    },\n    isolatedRoot: {\n        get () {\n            return !this.isolated && this.parent ? this.parent.isolatedRoot : this;\n        }\n    }\n});\n\n\nfunction $new (initials) {\n    return new Model(initials, this);\n}\n","import {isFunction, isObject, assign} from 'd3-let';\n\nimport viewExpression from '../parser/expression';\nimport viewModel from '../model/main';\nimport uid from '../utils/uid';\nimport sel from '../utils/sel';\nimport base from './transition';\n\n//\n// Directive Prototype\n//\n// Directives are special attributes with the d3- prefix.\n// Directive attribute values are expected to be binding expressions.\n// A directive’s job is to reactively apply special behavior to the DOM\n// when the value of its expression changes.\n//\n// A directive can implement one or more of the directive methods:\n//\n//  * create\n//  * mount\n//  * refresh\n//  * destroy\n//\nconst prototype = {\n\n    // hooks\n    create (expression) {\n        return expression;\n    },\n\n    // pre mount\n    preMount () {\n\n    },\n\n    mount (model) {\n        return model;\n    },\n\n    refresh () {\n\n    },\n\n    destroy () {\n\n    },\n\n    removeAttribute () {\n        this.el.removeAttribute(this.name);\n    },\n\n    // Execute directive\n    execute (model) {\n        if (!this.active) return;\n        this.removeAttribute();\n        this.identifiers = [];\n        model = this.mount(model);\n        // If model returned, bind the element to its properties\n        if (model) this.bindModel(model);\n    },\n\n    bindModel (model) {\n        var dir = this,\n            error = false,\n            events = model.$$view.events,\n            refresh = function () {\n                let value = dir.expression ? dir.expression.eval(model) : dir.data;\n                dir.refresh(model, value);\n                dir.passes++;\n                events.call('directive-refresh', undefined, dir, model, value);\n            };\n        //\n        // get the cache instance\n        dir.cache = model.$$view.cache;\n\n        // Bind expression identifiers with model\n        let bits, target, attr, i;\n        if (dir.data) {\n            dir.data = model.$new(dir.data);\n            dir.identifiers.push({\n                model: dir.data,\n                attr: ''\n            });\n        } else if (!this.expression) {\n            dir.identifiers.push({\n                model: model,\n                attr: ''\n            });\n        } else {\n            var modelEvents = new Map;\n            this.expression.identifiers().forEach(identifier => {\n                bits = identifier.split('.');\n                target = model;\n                attr = null;\n\n                for (i=0; i<bits.length-1; ++i) {\n                    target = target[bits[i]];\n                    if (!isObject(target)) {\n                        attr = bits.slice(0, i+1).join('.');\n                        dir.logError(`\"${attr}\" is not an object, cannot bind to \"${identifier}\" identifier`);\n                        error = true;\n                        break;\n                    }\n                }\n\n                // process attribute\n                if (attr === null) {\n                    if (!(target instanceof viewModel)) {\n                        dir.logError(`${identifier} is not a reactive model. Cannot bind to it`);\n                        error = true;\n                    } else\n                        addTarget(modelEvents, target, bits[bits.length-1]);\n                }\n            });\n\n            // register with model reactive properties\n            modelEvents.forEach(target => {\n                // if we are listening to all event simply bind to the model changes\n                if (target.events.has(''))\n                    dir.identifiers.push({\n                        model: target.model,\n                        attr: ''\n                    });\n                else\n                    target.events.forEach(attr => {\n                        dir.identifiers.push({\n                            model: target.model,\n                            attr: attr\n                        });\n                    });\n            });\n        }\n\n        if (error) return;\n\n        this.identifiers.forEach(identifier => {\n            var event = `${identifier.attr}.${dir.uid}`;\n            identifier.model.$on(event, refresh);\n        });\n\n        this.bindDestroy(model);\n\n        refresh();\n    },\n\n    bindDestroy (model) {\n        var dir = this,\n            destroy = this.destroy;\n        // bind destroy to the model\n        dir.destroy = function () {\n            dir.identifiers.forEach(identifier => {\n                identifier.model.$off(`${identifier.attr}.${dir.uid}`);\n            });\n            if (dir.data) dir.data.$off();\n            try {\n                destroy.call(dir, model);\n            } finally {\n                model.$emit('destroyDirective', dir);\n            }\n        };\n    }\n};\n\n// Directive constructor\nexport default function (obj) {\n\n    function Directive (el, attr, arg) {\n        this.el = el;\n        this.ownerDocument = el.ownerDocument;\n        this.name = attr.name;\n        this.arg = arg;\n        this.passes = 0;\n        var expr = sel(uid(this)).create(attr.value);\n        if (expr) {\n            try {\n                this.expression = viewExpression(expr);\n            } catch (e) {\n                try {\n                    this.data = JSON.parse(expr);\n                } catch (m) {\n                    this.logError(e);\n                }\n            }\n        }\n        if (!this.active)\n            this.active = Boolean(!attr.value || this.expression || this.data);\n    }\n\n    Directive.prototype = assign({}, base, prototype, obj);\n\n    function directive (el, attr, arg) {\n        return new Directive(el, attr, arg);\n    }\n\n    directive.prototype = Directive.prototype;\n    return directive;\n}\n\n\nfunction addTarget (modelEvents, model, attr) {\n    var value = arguments.length === 3 ? model[attr] : undefined;\n    //\n    // a method of the model, event is at model level\n    if (isFunction(value) || arguments.length === 2)\n        getTarget(modelEvents, model).events.add('');\n    // value is another model, events at both target model level and value model level\n    else if (value instanceof viewModel) {\n        addTarget(modelEvents, value);\n        model = model.$owner(attr);\n        if (model) getTarget(modelEvents, model).events.add('');\n    } else {\n        // make sure attr is a reactive property of model\n        model = model.$owner(attr) || model;\n        if (!model.$isReactive(attr)) model.$set(attr, value);\n        getTarget(modelEvents, model).events.add(attr);\n    }\n}\n\nfunction getTarget(modelEvents, model) {\n    var target = modelEvents.get(model.uid);\n    if (!target) {\n        target = {\n            model: model,\n            events: new Set\n        };\n        modelEvents.set(model.uid, target);\n    }\n    return target;\n}\n","import {isString} from 'd3-let';\n\nexport default value => {\n    if (isString(value)) {\n        try {\n            return JSON.parse(value);\n        } catch (msg) {\n            return value;\n        }\n    }\n    return value;\n};\n","export default obj => {\n    if (obj && obj.constructor === Object) obj = Object.entries(obj);\n    return new Map(obj);\n};\n","const DATAPREFIX = 'data';\n\n\nexport default attrs => {\n    let p, bits;\n    return Object.keys(attrs).reduce((o, key) => {\n        bits = key.split('-');\n        if (bits.length > 1 && bits[0] === DATAPREFIX) bits = bits.splice(1);\n        p = bits.reduce((s, key, idx) => {\n            s += idx ? key.substring(0, 1).toUpperCase() + key.substring(1) : key;\n            return s;\n        }, '');\n        o[p] = attrs[key];\n        return o;\n    }, {});\n};\n","export default function Cache () {\n    this.active = true;\n    this.data = new Map;\n}\n\n\nCache.prototype = {\n    constructor: Cache,\n    set (key, value) {\n        if (this.active) this.data.set(key, value);\n    },\n    get (key) {\n        if (this.active) return this.data.get(key);\n    },\n    has (key) {\n        if (this.active) return this.data.has(key);\n        return false;\n    },\n    clear () {\n        return this.data.clear();\n    },\n    delete (key) {\n        return this.data.delete(key);\n    }\n};\n","export default (str, options) => {\n    if (typeof str !== 'string') {\n        throw new TypeError('expected a string');\n    }\n\n    return str.trim()\n        .replace(/([a-z])([A-Z])/g, '$1-$2')\n        .replace(/\\W/g, m => /[À-ž]/.test(m) ? m : '-')\n        .replace(/^-+|-+$/g, '')\n        .replace(/-{2,}/g, m => options && options.condense ? '-' : m)\n        .toLowerCase();\n};\n","import {isFunction, isArray, isObject, isString, pop, assign} from 'd3-let';\nimport {dispatch} from 'd3-dispatch';\n\nimport './selection';\nimport base from './transition';\nimport createDirective from './directive';\nimport asSelect from '../utils/select';\nimport maybeJson from '../utils/maybeJson';\nimport sel from '../utils/sel';\nimport map from '../utils/map';\nimport dataAttributes from '../utils/data';\nimport viewModel from '../model/main';\nimport Cache from './cache';\nimport dashify from '../utils/dashify';\n\n\nexport const protoView = {\n    doMount (el) {\n        return asView(this, el);\n    }\n};\n\n\n// prototype for both views and components\nconst protoComponent = {\n    //\n    // hooks\n    render () {},\n    childrenMounted () {},\n    mounted () {},\n    destroy () {},\n    //\n    // Mount the component into an element\n    // If this component is already mounted, or it is mounting, it does nothing\n    mount (el, data) {\n        if (mounted(this)) return;\n        const sel = asSelect(el);\n        el = sel.node();\n        if (!el) {\n            this.logWarn(`element not defined, pass an identifier or an HTMLElement object`);\n            return Promise.resolve(this);\n        }\n        // set the owner document\n        this.ownerDocument = el.ownerDocument;\n        //\n        const directives = sel.directives(this);\n\n        let props = assign(dataAttributes(directives.attrs), sel.datum(), data),\n            extra = maybeJson(pop(props, 'props')),\n            value, model, parentModel;\n\n        if (isObject(extra)) props = assign(extra, props);\n        else if(this.parent && this.parent.props[extra]) props = assign({}, this.parent.props[extra], props);\n\n        // fire mount event\n        this.events.call('mount', undefined, this, el, props);\n\n        // pick parent model & props\n        if (this.parent) {\n            //\n            parentModel = this.parent.model;\n            model = pop(props, 'model');\n            if (model && !model.$child) model = parentModel[model];\n            if (!model) model = parentModel.$new();\n            else model = model.$child();\n            //\n            // Get props from parent view\n            Object.keys(this.props).forEach(key => {\n                value = this.parent.props[props[key]];\n                if (value === undefined) {\n                    value = maybeJson(props[key]);\n                    if (value !== undefined)\n                        props[key] = value;\n                        // default value if available\n                    else if (this.props[key] !== undefined)\n                        props[key] = this.props[key];\n                } else\n                    props[key] = value;\n            });\n            //\n            // get props object from parent if props is defined\n            if (isString(extra)) props = assign({}, this.parent.props[extra], props);\n        } else {\n            props = assign(this.props, props);\n            model = viewModel();\n        }\n\n        // add reactive model properties\n        Object.keys(this.model).forEach(key => {\n            value = pop(props, key);\n            if (value !== undefined) {\n                if (isString(value) && parentModel && parentModel.$isReactive(value))\n                    model.$connect(key, value, parentModel);\n                else\n                    model.$set(key, maybeJson(value));\n            } else if (model[key] === undefined)\n                model.$set(key, this.model[key]);\n        });\n        this.model = bindView(this, model);\n        //\n        // create the new element from the render function\n        if (!props.id) props.id = model.uid;\n        this.props = props;\n        //\n        return this.doMount(el);\n    },\n\n    createElement (tag, props) {\n        const doc = this.ownerDocument || document;\n        const sel = this.select(doc.createElement(tag));\n        if (props) {\n            sel.attr('id', this.props.id);\n            if (this.props.class) sel.classed(this.props.class, true);\n        }\n        return sel;\n    },\n\n    doMount (el) {\n        let newEl;\n        try {\n            newEl = this.render(el);\n        } catch (error) {\n            newEl = Promise.reject(error);\n        }\n        if (!newEl || !newEl.then) newEl = Promise.resolve(newEl);\n        return newEl\n            .then(element => compile(this, el, element))\n            .catch (exc => error(this, el, exc));\n    },\n\n    use (plugin) {\n        if (isObject(plugin)) plugin.install(this);\n        else plugin(this);\n        return this;\n    },\n\n    addComponent (name, obj) {\n        name = dashify(name);\n        var component = createComponent(name, obj);\n        this.components.set(name, component);\n        return component;\n    },\n\n    addDirective (name, obj) {\n        name = dashify(name);\n        var directive = createDirective(obj);\n        this.directives.set(name, directive);\n        return directive;\n    }\n};\n\n// factory of View and Component constructors\nexport const createComponent = (name, o, coreDirectives, coreComponents) => {\n    if (isFunction(o)) o = {render: o};\n\n    var obj = assign({}, o),\n        classComponents = extendComponents(new Map, pop(obj, 'components')),\n        classDirectives = extendDirectives(new Map, pop(obj, 'directives')),\n        model = pop(obj, 'model'),\n        props = pop(obj, 'props');\n\n    function Component (options) {\n        var parent = pop(options, 'parent'),\n            components = map(parent ? parent.components : coreComponents),\n            directives = map(parent ? parent.directives : coreDirectives),\n            events = parent ? parent.events : dispatch('message', 'created', 'mount', 'mounted', 'error', 'directive-refresh'),\n            cache = parent ? parent.cache : new Cache;\n\n        classComponents.forEach((comp, key) => {\n            components.set(key, comp);\n        });\n        classDirectives.forEach((comp, key) => {\n            directives.set(key, comp);\n        });\n        extendComponents(components, pop(options, 'components'));\n        extendDirectives(directives, pop(options, 'directives'));\n\n        Object.defineProperties(this, {\n            name : {\n                get () {\n                    return name;\n                }\n            },\n            components: {\n                get () {\n                    return components;\n                }\n            },\n            directives: {\n                get () {\n                    return directives;\n                }\n            },\n            parent: {\n                get () {\n                    return parent;\n                }\n            },\n            root: {\n                get () {\n                    return parent ? parent.root : this;\n                }\n            },\n            cache: {\n                get () {\n                    return cache;\n                }\n            },\n            uid: {\n                get () {\n                    return this.model.uid;\n                }\n            },\n            events: {\n                get () {\n                    return events;\n                }\n            }\n        });\n        this.props = asObject(props, pop(options, 'props'));\n        this.model = asObject(model, pop(options, 'model'));\n        this.events.call('created', undefined, this);\n    }\n\n    Component.prototype = assign({}, base, protoComponent, obj);\n\n    function component (options) {\n        return new Component(options);\n    }\n\n    component.prototype = Component.prototype;\n\n    return component;\n};\n\n\n// Used by both Component and view\n\nexport const extendComponents = (container, components) => {\n    map(components).forEach((obj, key) => {\n        key = dashify(key);\n        container.set(key, createComponent(key, obj, protoComponent));\n    });\n    return container;\n};\n\nexport const extendDirectives = (container, directives) => {\n    map(directives).forEach((obj, key) => {\n        key = dashify(key);\n        container.set(key, createDirective(obj));\n    });\n    return container;\n};\n\n//\n//  Finalise the binding between the view and the model\n//  inject the model into the view element\n//  call the mounted hook and can return a Promise\nexport const asView = (vm, element) => {\n\n    Object.defineProperty(sel(vm), 'el', {\n        get: function () {\n            return element;\n        }\n    });\n    // Apply model to element and mount\n    return vm.select(element).view(vm).mount().then(() => vmMounted(vm));\n};\n\nexport const mounted = (vm) => {\n    if (vm.isMounted === undefined) {\n        vm.isMounted = false;\n        return false;\n    }\n    else if (vm.isMounted) {\n        vm.logWarn(`component already mounted`);\n    }\n    else {\n        vm.isMounted = true;\n        // invoke mounted component hook\n        vm.mounted();\n        // invoke the view mounted events\n        vm.events.call('mounted', undefined, vm);\n    }\n    return true;\n};\n\n// Internals\n\n//\n//  Component/View mounted\n//  =========================\n//\n//  This function is called when a component/view has all its children added\nconst vmMounted = (vm) => {\n    var parent = vm.parent;\n    vm.childrenMounted();\n    if (parent && !parent.isMounted) {\n        const event = `mounted.${vm.uid}`;\n        vm.events.on(event, cm => {\n            if (cm === parent) {\n                vm.events.on(event, null);\n                mounted(vm);\n            }\n        });\n    }\n    else\n        mounted(vm);\n    return vm;\n};\n\n// Compile a component model\n// This function is called once a component has rendered the component element\nconst compile = (cm, origEl, element) => {\n    if (isString(element)) {\n        const props = Object.keys(cm.props).length ? cm.props : null;\n        element = cm.viewElement(element, props, origEl.ownerDocument);\n    }\n    element = asSelect(element);\n    const size = element.size();\n    if (!size) throw new Error('render() must return a single HTML node. It returned nothing!');\n    else if (size !== 1) cm.logWarn('render() must return a single HTML node');\n    element = element.node();\n    //\n    // mark the original element as component\n    origEl.__d3_component__ = true;\n    // Insert before the component element\n    if (origEl.parentNode)\n        origEl.parentNode.insertBefore(element, origEl);\n    // remove the component element\n    cm.select(origEl).remove();\n    //\n    return asView(cm, element);\n};\n\n\n// Invoked when a component cm has failed to render\nconst error = (cm, origEl, exc) => {\n    cm.logWarn(`failed to render due to the unhandled exception reported below`);\n    cm.logError(exc);\n    cm.events.call('error', undefined, cm, origEl, exc);\n    return cm;\n};\n\n\nconst asObject = (value, opts) => {\n    if (isFunction(value)) value = value();\n    if (isArray(value))\n        value = value.reduce((o, key) => {\n            o[key] = undefined;\n            return o;\n        }, {});\n    return assign({}, value, opts);\n};\n\n\nconst bindView = (view, model) => {\n    Object.defineProperties(model, {\n        $$view: {\n            get () {\n                return view;\n            }\n        },\n        $$name: {\n            get () {\n                return view.name;\n            }\n        },\n        props: {\n            get () {\n                return view.props;\n            }\n        }\n    });\n    return model;\n};\n","import {select} from 'd3-selection';\nimport {isArray} from 'd3-let';\n\nimport {createComponent, protoView} from '../core/component';\n\n//\n//  d3-for directive\n//  ======================\n//\n//  Repeat a element over an array of items and establish\n//  a one way binding between the array and the Dom\nexport default {\n\n    create (expression) {\n        var bits = [];\n        expression.trim().split(' ').forEach((v) => {\n            v ? bits.push(v) : null;\n        });\n        if (bits.length !== 3 || bits[1] != 'in')\n            return this.logWarn(`directive requires \"item in expression\" template, got \"${expression}\"`);\n        this.itemName = bits[0];\n        this.itemClass = `for${this.uid}`;\n        return bits[2];\n    },\n\n    preMount () {\n        return true;\n    },\n\n    mount (model) {\n        this.creator = this.el;\n        this.el = this.creator.parentNode;\n        // remove the creator from the DOM\n        select(this.creator).remove();\n        if (this.el) return model;\n    },\n\n    refresh (model, items) {\n        if (!isArray(items)) return;\n        let d;\n\n        var creator = this.creator,\n            itemClass = this.itemClass,\n            selector = `.${itemClass}`,\n            itemName = this.itemName,\n            sel = this.sel,\n            allItems = sel.selectAll(selector),\n            entries = allItems.filter(function () {\n                d = this.__d3_view__.model[itemName];\n                return items.indexOf(d) > -1;\n            }).data(items),\n            exits = allItems.filter(function () {\n                d = this.__d3_view__.model[itemName];\n                return items.indexOf(d) === -1;\n            }).classed(itemClass, false),\n            vm = sel.view();\n\n        let forComponent = vm.components.get(creator.tagName.toLowerCase());\n        if (!forComponent) forComponent = createComponent('forView', protoView);\n\n        let x, el, fel, tr;\n\n        (this.transition(exits) || exits).style('opacity', 0).remove();\n\n        // Add all missing entries\n        entries\n            .enter()\n                .append(() => {\n                    el = creator.cloneNode(true);\n                    fel = vm.select(el);\n                    if (vm.transitionDuration(fel) > 0) fel.style('opacity', 0);\n                    return el;\n                })\n                .each(function (d, index) {\n                    x = {index: index};\n                    x[itemName] = d;\n                    forComponent({\n                        model: x,\n                        parent: vm\n                    }).mount(this, {model: vm.model}).then(fv => {\n                        fv.sel.classed(itemClass, true);\n                        // replace the item with a property from the model\n                        // This allow for reactivity when d is an object\n                        items[index] = fv.model[itemName];\n                        tr = fv.transition();\n                        if (tr) tr.style('opacity', 1);\n                    });\n                });\n\n        sel.selectAll(selector)\n            .each(function (d) {\n                // update model itemName property\n                this.__d3_view__.model[itemName] = d;\n            });\n    }\n};\n","//\n//  d3-if\n//  =============\n//\n//  Show or hide an element\n//\nexport default {\n\n    mount (model) {\n        var sel = this.sel;\n        this.display = sel.style('display');\n        this.opacity = +sel.style('opacity') || 1;\n        if (!this.display || this.display === 'none') this.display = 'block';\n        return model;\n    },\n\n    refresh (model, value) {\n        var sel = this.sel,\n            transition = this.passes ? this.transition(sel) : null;\n\n        if (value) sel.style('display', this.display);\n        else if (!transition) sel.style('display', 'none');\n\n        if (transition) {\n            if (value)\n                transition.style('opacity', 1);\n            else\n                transition\n                    .style('opacity', 0)\n                    .on('end', () => sel.style('display', 'none'));\n        } else\n            sel.style('opacity', value ? this.opacity : 0);\n    }\n};\n","import attr from './attr';\nimport html from './html';\nimport value from './value';\nimport on from './on';\nimport d3For from './for';\nimport d3If from './if';\n\n\nexport default {\n    attr,\n    html,\n    value,\n    on,\n    'for': d3For,\n    'if': d3If\n};\n","import {select} from 'd3-selection';\nimport {inBrowser} from 'd3-let';\n\n\nif (inBrowser && window.MutationObserver) {\n    // DOM observer\n    // Check for changes in the DOM that leads to visual actions\n    const observer = new window.MutationObserver(visualManager);\n    observer.observe(document.documentElement, {\n        childList: true,\n        subtree: true\n    });\n}\n\n//\n//  Clears element going out of scope\nfunction visualManager (records) {\n    let sel, nodes, node, vm;\n\n    records.forEach(record => {\n        nodes = record.removedNodes;\n        if (!nodes || !nodes.length) return;\n        vm = record.target ? select(record.target).view() : null;\n\n        for (let i=0; i<nodes.length; ++i) {\n            node = nodes[i];\n            if (!node.querySelectorAll || node.__d3_component__) continue;\n            sel = select(node);\n            if (vm || sel.view()) {\n                sel.selectAll('*').each(destroy);\n                destroy.call(nodes[i]);\n            }\n        }\n    });\n}\n\n\nfunction destroy () {\n    var dirs = this.__d3_directives__,\n        view = this.__d3_view__;\n    if (dirs) {\n        dirs.all.forEach(d => d.destroy());\n        delete this.__d3_directives__;\n    }\n    if (view) {\n        view.destroy();\n        delete this.__d3_view__;\n    }\n}\n","import directives from './directives/index';\nimport {createComponent, extendDirectives, protoView} from './core/component';\nimport './core/clean';\n\n// Core Directives\nconst coreDirectives = extendDirectives(new Map, directives);\n\n// the root view constructor\nexport default config => createComponent('view', protoView, coreDirectives)(config);\n","import {timeout} from 'd3-timer';\n\nimport providers from './providers';\n\n\n// Add callback to execute when the DOM is ready\nexport default callback => {\n    providers.readyCallbacks.push(callback);\n    /* istanbul ignore next */\n    if (document.readyState !== 'complete') {\n        document.addEventListener('DOMContentLoaded', _completed);\n        // A fallback to window.onload, that will always work\n        window.addEventListener('load', _completed);\n    }\n    else\n        domReady();\n};\n\n\n/* istanbul ignore next */\nfunction _completed () {\n    document.removeEventListener('DOMContentLoaded', _completed);\n\twindow.removeEventListener('load', _completed);\n    domReady();\n}\n\n\nfunction domReady() {\n    let callback;\n    while (providers.readyCallbacks.length ) {\n        callback = providers.readyCallbacks.shift();\n        timeout(callback);\n    }\n}\n","import {isObject} from 'd3-let';\n\n\nconst componentsFromType = {\n    text: 'input',\n    email: 'input',\n    password: 'input',\n    checkbox: 'input',\n    number: 'input',\n    date: 'input',\n    url: 'input',\n    'datetime-local': 'input'\n};\n\n\nexport const formComponent = child => {\n    var type = child.type || 'text';\n    return componentsFromType[type] || type;\n};\n\n\nexport const addAttributes = (el, attributes) => {\n    var expr, attr;\n\n    if (!isObject(attributes)) return;\n\n    for (attr in attributes) {\n        expr = attributes[attr];\n        if (isObject(expr)) expr = JSON.stringify(expr);\n        el.attr(attr, expr || '');\n    }\n};\n\n\nexport function formChild (child) {\n    var component = formComponent(child);\n    return document.createElement(`d3-form-${component}`);\n}\n","import {isString, isArray, assign} from 'd3-let';\n\nimport {addAttributes, formChild} from './utils';\nimport properties from '../utils/htmlprops';\n\n//\n// Mixin for all form elements\nexport const formElement = {\n    props: ['form'],\n\n    addChildren (sel, form) {\n        var children = this.props.children;\n        if (children) {\n            if (!isArray(children)) {\n                this.logError(`children should be an array of fields, got ${typeof children}`);\n                return sel;\n            }\n            if (form) children.forEach(c => {\n                c.form = form;\n            });\n            sel.selectAll('.d3form')\n                .data(children)\n                .enter()\n                .append(formChild)\n                .attr('form', 'form')\n                .classed('d3form', true);\n        }\n        return sel;\n    },\n\n    init (el) {\n        addAttributes(el, this.props.attributes);\n        properties.forEach((prop, key) => {\n            var value = this.props[key];\n            if (value) {\n                if (isString(value))\n                    el.attr(`d3-attr-${key}`, value);\n                else\n                    el.property(prop, true);\n            }\n        });\n        return el;\n    },\n\n    // wrap the form element with extensions\n    wrap (fieldEl) {\n        var wrappedEl = fieldEl;\n\n        this.root.$formExtensions.forEach(extension => {\n            wrappedEl = extension(this, wrappedEl, fieldEl) || wrappedEl;\n        });\n\n        return wrappedEl;\n    },\n\n    wrapTemplate (sel, template) {\n        var outer = this.createElement('div').html(template),\n            slot = outer.select('slot');\n\n        if (!slot.size()) {\n            this.logWarn('template does not provide a slot element');\n            return sel;\n        }\n        var target = this.select(slot.node().parentNode);\n        sel.nodes().forEach(function (node) {\n            target.insert(() => {return node;}, 'slot');\n        });\n        slot.remove();\n        return this.selectAll(outer.node().children);\n    },\n};\n\n// A mixin for all form field components\nexport default assign({}, formElement, {\n\n    model: {\n        value: null,\n        error: '',\n        isDirty: null,\n        changed: false,\n        srOnly: false,\n        placeholder: '',\n        showError: {\n            reactOn: ['error', 'isDirty'],\n            get () {\n                if (this.error) return this.isDirty;\n                return false;\n            }\n        },\n        // default validate function does nothing, IMPORTANT!\n        $validate () {}\n    },\n\n    init (el) {\n        // call parent method\n        formElement.init.call(this, el);\n        const props = this.props,\n            model = this.model;\n\n        if (!props.name) {\n            this.logError('Input field without a name');\n            return el;\n        }\n\n        el.attr('name', props.name);\n        if (!props.placeholder) props.placeholder = props.label || props.name;\n        //\n        // give name to model (for debugging info messages)\n        model.name = props.name;\n        //\n        // bind to the value property (two-way binding when used with d3-value)\n        model.$on('value', () => {\n            // set isDirty to false if first time here, otherwise true\n            if (model.isDirty === null) {\n                model.isDirty = false;\n            } else {\n                model.isDirty = true;\n                model.changed = true;\n            }\n            // trigger a change event in the form\n            // required for form method such as $isValid\n            props.form.$change();\n            model.$emit('formFieldChange', model);\n        });\n        return el;\n    },\n\n    mounted () {\n        // add this model to the form inputs object\n        this.props.form.inputs[this.props.name] = this.model;\n    }\n\n});\n","import {assign} from 'd3-let';\n\nimport {formElement} from './field';\n\n//\n// Fieldset element\nexport default assign({}, formElement, {\n\n    render () {\n        const tag = this.props.tag || 'fieldset',\n            el = this.init(this.createElement(tag, true));\n        return this.addChildren(el);\n    }\n\n});\n","import map from '../utils/map';\n\n\nconst required = {\n\n    set (el, data) {\n        if (data.required) el.property('required', true);\n    },\n\n    validate (el, value) {\n        if (el.property('required'))\n            if (!value) return 'required';\n        else if (value === '') {\n            // this is valid, no need to continue with the remaining validators\n            return true;\n        }\n    }\n};\n\n\nconst minLength = {\n\n    set (el, data) {\n        var value = +data.minLength;\n        if (value === value) el.attr('minlength', value);\n    },\n\n    validate (el, value) {\n        var l = +el.attr('minlength');\n        if (l === l && l > 0 && value.length < l)\n            return `too short - ${l} characters or more expected`;\n    }\n};\n\n\nconst maxLength = {\n\n    set (el, data) {\n        var value = +data.maxLength;\n        if (value === value) el.attr('maxlength', value);\n    },\n\n    validate (el, value) {\n        var l = +el.attr('maxlength');\n        if (l === l && l > 0 && value && value.length > l)\n            return `too long - ${l} characters or less expected`;\n    }\n};\n\n\nconst minimum = {\n\n    set (el, data) {\n        var value = +data.minimum;\n        if (value === value) el.attr('min', value);\n    },\n\n    validate (el, value) {\n        var r = range(el);\n        if (r && +value < r[0])\n            return `must be greater or equal ${r[0]}`;\n    }\n};\n\n\nconst maximum = {\n\n    set (el, data) {\n        var value = +data.maximum;\n        if (value === value) el.attr('max', value);\n    },\n\n    validate (el, value) {\n        var r = range(el);\n        if (r && +value > r[1])\n            return `must be less or equal ${r[1]}`;\n    }\n};\n\n\nexport default map({\n    required,\n    minLength,\n    maxLength,\n    minimum,\n    maximum\n});\n\n\nconst range  = el => {\n    var l0 = el.attr('min'),\n        l1 = el.attr('max');\n    l0 = l0 === null ? -Infinity : +l0;\n    l1 = l1 === null ? Infinity : +l1;\n    return [l0, l1];\n};\n","import validators from './validators';\n\n\n// validator singleton\nexport default (vm, el) => {\n    validators.forEach(validator => {if(validator.set) validator.set(el, vm.props);});\n    vm.model.$on('value.validate', validate);\n    vm.model.$validate = validate;\n};\n\n\nfunction validate () {\n    var vm = this.$$view,\n        value = this.value,\n        el = vm.sel.attr('id') === this.props.id ? vm.sel : vm.sel.select(`#${this.props.id}`),\n        msg;\n\n    for (let validator of validators.values()) {\n        msg = validator.validate(el, value);\n        if (msg) {\n            if (msg === true) msg = '';\n            break;\n        }\n    }\n\n    this.error = msg || '';\n}\n","import {assign} from 'd3-let';\n\nimport field from './field';\nimport validators from './validate';\n\n\nconst checks = ['checkbox', 'radio'];\n\n//\n// Input element\nexport default assign({}, field, {\n\n    render () {\n        const el = this.init(this.createElement('input', true));\n\n        el.attr('type', this.props.type || 'text')\n            .attr('d3-value', 'value');\n\n        if (checks.indexOf(el.attr('type')) === -1 && this.props.placeholder)\n            el.attr('placeholder', this.props.placeholder);\n\n        validators(this, el);\n        return this.wrap(el);\n    }\n});\n","import {assign} from 'd3-let';\n\nimport field from './field';\nimport validators from './validate';\n\n//\n// Textarea element\nexport default assign({}, field, {\n\n    render () {\n        var el = this.init(this.createElement('textarea', true));\n        el.attr('placeholder', this.props.placeholder)\n            .attr('d3-value', 'value');\n\n        validators(this, el);\n        return this.wrap(el);\n    }\n\n});\n","import {isArray, isString, assign} from 'd3-let';\n\nimport field from './field';\nimport validators from './validate';\n\n//\n// Select element\nexport default assign({}, field, {\n\n    model: assign({\n        options: []\n    }, field.model),\n\n    render () {\n        const el = this.init(this.createElement('select', true));\n        this.model.options = asOptions(this.model.options);\n        el.attr('d3-value', 'value')\n            .attr('placeholder', this.props.placeholder)\n            .append('option')\n                .attr('d3-for', 'option in options')\n                .attr('d3-html', 'option.label')\n                .attr('d3-attr-value', 'option.value');\n\n        validators(this, el);\n        return this.wrap(el);\n    }\n});\n\n\nconst asOptions = options => {\n    if (!isArray(options)) options = [];\n    options.forEach((opt, idx) => {\n        if (isArray(opt)) opt = {\n            value: opt[0],\n            label: opt[1] || opt[0]\n        };\n        else if (isString(opt)) opt = {\n            value: opt,\n            label: opt\n        };\n        options[idx] = opt;\n    });\n    return options;\n};\n","import {assign} from 'd3-let';\n\nimport {formElement} from './field';\n\n//\n// Submit element\nexport default assign({}, formElement, {\n\n    model: {\n        $submit () {\n            if (this.$event && this.$event.defaultPrevented) return;\n            this.props.form.actions.submit.call(this, this.$event);\n        }\n    },\n\n    render () {\n        const tag = this.props.tag || 'button',\n            el = this.init(this.createElement(tag, true));\n\n        el.attr('type', this.props.type || 'submit')\n            .attr('name', this.props.name || '_submit_')\n            .attr('d3-on-click', '$submit()')\n            .html(this.props.label || 'submit');\n\n        return this.wrap(el);\n    }\n});\n","//\n//  Form Responses\n//  ====================\n//\n//  To add/override responses:\n//\n//  import viewForms from 'd3-view'\n//\n//  viewForms.responses.myresponse = function (data, status, headers) {\n//      ...\n//  }\nexport default {\n    \"default\": defaultResponse,\n    redirect\n};\n\n\n// The default response emit a formMessage to event to parent models\nfunction defaultResponse (response) {\n    var level = response.status < 300 ? 'info' : (response.status < 500 ? 'warning' : 'error');\n    this.$emit('formMessage', {\n        level: level,\n        data: response.data,\n        response: response\n    });\n}\n\n\nfunction redirect (response) {\n    var location = this.$$view.providers.location;\n    location.href = response.data.redirectTo || '/';\n}\n","import {assign} from 'd3-let';\n\n//\n// Form Actions\nexport default {\n    submit: submit\n};\n\nconst messages = {\n    default: '<strong>Error!</strong> Could not submit form'\n};\n\n\nconst endpointDefaults = {\n    contentType: 'application/json',\n    method: 'POST'\n};\n\n//\n// Submit action\nfunction submit (e) {\n    var submit = this,\n        view = submit.$$view,\n        form = view.props.form,\n        endpoint = assign({}, endpointDefaults, submit.props.endpoint);\n\n    if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    var data = form.$inputData(),\n        options = {};\n\n    if (!endpoint.url) {\n        view.logError('No url, cannot submit form');\n        return;\n    }\n\n    if (endpoint.contentType === 'application/json') {\n        options.headers = {\n            'Content-Type': endpoint.contentType\n        };\n        options.body = JSON.stringify(data);\n    }\n    else {\n        options.body = new FormData();\n        for (var key in data)\n            options.body.append(key, data[key]);\n    }\n\n    // Flag the form as submitted\n    if (!form.$setSubmit()) {\n        // form not valid, don't bother with request\n        form.$setSubmitDone();\n    } else {\n        options.method = endpoint.method;\n        view.json(endpoint.url, options).then(done, done);\n    }\n\n\n    function done (response) {\n        form.$setSubmitDone();\n        if (response.status && response.headers)\n            form.$response(response);\n        else\n            form.$emit('formMessage', {\n                level: 'error',\n                message: messages[response.message] || messages.default,\n            });\n    }\n}\n","import {isString, assign} from 'd3-let';\n\nimport {formElement} from './field';\nimport fieldset from './field-set';\nimport input from './field-input';\nimport textarea from './field-textarea';\nimport select from './field-select';\nimport submit from './field-submit';\nimport responses from './responses';\nimport actions from './actions';\n\n\n// Main form component\nexport default assign({}, formElement, {\n\n    // Allow to specify and initial values\n    props: ['url', 'values', 'form'],\n\n    components: {\n        'd3-form-fieldset': fieldset,\n        'd3-form-input': input,\n        'd3-form-textarea': textarea,\n        'd3-form-select': select,\n        'd3-form-submit': submit\n    },\n\n    model: {\n        form: null,     //  parent form\n        formSubmitted: false,\n        formPending: false,\n        $isValid (submitting) {\n            let inp,\n                valid = true;\n            for (var key in this.inputs) {\n                inp = this.inputs[key];\n                if (submitting) inp.isDirty = true;\n                inp.$validate();\n                if (inp.error) valid = false;\n            }\n            return valid;\n        },\n        $setSubmit () {\n            this.formSubmitted = true;\n            this.formPending = true;\n            return this.$isValid(true);\n        },\n        $setSubmitDone () {\n            this.formPending = false;\n        },\n        $inputData () {\n            var inputs = this.inputs,\n                data = {},\n                value;\n            for (var key in inputs) {\n                value = inputs[key].value;\n                if (value || input.changed) data[key] = value;\n            }\n            return data;\n        },\n        //\n        // response from a server submit\n        $response (response) {\n            if (response.data) {\n                if (this.props.resultHandler) {\n                    var handler = responses[this.props.resultHandler];\n                    if (!handler) this.$$view.logError(`Could not find ${this.props.resultHandler} result handler`);\n                    else handler.call(this, response);\n                } else {\n                    responses.default.call(this, response);\n                }\n            } else\n                this.$responseError(response);\n        },\n        //\n        //  bad response from server submit\n        $responseError (response) {\n            this.$emit('formMessage', {\n                level: 'error',\n                data: response.data,\n                response: response\n            });\n        }\n    },\n\n    render () {\n        if (this.props.url)\n            return this.json(this.props.url).then(response => this.build(response.data));\n        else return this.build();\n    },\n\n    childrenMounted () {\n        var model = this.model,\n            values = this.props.values;\n\n        if (values) Object.keys(values).forEach(key => {\n            var inp = model.inputs[key];\n            if (inp) inp.value = values[key];\n        });\n    },\n\n    build (props) {\n        if (props) this.props = assign(this.props, props);\n        const form = this.init(this.createElement('form', true).attr('novalidate', '')),\n            model = this.model;\n        //\n        model.$formExtensions = this.root.$formExtensions || [];\n        model.inputs = {};\n        model.actions = {};\n        //\n        // Form actions\n        for (var key in actions) {\n            var action = this.props[key];\n            if (isString(action)) action = this.model.$get(action);\n            model.actions[key] = action || actions[key];\n        }\n        return this.addChildren(form, model);\n    }\n});\n","import form from './form';\nimport actions from './actions';\nimport responses from './responses';\nimport validators from './validators';\n\n\n// Forms plugin\nexport default {\n    install (vm) {\n        vm.addComponent('d3form', form);\n        // list of form Extensions\n        vm.$formExtensions = [];\n    },\n    actions,\n    responses,\n    validators\n};\n","export default (field, wrappedEl) => {\n    return field.wrapTemplate(wrappedEl, `<slot></slot><div class=\"invalid-feedback\" d3-html=\"error\"></div>`);\n};\n","export default function (field, wrappedEl) {\n    var data = field.props;\n    return field.wrapTemplate(wrappedEl, labelTpl(data));\n}\n\n\nfunction labelTpl(data) {\n    var label = data.label || data.name;\n\n    return `<label for=${data.id} class=\"control-label\" d3-class=\"[srOnly ? 'sr-only' : null]\">${label}</label>\n<slot></slot>`;\n}\n","export default (field, wrappedEl, fieldEl) => {\n    var data = field.props,\n        size = data.size !== undefined ? data.size : data.form.props.size,\n        fc = size ? `form-control form-control-${size}` : 'form-control';\n    fieldEl.classed(fc, true).attr('d3-class',\n        `[${data.required || false} ? \"form-control-required\" : null, showError ? \"is-invalid\" : null]`\n    );\n    return field.wrapTemplate(wrappedEl, `<div class=\"form-group\"><slot></slot></div>`);\n};\n","export default function (field, wrappedEl, fieldEl) {\n    var data = field.props,\n        ig = data.group;\n    if (!ig) return wrappedEl;\n    var gid = `g${fieldEl.attr('id')}`;\n    fieldEl.attr('aria-describedby', gid);\n    return field.wrapTemplate(wrappedEl, groupTpl(gid, ig));\n}\n\n\nfunction groupTpl(gid, group) {\n    return (`\n        <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n                <span class=\"input-group-text\" id=\"${gid}\">${group}</span>\n            </div>\n            <slot></slot>\n        </div>\n    `);\n}\n","export default function (field, wrappedEl, fieldEl) {\n    var data = field.props;\n    fieldEl.classed('custom-control-input', true);\n    return field.wrapTemplate(wrappedEl, groupTpl(data));\n}\n\nfunction groupTpl(data) {\n    return (`\n        <div class=\"custom-control custom-checkbox\">\n            <slot></slot>\n            <label class=\"custom-control-label\" for=\"${data.id}\">${data.label}</label>\n        </div>\n    `);\n}\n","const groupTpl = `<div class=\"form-group\">\n<slot></slot>\n</div>`;\n\n\nexport default function (field, wrappedEl, fieldEl) {\n    var data = field.props,\n        theme = data.theme || 'primary';\n    fieldEl.classed('btn', true).classed(`btn-${theme}`, true);\n    return field.wrapTemplate(wrappedEl, groupTpl);\n}\n","export default function (field, wrappedEl, fieldEl) {\n    var data = field.props;\n    if (data.help) {\n        fieldEl.attr('aria-describedby', `help-${data.id}`);\n        return field.wrapTemplate(wrappedEl, helpTpl(data));\n    } else\n        return wrappedEl;\n}\n\n\nfunction helpTpl(data) {\n    return `<slot></slot><small id=\"help-${data.id}\" class=\"form-text text-muted\">${data.help}</small>`;\n}\n","import error from './error';\nimport label from './label';\nimport formGroup from './form-group';\nimport inputGroup from './input-group';\nimport formCheck from './check';\nimport submit from './submit';\nimport help from './help';\n\n\nconst bootstrap = {\n\n    input: ['error', 'inputGroup', 'label', 'help', 'formGroup'],\n    checkbox: ['error', 'formCheck', 'help', 'formGroup'],\n    textarea: ['error', 'label', 'help', 'formGroup'],\n    select: ['error', 'label', 'help', 'formGroup'],\n    submit: ['submit'],\n    wrappers: {\n        error,\n        label,\n        formGroup,\n        inputGroup,\n        formCheck,\n        submit,\n        help\n    }\n};\n\n\n//\n//  Bootstrap plugin\n//  ===================\n//\n//  Simply add a new form extension to wrap form fields\n//\nexport default {\n\n    install (vm) {\n        if (!vm.$formExtensions)\n            return vm.logWarn('form bootstrap requires the form plugin installed first!');\n        vm.$formExtensions.push(wrapBootstrap);\n    }\n};\n\n\nfunction wrapBootstrap(field, wrappedEl, fieldEl) {\n    var wrappers = bootstrap[fieldEl.attr('type')] || bootstrap[fieldEl.node().tagName.toLowerCase()];\n    if (!wrappers) return wrappedEl;\n    let wrap;\n\n    wrappers.forEach(wrapper => {\n        wrap = bootstrap.wrappers[wrapper];\n        if (wrap) wrappedEl = wrap(field, wrappedEl, fieldEl);\n        else field.logWarn(`Could not find form field wrapper ${wrapper}`);\n    });\n\n    return wrappedEl;\n}\n","export default str => {\n    str = str.replace(/^\\s+|\\s+$/g, ''); // trim\n    str = str.toLowerCase();\n\n    // remove accents, swap ñ for n, etc\n    var from = 'àáäâèéëêìíïîòóöôùúüûñç·/_,:;';\n    var to = 'aaaaeeeeiiiioooouuuunc------';\n    for (var i = 0, l = from.length; i < l; i++) {\n        str = str.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));\n    }\n\n    str = str.replace(/[^a-z0-9 -]/g, '') // remove invalid chars\n        .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n        .replace(/-+/g, '-'); // collapse dashes\n\n    return str;\n};\n"],"names":["Map","create","expression","arg","logWarn","refresh","model","value","refreshClass","isArray","prop","properties","get","sel","property","attr","oldValue","forEach","entry","classed","map","exist","html","isNumber","isString","dir","transition","passes","style","on","selectChildren","mount","callback","delay","promise","self","args","debounce","arguments","Promise","resolve","reject","timeout","apply","undefined","err","o","Object","defineProperty","select","el","base","attrName","refreshFunction","uid","off","length","createValueType","proto","ValueType","prototype","assign","vType","$set","options","selectAll","values","opt","each","indexOf","push","input","textarea","checkbox","type","tag","tagName","toLowerCase","types","expr","parsed","codes","IDENTIFIER","destroy","eventName","md","$child","$event","event","eval","bindDestroy","attributes","element","vm","dirs","Directives","i","bits","name","split","dirName","slice","join","directive","directives","add","attrs","all","size","pop","index","removeAttribute","splice","preMount","execute","d","obj","idx","Array","call","isAbsolute","RegExp","isRelative","hasOwnProperty","viewLibs","isAbsoluteUrl","test","url","viewResolve","dist","main","path","location","removeFrontSlash","removeBackSlash","origin","version","URL","href","Error","viewRequireFrom","resolver","root","modules","queue","some","getRoot","window","requireRelative","module","set","script","document","createElement","onload","error","remove","onerror","async","src","define","head","appendChild","requireOne","require","then","merge","amd","dependencies","factory","isexports","exports","viewRequire","substring","n","m","k","getter","object","logger","debug","readyCallbacks","setDebug","active","isFunction","defaultDebug","inBrowser","fetch","d3","msg","info","prefix","providers","warn","selection","view","node","__d3_directives__","getdirs","getComponent","__d3_view__","parent","parentNode","data","promises","mountElement","component","cm","children","c","components","template","source","context","s","compile","htmlElement","ownerDocument","compileTemplate","text","HttpResponse","response","status","headers","description","statusText","HttpError","jsonResponse","ct","json","textResponse","isd3","viewElement","selector","fetchText","x","renderFromUrl","asElement","cache","has","render","renderFromDist","asSelect","domEvent","logError","stack","logInfo","logDebug","defaultView","duration","transitionDuration","code","COMPOUND","MEMBER_EXP","LITERAL","THIS_EXP","CALL_EXP","UNARY_EXP","BINARY_EXP","LOGICAL_EXP","CONDITIONAL_EXP","ARRAY_EXP","PERIOD_CODE","COMMA_CODE","SQUOTE_CODE","DQUOTE_CODE","OPAREN_CODE","CPAREN_CODE","OBRACK_CODE","CBRACK_CODE","QUMARK_CODE","SEMCOL_CODE","COLON_CODE","throwError","message","t","unary_ops","binary_ops","getMaxKeyLen","max_len","len","key","max_unop_len","max_binop_len","literals","this_str","binaryPrecedence","op_val","createBinaryExpression","operator","left","right","isDecimalDigit","ch","isIdentifierStart","String","fromCharCode","isIdentifierPart","jsep","charAtFunc","charAt","charCodeAtFunc","charCodeAt","exprI","exprICode","gobbleSpaces","gobbleExpression","gobbleBinaryExpression","consequent","alternate","gobbleBinaryOp","to_check","substr","tc_len","biop","prec","biop_info","gobbleToken","gobbleNumericLiteral","gobbleStringLiteral","gobbleVariable","gobbleArray","argument","number","chCode","parseFloat","raw","str","quote","closed","gobbleIdentifier","start","identifier","gobbleArguments","termination","ch_i","gobbleGroup","computed","callee","elements","nodes","body","addUnaryOp","op_name","Math","max","addBinaryOp","precedence","addLiteral","literal_name","literal_value","removeUnaryOp","removeBinaryOp","removeLiteral","evaluate","nested","elem","binaryExp","callExpression","unaryExp","identifiers","Set","fullName","func","EvalError","op","unaryFunctions","Function","a","b","binaryFunctions","safeEval","Expression","UID","triggered","events","dispatch","change","typename","trigger","asModel","initials","isolated","Child","ddispatch","defineProperties","$events","$update","createChildConstructor","modelStr","constructor","$logWarn","reactive","isModel","isObject","toString","lazy","typeValue","$change","update","newValue","modelName","$$name","isVanillaObject","reactOn","$on","arrayValue","modelValue","$new","$off","parentAttr","owner","$owner","dd","getEvent","replace","removeEvent","attribute","$isReactive","serialTypes","Boolean","Number","keys","from","concat","getValue","$data","propagate","originModel","$push","array","$splice","count","Model","$connect","$emit","$$view","isolatedRoot","bindModel","target","modelEvents","viewModel","addTarget","Directive","viewExpression","e","JSON","parse","getTarget","entries","DATAPREFIX","p","reduce","toUpperCase","Cache","clear","delete","TypeError","trim","condense","protoView","doMount","asView","protoComponent","childrenMounted","mounted","props","dataAttributes","datum","extra","maybeJson","parentModel","bindView","id","doc","class","newEl","catch","exc","use","plugin","install","addComponent","dashify","createComponent","addDirective","createDirective","coreDirectives","coreComponents","classComponents","extendComponents","classDirectives","extendDirectives","Component","comp","asObject","container","vmMounted","isMounted","origEl","__d3_component__","insertBefore","opts","v","itemName","itemClass","creator","items","allItems","filter","exits","forComponent","fel","tr","enter","append","cloneNode","fv","display","opacity","d3For","d3If","MutationObserver","observer","visualManager","observe","documentElement","childList","subtree","records","record","removedNodes","querySelectorAll","config","readyState","addEventListener","_completed","domReady","removeEventListener","shift","componentsFromType","email","password","date","formComponent","child","addAttributes","stringify","formChild","formElement","addChildren","form","init","wrap","fieldEl","wrappedEl","$formExtensions","extension","wrapTemplate","outer","slot","insert","isDirty","changed","srOnly","placeholder","showError","$validate","label","inputs","required","validate","minLength","l","maxLength","minimum","r","range","maximum","l0","l1","Infinity","validators","validator","checks","field","asOptions","$submit","defaultPrevented","actions","submit","defaultResponse","redirect","level","redirectTo","messages","default","endpointDefaults","contentType","method","endpoint","preventDefault","stopPropagation","$inputData","FormData","$setSubmit","$setSubmitDone","done","$response","fieldset","formSubmitted","formPending","$isValid","submitting","inp","valid","resultHandler","handler","responses","$responseError","build","action","$get","labelTpl","fc","ig","group","gid","groupTpl","theme","help","helpTpl","bootstrap","wrappers","formGroup","inputGroup","formCheck","wrapBootstrap","wrapper","to"],"mappings":"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"}