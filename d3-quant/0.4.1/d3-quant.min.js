// https://github.com/quantmind/d3-quant Version 0.4.1. Copyright 2017 quantmind.com.
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array")):"function"==typeof define&&define.amd?define("d3-quant",["exports","d3-array"],t):t(n.d3=n.d3||{},n.d3)}(this,function(n,t){"use strict";function r(n){return new e(n)}function e(n){function t(){if(0===d)return d++,i.slice();for(var t=[],e=1,a=d-1;1==(1&a);)a>>=1,e++;for(r=0;r<n;r++)s[r]^=o[r][e],t[r]=s[r]/u;return d++,t}if(n<1||n>f.length)throw new Error("Out of range dimension");var r,e=[],o=[],i=[],s=[],h=f,d=0;for(Object.defineProperties(this,{dimension:{get:function(){return n}},count:{get:function(){return d}}}),this.next=t,r=0;r<=a;r++)e.push(0);for(r=0;r<n;r++)o[r]=e.slice(),s[r]=0,i[r]=0;for(r=1;r<=a;r++)o[0][r]=1<<a-r;for(var c=1;c<n;c++){var p=h[c].split(/\s+/),l=+p[1],m=+p[2],M=[0];for(r=0;r<l;r++)M.push(+p[3+r]);for(r=1;r<=l;r++)o[c][r]=M[r]<<a-r;for(r=l+1;r<=a;r++){o[c][r]=o[c][r-l]^o[c][r-l]>>l;for(var y=1;y<=l-1;y++)o[c][r]^=(m>>l-1-y&1)*o[c][r-y]}}}function o(n,t){for(var r=0,e=0;e<n.length;e++)r+=Math.pow(t[e]-n[e],2);return Math.sqrt(r)}function i(n){return n instanceof i?n:(new s).addTenure(n)}function s(){this.$months=0,this.$days=0,Object.defineProperties(this,{years:{get:function(){return Math.trunc(this.$months/12)}},months:{get:function(){return this.$months%12}},weeks:{get:function(){return Math.trunc(this.$days/7)}},days:{get:function(){return this.$days%7}},totalDays:{get:function(){return 30*this.$months+this.$days}}})}var a=52,u=2<<51,f=["d       s       a       m_i","2       1       0       1","3       2       1       1 3","4       3       1       1 3 1","5       3       2       1 1 1","6       4       1       1 1 3 3","7       4       4       1 3 5 13","8       5       2       1 1 5 5 17","9       5       4       1 1 5 5 5","10      5       7       1 1 7 11 1"];e.prototype={generate:function(n){for(var t=[],r=0;r<n;++r)t.push(this.next());return t}};var h=Object.freeze({euclidean:o}),d=function(){var n,r,e=300,o={centroids:function(n){return arguments.length?(r=n,o):r},maxIters:function(n){return arguments.length?(e=+n,o):e},distance:function(t){return arguments.length?(t=t||"euclidean","string"==typeof t&&(t=h[t]),n=t,o):n},randomCentroids:function(n,t){var r=n.slice(0);return r.sort(function(){return Math.round(Math.random())-.5}),r.slice(0,t)},classify:function(t){var e=1/0,o=0,i=void 0,s=void 0;for(i=0;i<r.length;i++)s=n(t,r[i]),s<e&&(e=s,o=i);return o},cluster:function(n,e){var i,s,a,u=0,f=!0,h=n.length;r||(r=o.randomCentroids(n,h),o.centroids(r));var d=r.length,c=new Array(d);if(h<d)throw Error("Number of points less than the number of clusters in K-means classification");for(;f&&u<o.maxIters();){for(f=!1,++u,a=0;a<d;++a)c[a]={centroid:r[a],points:[],indices:[]};for(s=0;s<h;s++)a=o.classify(n[s]),c[a].points.push(n[s]),c[a].indices.push(s);for(i=[],a=0;a<d;++a){if(!c[a].points.length){i=o.randomCentroids(n,d);break}i.push(t.mean(c[a].points))}for(a=0;a<d;++a)if(i[a]!=r[a]){r=i,f=!0;break}o.centroids(r),e&&e(c,u)}return c}};return o.distance("euclidean")},c=function(n,t,r){function e(n,t){var r=n/u|0,e=t/u|0,o=Math.max(r-2,0),i=Math.max(e-2,0),a=Math.min(r+3,f),c=Math.min(e+3,h);for(e=i;e<c;++e){var p=e*f;for(r=o;r<a;++r)if(l=d[p+r]){var l,m=l[0]-n,M=l[1]-t;if(m*m+M*M<s)return!1}}return!0}function o(n,t){var r=[n,t];return c.push(r),d[f*(t/u|0)+(n/u|0)]=r,++l,++p,r}var i=30,s=r*r,a=3*s,u=r*Math.SQRT1_2,f=Math.ceil(n/u),h=Math.ceil(t/u),d=new Array(f*h),c=[],p=0,l=0;return function(){if(!l)return o(Math.random()*n,Math.random()*t);for(;p;){for(var r=Math.random()*p|0,u=c[r],f=0;f<i;++f){var h=2*Math.PI*Math.random(),d=Math.sqrt(Math.random()*a+s),m=u[0]+d*Math.cos(h),M=u[1]+d*Math.sin(h);if(0<=m&&m<n&&0<=M&&M<t&&e(m,M))return o(m,M)}c[r]=c[--p],c.length=p}}},p={Y:"Years",M:"Months",W:"Weeks",D:"Days"};s.prototype=i.prototype={addTenure:function(n){if(n instanceof i)this.$months+=n.$months,this.$days+=n.$days;else{var t,r,e=(""+n).toUpperCase(),o="DWMY",s=0,a=o[s],u=1;for("-"===e[0]&&(u=-1,e=e.substring(1));e.length;){if(!a)throw new Error('Unknown period "'+n+'"');if(t=e.indexOf(a),t!=-1){for(r=0;t-r-1>=0&&+e[t-r-1]===+e[t-r-1];)r++;if(!r)throw new Error('Unknown period "'+n+'"');this["add"+p[a]](u*e.substring(t-r,t)),e=e.substring(0,t-r)+e.substring(t+1)}else a=o[++s]}}return this},addDays:function(n){this.$days+=n},addWeeks:function(n){this.$days+=7*n},addMonths:function(n){this.$months+=n},addYears:function(n){this.$months+=12*n}};var l=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)},m="0.4.1";n.sobol=r,n.kmeans=d,n.poisson=c,n.period=i,n.round=l,n.quantVersion=m,Object.defineProperty(n,"__esModule",{value:!0})});