{"version":3,"file":"d3-visualize.js","sources":["../src/utils/randompath.js","../src/data/array.js","../src/data/warn.js","../src/utils/isurl.js","../src/data/remote.js","../src/data/composite.js","../src/data/expression.js","../src/utils/accessor.js","../src/data/dataframe.js","../src/utils/warn.js","../src/transforms/filter.js","../src/utils/fillarray.js","../src/transforms/aggregate.js","../src/transforms/timeseries.js","../src/core/options.js","../src/transforms/mapfields.js","../src/transforms/index.js","../src/data/sources.js","../src/data/store.js","../src/data/locale.js","../src/utils/round.js","../src/utils/size.js","../src/core/base.js","../src/core/visual.js","../src/utils/camelfunction.js","../src/core/chart.js","../src/core/paper.js","../src/plugins/menu.js","../src/utils/format.js","../src/plugins/data.js","../src/plugins/responsive.js","../src/plugins/title.js","../src/plugins/margin.js","../src/plugins/axis.js","../src/plugins/color.js","../src/plugins/legend.js","../src/plugins/clusterize.js","../src/plugins/paginate.js","../src/plugins/bootstrap.js","../src/plugins/index.js","../src/core/container.js","../src/components/dashboard.js","../src/components/visual.js","../src/data/formatters.js","../src/utils/columns.js","../src/components/tabular.js","../src/components/index.js","../src/utils/constant.js","../src/utils/descending.js","../src/utils/identity.js","../src/transforms/pyramid.js","../src/charts/line.js","../src/charts/bar.js","../src/charts/pie.js","../src/utils/polygon.js","../src/charts/pyramid.js","../src/charts/treemap.js","../src/charts/text.js","../index.js"],"sourcesContent":["import assign from 'object-assign';\nimport {range} from 'd3-array';\nimport {randomNormal} from 'd3-random';\n\n\nconst defaults = {\n    sigma: 0.1,\n    drift: 0\n};\n\n\nexport default function (size, options) {\n    options = assign({}, defaults, options);\n    var t = range(0, +size, 1),\n        S = options.sigma,\n        drift = options.drift,\n        data = [{x: 0, y: 0}],\n        norm = randomNormal(0, 1),\n        dx;\n\n    for (var i = 1; i < t.length; i++) {\n        dx = drift + S * norm();\n        data[i] = {\n            x: i,\n            y: data[i - 1].y + dx\n        };\n    }\n\n    return data;\n}\n","import {isArray, isObject} from 'd3-let';\nimport {resolvedPromise} from 'd3-view';\n\n//\n//  Array DataSource\n//  ====================\n//\n//  Data is given in an array, pkain & simple\nexport default {\n\n    initialise (config) {\n        this._data = config.data;\n    },\n\n    getConfig (config) {\n        if (isArray(config)) return {data: config};\n        else if (isObject(config) && isArray(config.data)) return config;\n    },\n\n    getData () {\n        return resolvedPromise(this.asFrame(this._data));\n    }\n};\n","import {viewProviders} from 'd3-view';\n\nconst prefix = '[d3-data-source]';\n\n\nexport default function (msg) {\n    viewProviders.logger.warn(`${prefix} ${msg}`);\n}\n","import {isString} from 'd3-let';\n\n\nconst schemes = ['http', 'https', 'ws', 'wss'];\n\n\nexport default function (value) {\n    return isString(value) && schemes.indexOf(value.split('://')[0]) > -1;\n}\n","import {csvParse} from 'd3-dsv';\nimport {isObject} from 'd3-let';\nimport {viewProviders, resolvedPromise} from 'd3-view';\n\nimport warn from './warn';\nimport isUrl from '../utils/isurl';\n\n//\n//  Remote dataSource\n//  ===================\n//\n//  handle Json and csv data\nexport default {\n\n    getConfig (config) {\n        if (isUrl(config)) return {url: config};\n        else if (isObject(config) && config.url)\n            return config;\n    },\n\n    initialise (config) {\n        this.url = config.url;\n    },\n\n    getData () {\n        var fetch = viewProviders.fetch,\n            self = this;\n        if (!fetch) {\n            warn('fetch provider not available, cannot submit');\n            return resolvedPromise([]);\n        }\n        return fetch(this.url).then(parse).then((data) => self.asFrame(data));\n    }\n};\n\n\nfunction parse (response) {\n    var ct = (response.headers.get('content-type') || '').split(';')[0];\n    if (ct === 'text/plain' || ct === 'text/csv')\n        return response.text().then(csvParse);\n    else if (ct === 'application/json')\n        return response.json();\n    else {\n        warn(`Cannot load content type '${ct}'`);\n        return [];\n    }\n}\n","import {isArray, isObject} from 'd3-let';\n//\n//  A composite dataSource\n//  ===================\n//\n//  A composite data source has the source attribute with the name of one\n//  or more data sets to use as the source for this data set.\n//  The source property is useful in combination with a transform pipeline\n//  to derive new data.\n//  If string-valued, indicates the name of the source data set.\n//  If array-valued, specifies a collection of data source names that\n//  should be merged (unioned) together.\nexport default {\n\n    initialise (config) {\n        this.source = config.source;\n    },\n\n    getConfig (config) {\n        if (isObject(config) && config.source) {\n            if (!isArray(config.source)) config.source = [config.source];\n            return config;\n        }\n    },\n\n    getData () {\n        var store = this.store,\n            self = this;\n        let frame;\n        return Promise.all(this.source.map(source => {\n             return store.getData(source);\n        })).then(frames => {\n            if (frames.length === 1) frame = frames[0];\n            else frame = self.mergeFrames(frames);\n            return self.asFrame(frame);\n        });\n    },\n\n    // TODO: implement frame merging\n    mergeFrames (frames) {\n        return frames[0];\n    }\n};\n","import {isObject} from 'd3-let';\nimport {viewExpression, resolvedPromise} from 'd3-view';\n\n\nexport default {\n\n    initialise (config) {\n        this.expression = viewExpression(config.expression);\n    },\n\n    getConfig (config) {\n        if (isObject(config) && config.expression)\n            return config;\n    },\n\n    getData () {\n        var self = this,\n            model = this.store.model;\n        return resolvedPromise(this.expression.eval(model)).then((data) => self.asFrame(data));\n    }\n};\n","export default function (field) {\n    return function (d) {\n        return d[field];\n    };\n}\n","import {isArray} from 'd3-let';\nimport {map} from 'd3-collection';\nimport crossfilter from 'crossfilter';\n\nimport accessor from '../utils/accessor';\n\n\nexport default function DataFrame (data, serie, store) {\n    if (isArray(data)) data = {\n        store: store,\n        data: data,\n        dimensions: {},\n        series: map()\n    };\n    Object.defineProperties(this, {\n        _inner: {\n            get () {\n                return data;\n            }\n        },\n        store: {\n            get () {\n                return data.store;\n            }\n        },\n        data: {\n            get () {\n                return data.data;\n            }\n        },\n        dimensions: {\n            get () {\n                return data.dimensions;\n            }\n        },\n        series: {\n            get () {\n                return data.series;\n            }\n        }\n    });\n    this.serie = serie;\n}\n\n\nDataFrame.prototype = {\n\n    size () {\n        return this.data.length;\n    },\n\n    new (serie) {\n        if (isArray(serie)) return new DataFrame(serie, null, this.store);\n        else return new DataFrame(this._inner, serie);\n    },\n\n    cf () {\n        if (!this._inner.cf) this._inner.cf = crossfilter(this.data);\n        return this._inner.cf;\n    },\n\n    //  Create and return a crossfilter dimension\n    //  If value is not specified, keepExisting is by default true, and any\n    //  existing dimension name is recycled.\n    dimension (name, value, keepExisting) {\n        if (arguments.length === 1) keepExisting = true;\n        var current = this.dimensions[name];\n        if (current) {\n            if (keepExisting) return current;\n            current.dispose();\n        }\n        if (!value) value = accessor(name);\n        this.dimensions[name] = this.cf().dimension(value);\n        return this.dimensions[name];\n    },\n\n    //  Sort a dataframe by name and return the top values or all of them if\n    //  top is not defined. The name can be a function.\n    sortby (name, top) {\n        return this.new(this.dimension(name).top(top || Infinity));\n    },\n\n    // return a new dataframe by pivoting values for field name\n    pivot (dimension, key, value, total) {\n        var group = this.dimension(dimension).group();\n        if (!total) total = 'total';\n        return this.new(group.reduce(pivoter(1), pivoter(-1), Object).all().map(d => d.value));\n\n        function pivoter (m) {\n            let pk, pv;\n            return function (o, record) {\n                pk = ''+record[key];\n                pv = m*record[value];\n                o[dimension] = record[dimension];\n                if (pk in o) o[pk] += pv;\n                else o[pk] = pv;\n                if (total in o) o[total] += pv;\n                else o[total] = pv;\n                return o;\n            };\n        }\n    },\n\n    add () {\n        //this._inner.cf.add(data);\n    },\n\n    map (mapper) {\n        return this.new(this.data.map(mapper));\n    }\n};\n","import {viewProviders} from 'd3-view';\n\nconst prefix = '[d3-visualize]';\n\n\nexport default function (msg) {\n    viewProviders.logger.warn(`${prefix} ${msg}`);\n}\n","import warn from '../utils/warn';\n\n//\n// Create a groupby transform from a config object\nexport default function (config) {\n    var dimension = config.dimension;\n\n    if (!dimension) warn('Filter transform requires a \"dimenstion\" entry');\n\n    return filter;\n\n    function filter (frame) {\n        if (dimension) {\n            var d = frame.dimension(dimension);\n            return frame.new(d.group());\n        }\n    }\n}\n","export default function (size, value) {\n    var a = new Array(size);\n    a.fill(value);\n    return a;\n}\n","import {map} from 'd3-collection';\nimport {isArray, isString} from 'd3-let';\nimport {max, min, sum, mean, median, variance, deviation} from 'd3-array';\n\nimport warn from '../utils/warn';\nimport fillArray from '../utils/fillarray';\n\nexport const operations = map({\n    count,\n    max,\n    min,\n    sum,\n    mean,\n    median,\n    variance,\n    deviation\n});\n\nfunction count (array, accessor) {\n    return array.reduce((v, d) => {\n        if (accessor(d) !== undefined) v += 1;\n        return v;\n    });\n}\n//\n// The aggregate transform groups and summarizes an imput data stream to\n// produce a derived output data stream. Aggregate transforms can be used\n// to compute counts, sums, averages and other descriptive statistics over\n// groups of data objects.\nexport default function (config) {\n    let fields = config.fields,\n        ops = config.ops,\n        as = config.as;\n\n    if (!fields && !ops) return countAll;\n\n    if (!isArray(fields)) return warn('Aggregate transforms expect an array of fields');\n    if (!ops) ops = 'count';\n    if (isString(ops)) ops = fillArray(fields.length, ops);\n    if (!isArray(ops)) return warn('Aggregate transform expects an array of ops');\n    if (ops.length < fields.length) warn('Aggregate transforms expects an ops array with same length as fields');\n    if (!as) as = [];\n    if (!isArray(as)) return warn('Aggregate transform expects an array of as fields');\n    return aggregate;\n\n\n    function countAll (frame) {\n        let key;\n        return frame.data.reduce((o, d) => {\n            for (key in d) {\n                if (key in o) o[key] += 1;\n                else o[key] = 1;\n            }\n            return o;\n        }, {});\n    }\n\n    function aggregate (frame) {\n        var data = [],\n            name, op;\n        fields.forEach((field, index) => {\n            name = ops[index];\n            op = count;\n            if (name) {\n                op = operations.get(name);\n                if (!op) {\n                    op = count;\n                    warn(`Operation ${ops[index]} is not supported, use count`);\n                }\n            }\n            data.push({\n                label: as[index] || field,\n                data: op(frame.data, d => d[field])\n            });\n        });\n        return data;\n    }\n}\n","import warn from '../utils/warn';\n\n//\n// Create a groupby transform from a config object\nexport default function (config) {\n    var sortby = config.sortby,\n        groupby = config.groupby;\n\n    if (!sortby) warn('timeseries transform requires a \"sortby\" entry');\n\n    return timeseries;\n\n    function timeseries (frame) {\n        if (sortby) {\n            if (groupby) {\n                var dim = frame.dimension(groupby),\n                    groups = dim.group().top(Infinity),\n                    newframe = frame.new([]),\n                    tmp;\n                groups.forEach(group => {\n                    tmp = frame.new(dim.filterExact(group.key).top(Infinity)).dimension(sortby).group().top(Infinity);\n                    newframe.series.set(group.key, frame.new(tmp).dimension('key').top(Infinity));\n                });\n                return newframe;\n            } else {\n                return frame.new(frame.dimension(sortby).top(Infinity));\n            }\n        }\n        return frame;\n    }\n}\n","//\n//  Global options for visuals\n//  ============================\n//\nexport default {\n    // visual data source\n    dataSource: null,\n    //\n    size: {\n        // width set by the parent element\n        width: null,\n        // height set as percentage of width\n        height: '70%'\n    }\n};\n","//\n//  Map Fields Transform\n//  ========================\n//\n//  Convert a set af fields to a different data type\n//\nimport assign from 'object-assign';\nimport {map} from 'd3-collection';\nimport {isString} from 'd3-let';\nimport {utcParse} from 'd3-time-format';\n\nimport warn from '../utils/warn';\nimport globalOptions from '../core/options';\n\n\nglobalOptions.dateFormat = '%d-%b-%y';\n\n\nconst converters = {\n    date (entry) {\n        return utcParse(entry.dateFormat || globalOptions.dateFormat);\n    },\n    number () {\n        return parseFloat;\n    }\n};\n\n\n//\nexport default function (config) {\n    config = assign({}, globalOptions.dateFormat, config);\n    var fields = map(config.fields);\n    let i, converter;\n\n    return mapfields;\n\n    function mapfields (frame) {\n        var mappers = [];\n\n        fields.each((entry, key) => {\n            if (isString(entry)) entry = {type: entry};\n            converter = converters[entry.type];\n            if (!converter) warn(`Cannot convert field ${key} to type ${entry.type}`);\n            else mappers.push([key, converter(entry)]);\n        });\n\n        if (mappers.length)\n            frame = frame.map(d => {\n                for (i=0; i<mappers.length; ++i)\n                    d[mappers[i][0]] = mappers[i][1](d[mappers[i][0]]);\n                return d;\n            });\n\n        return frame;\n    }\n}\n","// Collection of transforms\nimport {map} from 'd3-collection';\nimport {isArray} from 'd3-let';\n\nimport filter from './filter';\nimport aggregate from './aggregate';\nimport timeseries from './timeseries';\nimport mapfields from './mapfields';\n\n//\n//  transforms Store\nexport default map({\n    filter,\n    aggregate,\n    mapfields,\n    timeseries\n});\n\n\n// Apply data transforms to a series\nexport function applyTransforms (frame, transforms) {\n    let ts;\n    if (!transforms) return frame;\n    transforms.forEach(transform => {\n        if (transform) {\n            ts = transform(frame);\n            if (isArray(ts)) frame = frame.new(ts);\n            else if (ts) frame = ts;\n        }\n    });\n    return frame;\n}\n","import assign from 'object-assign';\nimport {map} from 'd3-collection';\nimport {dispatch} from 'd3-dispatch';\nimport {pop, isArray} from 'd3-let';\n\nimport DataFrame from './dataframe';\nimport transformStore, {applyTransforms} from '../transforms/index';\nimport warn from '../utils/warn';\n\nconst dataEvents = dispatch('init', 'data');\n\n\n//\n//  DataSource prototype\n//  ======================\nconst dataSourcePrototype = {\n\n    // get the config object-assign// This method is used by the prototype\n    // to check if the config object is a valid one\n    getConfig () {},\n\n    // initialise the data source with a config object\n    initialise () {},\n\n    getData () {},\n\n    //\n    addTransforms (transforms) {\n        var self = this;\n        let t;\n        if (!transforms) return;\n        if (!isArray(transforms)) transforms = [transforms];\n        transforms.forEach(transform => {\n            t = transformStore.get(transform.type);\n            if (!t) warn(`Transform \"${transform.type}\" not known`);\n            else self.transforms.push(t(transform));\n        });\n    },\n    //\n    // given a data object returns a Cross filter object\n    asFrame (data) {\n        if (isArray(data)) {\n            data = data.map(entry => {\n                if (entry.constructor !== Object) entry = {data: entry};\n                return entry;\n            });\n            data = new DataFrame(data, null, this.store);\n        }\n        return applyTransforms(data, this.transforms);\n    }\n};\n\n\n// DataSource container\nexport default assign(map(), {\n    events: dataEvents,\n\n    add (type, source) {\n\n        // DataSource constructor\n        function DataSource (config, store) {\n            initDataSource(this, type, config, store);\n        }\n\n        DataSource.prototype = assign({}, dataSourcePrototype, source);\n\n        this.set(type, DataSource);\n        return DataSource;\n    },\n\n    // Create a new DataSource\n    create (config, store) {\n        var sources = this.values(),\n            cfg;\n        for (var i=0; i<sources.length; ++i) {\n            cfg = sources[i].prototype.getConfig(config);\n            if (cfg) return new sources[i](cfg, store);\n        }\n    }\n});\n\n\nfunction initDataSource(dataSource, type, config, store) {\n\n    var name = store.dataName(pop(config, 'name')),\n        transforms = [];\n\n    // store.natural = cf.dimension(d => d._id);\n\n    Object.defineProperties(dataSource, {\n        name: {\n            get () {\n                return name;\n            }\n        },\n        store: {\n            get () {\n                return store;\n            }\n        },\n        type: {\n            get () {\n                return type;\n            }\n        },\n        // transforms to apply to data\n        transforms: {\n            get () {\n                return transforms;\n            }\n        },\n        config: {\n            get () {\n                return config;\n            }\n        }\n    });\n\n    dataSource.initialise(config);\n    dataSource.addTransforms(pop(config, 'transforms'));\n    store.sources.set(name, dataSource);\n    dataEvents.call('init', undefined, dataSource);\n}\n","import assign from 'object-assign';\n\nimport {map} from 'd3-collection';\nimport {isArray, isString} from 'd3-let';\nimport {resolvedPromise} from 'd3-view';\n\nimport array from './array';\nimport remote from './remote';\nimport composite from './composite';\nimport expression from './expression';\nimport dataSources from './sources';\nimport transformStore from '../transforms/index';\n\n\ndataSources.add('array', array);\ndataSources.add('remote', remote);\ndataSources.add('composite', composite);\ndataSources.add('expression', expression);\n\n//\n//  DataStore\n//  ==============\n//\n//  Map names to datasets\n//  Individual data sets are assumed to contain a collection of records\n//  (or “rows”), which may contain any number of named data\n//  attributes (fields, or “columns”).\n//  Records are modeled using standard JavaScript objects.\nexport default function DataStore(model) {\n    var sources = map();\n\n    Object.defineProperties(this, {\n        sources: {\n            get () {\n                return sources;\n            }\n        }\n    });\n\n    // transforms function\n    this.transforms = assign({}, transformStore);\n    this.dataCount = 0;\n    this.model = model;\n}\n\n\nDataStore.prototype = {\n    size () {\n        return this.sources.size();\n    },\n\n    // Add a new serie from a data source\n    addSources (config) {\n        //\n        // data is a string, it must be already registered with store\n        if (isString(config)) config = {source: config};\n\n        if (isArray(config)) {\n            var self = this;\n            return config.map(cfg => {\n                return dataSources.create(cfg, self);\n            });\n        } else if (config) {\n            return dataSources.create(config, this);\n        }\n    },\n\n    addTransforms (transforms) {\n        assign(this.transforms, transforms);\n    },\n\n    // set, get or remove a data source\n    source (name, source) {\n        if (arguments.length === 1) return this.sources.get(name);\n        if (source === null) {\n            var p = this.sources.get(name);\n            this.sources.remove(name);\n            return p;\n        }\n        this.sources.set(name, source);\n        return this;\n    },\n\n    clearCache () {\n        this.sources.each(ds => {\n            delete ds.cachedFrame;\n        });\n    },\n\n    // get data from a source\n    getData (source) {\n        var ds = this.sources.get(source);\n        if (!ds) throw new Error(`Data source ${source} not available`);\n        if (ds.cachedFrame) return resolvedPromise(ds.cachedFrame);\n        return ds.getData().then(frame => {\n            ds.cachedFrame = frame;\n            return frame;\n        });\n    },\n\n    dataName (name) {\n        this.dataCount++;\n        if (name) return '' + name;\n        var def = this.source('default');\n        if (!def) return 'default';\n        return `source${this.dataCount}`;\n    }\n};\n","// utility to load and set locale\nimport {formatDefaultLocale} from 'd3-format';\nimport {timeFormatDefaultLocale, timeFormat} from 'd3-time-format';\n\nimport dataSources from './sources';\n\n//\n// manage locale\nexport default {\n    formatDate: timeFormat('%d/%m/%Y'),\n\n    formatDateTime: timeFormat('%a %e %b %X %Y'),\n\n    load (symbol) {\n        var locales = this,\n            source1 = dataSources.create(`https://unpkg.com/d3-format/locale/${symbol}.json`),\n            source2 = dataSources.create(`https://unpkg.com/d3-time-format/locale/${symbol}.json`);\n\n        return Promise.all([\n            source1.load().then(\n                locale => {\n                    locales.symbol = symbol;\n                    locales.number = locale;\n                    formatDefaultLocale(locale);\n                }\n            ),\n            source2.load().then(\n                locale => {\n                    locales.time = locale;\n                    locales.formatDate = timeFormat(locale.date);\n                    locales.formatDateTime = timeFormat(locale.dateTime);\n                    timeFormatDefaultLocale(locale);\n                }\n            )\n        ]);\n    }\n};\n","export default function (x, n) {\n    return n ? Math.round(x * (n = Math.pow(10, n))) / n : Math.round(x);\n}\n","import {select} from 'd3-selection';\n\nimport round from './round';\n\n\nconst WIDTH = 400;\nconst HEIGHT = '75%';\n\n\nexport function sizeValue (value, size) {\n    if (typeof(value) === \"string\" && value.indexOf('%') === value.length-1)\n        return round(0.01*parseFloat(value)*size);\n    return +value;\n}\n\n// Internal function for evaluating paper dom size\nexport function getSize (element, options) {\n    var size = {\n        width: options.width,\n        height: options.height\n    };\n\n    if (!size.width) {\n        size.width = getWidth(element);\n        if (size.width)\n            size.widthElement = getWidthElement(element);\n        else\n            size.width = WIDTH;\n    }\n\n    if (!size.height) {\n        size.height = getHeight(element);\n        if (size.height)\n            size.heightElement = getHeightElement(element);\n        else\n            size.height = HEIGHT;\n    }\n\n    // Allow to specify height as a percentage of width\n    size.height = sizeValue(size.height, size.width);\n    return size;\n}\n\n\nexport function getWidth (element) {\n    var el = getParentElementRect(element, 'width');\n    if (el) return elementWidth(el);\n}\n\n\nexport function getHeight (element) {\n    var el = getParentElementRect(element, 'width');\n    if (el) return elementHeight(el);\n}\n\n\nexport function getWidthElement (element) {\n    return getParentElementRect(element, 'width');\n}\n\n\nexport function getHeightElement (element) {\n    return getParentElementRect(element, 'height');\n}\n\n\nfunction elementWidth (el) {\n    var w = el.getBoundingClientRect()['width'],\n        s = select(el),\n        left = padding(s.style('padding-left')),\n        right = padding(s.style('padding-right'));\n    return w - left - right;\n}\n\n\nfunction elementHeight (el) {\n    var w = el.getBoundingClientRect()['height'],\n        s = select(el),\n        top = padding(s.style('padding-top')),\n        bottom = padding(s.style('padding-bottom'));\n    return w - top - bottom;\n}\n\n\nfunction getParentElementRect (element, key) {\n    let parent = element.node ? element.node() : element,\n        v;\n    while (parent && parent.tagName !== 'BODY') {\n        v = parent.getBoundingClientRect()[key];\n        if (v)\n            return parent;\n        parent = parent.parentNode;\n    }\n}\n\n\nfunction padding (value) {\n    if (value && value.substring(value.length-2) == 'px')\n        return +value.substring(0, value.length-2);\n    return 0;\n}\n\n\nexport function boundingBox (size) {\n    var w = size.widthElement ? getWidth(size.widthElement) : size.width,\n        h;\n    if (size.heightPercentage)\n        h = round(w*size.heightPercentage, 0);\n    else\n        h = size.heightElement ? getHeight(size.heightElement) : size.height;\n    if (size.minHeight)\n        h = Math.max(h, size.minHeight);\n    return [round(w), round(h)];\n}\n","import assign from 'object-assign';\nimport {pop} from 'd3-let';\nimport {dispatch} from 'd3-dispatch';\nimport {select} from 'd3-selection';\nimport {viewBase, viewModel} from 'd3-view';\nimport 'd3-transition';\n\nimport globalOptions from './options';\nimport {sizeValue} from '../utils/size';\n\n\nconst CONTAINERS = ['visual', 'container'];\n\n//\n//  Gloval visuals object\n//  ==========================\n//\n//  Container of\n//  * live visuals\n//  * visual types\n//  * paper types\n//  * visual events\nexport const visuals = {\n    live: [],\n    types: {},\n    papers: {},\n    options: globalOptions,\n    events: dispatch(\n        'before-init',\n        'after-init',\n        'before-draw',\n        'after-draw'\n    )\n};\n\n//\n//  Visual Interface\n//  ====================\n//\n//  Base prototype object for visuals\n//\nexport const visualPrototype = assign({}, {\n\n    // initialise the visual with options\n    initialise () {\n\n    },\n\n    // draw this visual\n    draw () {},\n\n    select (el) {\n        return select(el);\n    },\n\n    // destroy the visual\n    destroy () {\n\n    },\n\n    toString () {\n        return this.visualType;\n    },\n\n    // get a reactive model for type\n    getModel (type) {\n        if (!type) type = this.visualType;\n        var model = this.model[type];\n        if (!model && type in globalOptions) {\n            var options = pop(this.options, type),\n                self = this;\n            if (this.visualParent)\n                model = this.visualParent.getModel(type).$child(options);\n            else {\n                model = this.model.$new(globalOptions[type]);\n                model.$update(options);\n            }\n            this.model[type] = model;\n            model.$on(() => self.draw());\n        }\n        return model;\n    },\n\n    dim (size, refSize, minSize, maxSize) {\n        size = Math.max(sizeValue(size, refSize), minSize || 0);\n        if (maxSize) {\n            maxSize = Math.max(maxSize, minSize || 0);\n            size = Math.min(size, maxSize);\n        }\n        return size;\n    },\n\n    pop (container) {\n        if (container) {\n            var idx = container.live.indexOf(this);\n            if (idx > -1) container.live.splice(idx, 1);\n        }\n    }\n}, viewBase);\n\n//\n//  Create a new Visual Constructor\nexport default function (type, proto) {\n    const opts = pop(proto, 'options');\n    if (opts)\n        globalOptions[type] = opts;\n\n    function Visual(element, options, parent, model) {\n        Object.defineProperties(this, {\n            visualType: {\n                get () {\n                    return type;\n                }\n            },\n            isViz: {\n                get () {\n                    return CONTAINERS.indexOf(type) === -1;\n                }\n            }\n        });\n        this.visualParent = parent;\n        this.model = parent ? parent.model.$new() : (model || viewModel());\n        this.options = options || {};\n        visuals.events.call('before-init', undefined, this);\n        this.initialise(element);\n        visuals.events.call('after-init', undefined, this);\n    }\n\n    Visual.prototype = assign({}, visualPrototype, proto);\n    visuals.types[type] = Visual;\n    return Visual;\n}\n","import {pop, inBrowser} from 'd3-let';\nimport {select} from 'd3-selection';\nimport {viewDebug} from 'd3-view';\n\nimport createVisual, {visuals} from './base';\nimport warn from '../utils/warn';\nimport {getSize} from '../utils/size';\n\n//\n//  Visual\n//  =============\n//\n//  A Visual is a a container of visual layers and it is\n//  associated with an HTML element\n//\n//  Usually a Visual contains one layer only, however it is possible to\n//  have more than one by combining several layers together. Importantly,\n//  layers in one visual generate HTMLElements which are children of the visual\n//  element and inherit both the width and height.\n//\n//  A visual register itself with the visuals.live array\n//\nexport default createVisual('visual', {\n\n    options: {\n        render: 'svg',\n        // width set by the parent element\n        width: null,\n        // height set as percentage of width\n        height: '70%',\n        // heightElement - selector for an element from wich to obtain height\n        heightElement: null\n    },\n\n    initialise (element) {\n        if (!element) throw new Error('HTMLElement required by visual group');\n        if (this.visualParent && this.visualParent.visualType !== 'container')\n            throw new Error('Visual parent can be a container only');\n        if (!this.select(element).select('.paper').node())\n            this.select(element).append('div').classed('paper', true);\n\n        Object.defineProperties(this, {\n            element : {\n                get () {\n                    return element;\n                }\n            },\n            paper : {\n                get () {\n                    return this.sel.select('.paper');\n                }\n            },\n            sel: {\n                get () {\n                    return select(element);\n                }\n            },\n            size: {\n                get () {\n                    return [this.width, this.height];\n                }\n            }\n        });\n\n        this.sel.classed('d3-visual', true);\n        // list of layers which define the visual\n        this.layers = [];\n        this.drawCount = 0;\n        visuals.live.push(this);\n        element.__visual__ = this;\n        if (this.visualParent) this.visualParent.live.push(this);\n    },\n\n    toString () {\n        return `visual ${this.model.uid}`;\n    },\n\n    // Draw the visual\n    draw() {\n        if (!this.drawCount) {\n            this.drawCount = 1;\n            this.fit();\n        } else {\n            this.drawCount++;\n            this.clear();\n        }\n        visuals.events.call('before-draw', undefined, this);\n        this.layers.forEach(visual => {\n            try {\n                visual.draw();\n            } catch (e) {\n                warn(`Could not draw ${visual.toString()}: ${e}`);\n            }\n        });\n        visuals.events.call('after-draw', undefined, this);\n    },\n\n    clear () {},\n\n    // Add a new visual to this group\n    addVisual (options) {\n        var type = pop(options, 'type');\n        var VisualClass = visuals.types[type];\n        if (!VisualClass)\n            warn(`Cannot add visual ${options.type}`);\n        else\n            return new VisualClass(this.element, options, this);\n    },\n    //\n    // Fit the root element to the size of the parent element\n    fit () {\n        this.resize(null, true);\n    },\n\n    resize (size, fit) {\n        if (!size) size = getSize(this.element.parentNode || this.element, this.getModel());\n        var currentSize = this.size;\n\n        if (fit || (currentSize[0] !== size.width || currentSize[1] !== size.height)) {\n            if (!fit) viewDebug(`Resizing \"${this.toString()}\"`);\n            this.width = size.width;\n            this.height = size.height;\n            this.paper.style('width', this.width + 'px').style('height', this.height + 'px');\n            if (!fit) this.draw();\n        }\n    },\n\n    destroy () {\n        this.pop(this.visualParent);\n        this.pop(visuals);\n    }\n});\n\n\nif (inBrowser) {\n    // DOM observer\n    // Check for changes in the DOM that leads to visual actions\n    const observer = new MutationObserver(visualManager);\n    observer.observe(document.documentElement, {\n        childList: true,\n        subtree: true\n    });\n}\n\n//\n//  Clears visualisation going out of scope\nfunction visualManager (records) {\n    records.forEach(record => {\n        var nodes = record.removedNodes;\n        if (!nodes || !nodes.length) return;  // phantomJs hack\n        nodes.forEach(node => {\n            if (node.nodeName !== '#text') {\n                if (!node.__visual__)\n                    select(node).selectAll('.d3-visual').each(destroy);\n                else\n                    destroy.call(node);\n            }\n        });\n    });\n}\n\n\nfunction destroy () {\n    var viz = this.__visual__;\n    if (viz) {\n        viz.destroy();\n        viewDebug(`Removed \"${viz.toString()}\" from DOM, ${visuals.live.length} live visuals left`);\n    }\n    else warn('d3-visual without __visual__ object');\n}\n","export default function (o, prefix, name, objectOnly) {\n    if (name.substring(0, prefix.length) !== prefix)\n        name = `${prefix}${name[0].toUpperCase()}${name.substring(1)}`;\n    return objectOnly ? o[name] : o[name]();\n}\n","import assign from 'object-assign';\nimport {isFunction} from 'd3-let';\nimport * as d3_scale from 'd3-scale';\n\nimport createVisual, {visuals} from './base';\nimport Visual from './visual';\nimport camelFunction from '../utils/camelfunction';\n\n//\n//  crateChart\n//\n//  A chart is a drawing of series data in two dimensional\nexport default function (type) {\n    var protos = [{}, vizPrototype, chartPrototype];\n    for (var i=1; i<arguments.length; ++i) protos.push(arguments[i]);\n    return createVisual(type, assign.apply(undefined, protos));\n}\n\n\n//  Viz Prototype\n//  =================\nexport const vizPrototype = {\n\n    initialise (element) {\n        // No visual parent, create the visual\n        var visual = this.visualParent;\n        if (!visual) {\n            this.visualParent = visual = new Visual(element, this.options, null, this.model);\n            this.model = visual.model.$new();\n            this.options = {};\n        } else if (visual.visualType !== 'visual')\n            throw new Error(`visual parent of ${this.visualType} can only be \"visual\"`);\n        visual.layers.push(this);\n    },\n\n    //\n    // paper object for this visualisation\n    paper () {\n        var visual = this.getModel('visual'),\n            paper = this._paper;\n        if (paper && paper.paperType === visual.render) return paper;\n        var PaperType = visuals.papers[visual.render];\n        if (!PaperType) throw new Error(`Unknown paper ${visual.render}`);\n        paper = new PaperType(this);\n        this._paper = paper;\n        return paper;\n    },\n\n    translate (x, y) {\n        if (isFunction(x)) {\n            return function (d) {\n                var xt = x(d) || 0,\n                    yt = y(d) || 0;\n                return `translate(${xt}, ${yt})`;\n            };\n        } else return `translate(${x}, ${y})`;\n    },\n\n    getScale (name) {\n        return camelFunction(d3_scale, 'scale', name);\n    },\n\n    displayError () {}\n};\n\n\nexport const chartPrototype = {\n\n    //  override draw method\n    draw () {\n        visuals.events.call('before-draw', undefined, this);\n\n        this.getData().then(frame => {\n            if (frame) {\n                this.doDraw(frame);\n                visuals.events.call('after-draw', undefined, this);\n            }\n        }, err => {\n            this.displayError(err);\n        });\n    }\n};\n","import assign from 'object-assign';\nimport {select} from 'd3-selection';\n\nimport {visuals} from './base';\n\n\nexport default function createPaper (type, proto) {\n\n    function Paper (viz) {\n        var element = this.initialise(viz);\n        Object.defineProperties(this, {\n            element: {\n                get () {\n                    return element;\n                }\n            },\n            sel: {\n                get () {\n                    return select(element);\n                }\n            },\n            paperType: {\n                get () {\n                    return type;\n                }\n            }\n        });\n    }\n\n    Paper.prototype = assign({}, paperPrototype, proto);\n\n    visuals.papers[type] = Paper;\n    return Paper;\n}\n\n\nconst paperPrototype = {\n\n    initialise () {},\n    transition () {},\n    size (box) {\n        this.sel\n            .attr('width', box.width)\n            .attr('height', box.height);\n        return this;\n    },\n\n    group (cname) {\n        if (!cname) cname = 'main';\n        var sel = this.sel;\n        sel\n            .selectAll(`.${cname}`)\n            .data([0]).enter()\n            .append('g').classed(cname, true);\n        return sel.select(`.${cname}`);\n    },\n\n    dim (value) {\n        return value;\n    }\n};\n\n\nexport const Svg = createPaper('svg', {\n\n    initialise (viz) {\n        var svg = viz.visualParent.paper.append('svg')\n            .attr('id', viz.model.uid)\n            .classed(viz.visualType, true);\n        return svg.node();\n    }\n});\n","//\n//  Add a menu buttom to a visual\n\nimport globalOptions from '../core/options';\nimport {visuals} from '../core/base';\n\n\nglobalOptions.menu = {\n    display: false,\n    height: '8%',\n    maxHeight: 50,\n    minHeight: 20\n};\n\n\nvisuals.events.on('after-init.menu', viz => {\n    if (viz.visualType === 'visual') {\n        var menu = viz.getModel('menu');\n        if (menu.display) {\n            viz.menu = viz.sel.insert('nav', ':first-child').classed('d3-nav navbar p-1', true);\n            viz.menu.append('h4').classed('title', true);\n        }\n    }\n});\n\nvisuals.events.on('before-draw.menu', viz => {\n    if (viz && viz.menu) {\n        refreshMenu(viz);\n    }\n});\n\n\nfunction refreshMenu(viz) {\n    var menu = viz.getModel('menu'),\n        height = viz.dim(menu.height, viz.height, menu.minHeight, menu.maxHeight);\n    viz.menu.style('height', `${height}px`);\n}\n","import {format} from 'd3-format';\nimport {map} from 'd3-collection';\n\nconst formats = map();\n\nexport default function (specifier, value) {\n    var fmt = formats.get(specifier);\n    if (!fmt) {\n        fmt = format(specifier);\n        formats.set(specifier, fmt);\n    }\n    return fmt(value);\n}\n","//\n//  dataStore integration with visuals\nimport {isString, pop} from 'd3-let';\nimport {resolvedPromise} from 'd3-view';\n\nimport {visuals} from '../core/base';\nimport DataStore from '../data/store';\nimport {vizPrototype} from '../core/chart';\nimport warn from '../utils/warn';\nimport cachedFormat from '../utils/format';\n\n//\n// Visual Data Context\nvisuals.options.dataContext = {\n    $format: cachedFormat\n};\n\n//  getData method\n//  =====================\n//\n//  Inject a method for easily retrieving data from the datastore\nvizPrototype.getData = function () {\n    var name = this.model.data;\n    if (!name) {\n        warn(`Visual ${this.visualType} without data name, cannot get data`);\n        return resolvedPromise();\n    }\n    return this.dataStore.getData(name);\n};\n\n//\n// Context for expression evaluation\nvizPrototype.getContext = function (context) {\n    return this.dataStore.model.$child(context);\n};\n\n\nvisuals.events.on('before-init.data', viz => {\n    if (!viz.isViz) return;\n    // remove data from options\n    viz.data = pop(viz.options, 'data');\n});\n\n\nvisuals.events.on('after-init.data', viz => {\n    Object.defineProperties(viz, {\n        dataStore : {\n            get () {\n                if (viz.visualParent) return viz.visualParent.dataStore;\n                return viz.model.dataStore;\n            }\n        },\n    });\n    if (viz.isViz) setupLayer(viz);\n    else setupVisual(viz);\n});\n\n\nfunction setupVisual (visual) {\n    var store = visual.dataStore,\n        data = pop(visual.options, 'data');\n    //\n    if (!store) {\n        // create the data store for the visual or container\n        store = new DataStore(visual.getModel('dataContext'));\n        visual.model.dataStore = store;\n    }\n    store.addSources(data);\n}\n\n\nfunction setupLayer (layer) {\n    var store = layer.dataStore,\n        data = pop(layer, 'data');\n    if (!data) return;\n    if (isString(data)) data = {source: data};\n    if (!data.name) data.name = layer.model.uid;\n    data = store.addSources(data);\n    if (data)\n        layer.model.$set('data', data.name);\n    else\n        warn(`Could not create data source ${data.name}`);\n}\n","import {inBrowser} from 'd3-let';\nimport {viewDebounce} from 'd3-view';\nimport {select} from 'd3-selection';\n\nimport {visuals} from '../core/base';\nimport globalOptions from '../core/options';\n\n\nif (!globalOptions.resizeDelay)\n    globalOptions.resizeDelay = 200;\n\n\nif (inBrowser) {\n    var resize = viewDebounce(() => {\n        visuals.live.forEach(p => p.resize());\n    }, globalOptions.resizeDelay);\n\n    select(window).on('resize.visuals', resize);\n}\n","// Title plot annotation\nimport {isString} from 'd3-let';\n\nimport {visuals} from '../core/base';\nimport globalOptions from '../core/options';\n\n\nglobalOptions.title = {\n    text: null,\n    fontSize: '5%',\n    minFontSize: 15,\n    maxFontSize: 25\n};\n\n\nvisuals.events.on('before-init.title', viz => {\n    var title = viz.options.title;\n    if (isString(title)) viz.options.title = {text: title};\n});\n\n\nvisuals.events.on('before-draw.title', viz => {\n    var title = viz.getModel('title');\n    if (!title.text) return;\n    var visual = viz.isViz ? viz.visualParent : viz;\n    if (visual.visualType === 'visual' && visual.menu) menuTitle(visual, title, viz);\n});\n\n\nfunction menuTitle(visual, title, viz) {\n    var height = number(visual.menu.style('height')),\n        maxSize = title.maxFontSize ? Math.min(height-4, title.maxFontSize) : height-4,\n        size = viz.dim(title.fontSize, visual.width, title.minFontSize, maxSize);\n    visual.menu.select('.title')\n        .html(title.text)\n        .style('font-size', `${size}px`)\n        .style('line-height', `${height}px`);\n}\n\n\nfunction number (px) {\n    return +px.substring(0, px.length-2);\n}\n","import {isObject} from 'd3-let';\n\nimport globalOptions from '../core/options';\nimport {visuals} from '../core/base';\nimport {vizPrototype} from '../core/chart';\nimport {sizeValue} from '../utils/size';\n\n\nconst KEYS = ['top', 'bottom', 'left', 'right'];\nconst LEFTRIGHT = ['left', 'right'];\n\n\n// margin for visual marks\nglobalOptions.margin = {\n    top: 20,\n    bottom: 20,\n    left: 20,\n    right: 20\n};\n// padding for the visual paper\nglobalOptions.padding = {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0\n};\n\n\n//\n//  Bounding box for a viz\n//  ==========================\nvizPrototype.boundingBox = function () {\n    var width = this.visualParent.width,\n        height = this.visualParent.height,\n        margin = calculate(this.getModel('margin'), width, height),\n        padding = calculate(this.getModel('padding'), width, height),\n        total = KEYS.reduce((o, key) => {\n            o[key] = margin[key] + padding[key];\n            return o;\n        }, {});\n    return {\n        width: width,\n        height: height,\n        margin: margin,\n        padding: margin,\n        total: total,\n        innerWidth: width - total.left - total.right,\n        innerHeight: height - total.top - total.bottom\n    };\n};\n\n\nvisuals.events.on('after-init.margin', viz => {\n    viz.margin = margins('margin', viz);\n    viz.padding = margins('padding', viz);\n});\n\n\nfunction margins (name, viz) {\n    var value = viz.options[name];\n\n    if (value !== undefined && !isObject(value)) {\n        var v = value || 0;\n        viz.options[name] = {\n            left: v,\n            right: v,\n            top: v,\n            bottom: v\n        };\n    }\n}\n\n\nfunction calculate (model, width, height) {\n    return KEYS.reduce((o, key) => {\n        o[key] = sizeValue(model[key], LEFTRIGHT.indexOf(key) > -1 ? width : height);\n        return o;\n    }, {});\n}\n","import {map} from 'd3-collection';\nimport {axisTop, axisBottom, axisLeft, axisRight} from 'd3-axis';\n\nimport globalOptions from '../core/options';\nimport {vizPrototype} from '../core/chart';\n\n\nconst axisOrientation = map({\n    top: axisTop,\n    bottom: axisBottom,\n    left: axisLeft,\n    right: axisRight\n});\n\nglobalOptions.xAxis = {\n    location: \"bottom\"\n};\n\nvizPrototype.axis = function (orientation, scale) {\n    return axisOrientation.get(orientation)(scale);\n};\n","import {map} from 'd3-collection';\nimport {range} from 'd3-array';\nimport {isObject} from 'd3-let';\nimport {\n    scaleSequential,\n    interpolateViridis, interpolateInferno, interpolateMagma,\n    interpolatePlasma, interpolateWarm, interpolateCool,\n    interpolateRainbow, interpolateCubehelixDefault\n} from 'd3-scale';\nimport globalOptions from '../core/options';\nimport {vizPrototype} from '../core/chart';\n\nexport const colorScales = map();\n\n\nglobalOptions.color = {\n    scale: 'cool',\n    scaleMinPoints: 6,\n    stroke: '#333',\n    strokeOpacity: 1,\n    fillOpacity: 1\n};\n\ncolorScales.set('viridis', () =>  scaleSequential(interpolateViridis));\ncolorScales.set('inferno', () =>  scaleSequential(interpolateInferno));\ncolorScales.set('magma', () =>  scaleSequential(interpolateMagma));\ncolorScales.set('plasma', () =>  scaleSequential(interpolatePlasma));\ncolorScales.set('warm', () =>  scaleSequential(interpolateWarm));\ncolorScales.set('cool', () =>  scaleSequential(interpolateCool));\ncolorScales.set('rainbow', () =>  scaleSequential(interpolateRainbow));\ncolorScales.set('cubehelix', () =>  scaleSequential(interpolateCubehelixDefault));\n\n//\n//  Color scale method\n//  ==========================\nvizPrototype.colors = function (n) {\n    var color = this.getModel('color'),\n        scaleDef = colorScales.get(color.scale);\n\n    if (!scaleDef) throw new Error(`Unknown scale ${color.scale}`);\n    if (!isObject(scaleDef)) scaleDef = {scale: scaleDef};\n    if (scaleDef.minPoints === undefined) scaleDef.minPoints = color.scaleMinPoints;\n\n    var points = Math.max(n, scaleDef.minPoints),\n        domain = scaleDef.reversed ? [points-1, 0] : [0, points-1],\n        scale = scaleDef.scale().domain(domain);\n    return range(0, Math.min(n, points)).map(v => scale(v));\n};\n","import {legendColor, legendSize, legendSymbol} from 'd3-svg-legend';\nimport {map} from 'd3-collection';\n\nimport globalOptions from '../core/options';\nimport {vizPrototype} from '../core/chart';\nimport warn from '../utils/warn';\n\n\nglobalOptions.legend = {\n    location: \"top-right\",\n    orient: \"vertical\",\n    fontSize: '3%',\n    title: '',\n    titleWidth: \"20%\",\n    titleMinWidth: 30,\n    titleMaxWidth: 60,\n    minFontSize: 10,\n    maxFontSize: 20,\n    offsetX: 10,\n    offsetY: 10\n};\n\n\nconst legends = {\n    color: legendColor,\n    size: legendSize,\n    symbol: legendSymbol\n};\n\n\n//\n//  Legend method\n//  ==========================\nvizPrototype.legend = function (cfg, box) {\n    var vizModel = this.getModel(),\n        lgModel = this.getModel('legend'),\n        name = vizModel.legendType,\n        size = this.dim(lgModel.fontSize, box.height, lgModel.minFontSize, lgModel.maxFontSize);\n    if (!name) return;\n    var legend = legends[name];\n    if (!legend) return warn(`Could not load legend ${name}`);\n    legend = legend().orient(lgModel.orient);\n    if (lgModel.title) {\n        var width = this.dim(lgModel.titleWidth, box.width, lgModel.titleMinWidth, lgModel.titleMaxWidth);\n        legend.title(lgModel.title).titleWidth(width);\n    }\n    for (let key in cfg) legend[key](cfg[key]);\n    var g = this.paper()\n            .group('legend')\n            .style('font-size', `${size}px`)\n            .call(legend),\n        bb = locations.get(lgModel.location)(g.node().getBBox(), box, lgModel);\n    g.attr('transform', this.translate(bb.x, bb.y));\n};\n\n\nconst locations = map({\n    top,\n    bottom,\n    right,\n    left,\n    'top-left': topLeft,\n    'top-right': topRight,\n    'bottom-left': bottomLeft,\n    'bottom-right': bottomRight\n});\n\n\nfunction top (bb, box, options) {\n    return {\n        x: box.total.left + (box.innerWidth - bb.width)/2,\n        y: options.offsetY\n    };\n}\n\n\nfunction bottom (bb, box, options) {\n    return {\n        x: box.total.left + (box.innerWidth - bb.width)/2,\n        y: box.height - bb.height - options.offsetY\n    };\n}\n\n\nfunction right (bb, box, options) {\n    return {\n        x: box.width - bb.width - options.offsetX,\n        y: options.offsetY\n    };\n}\n\n\nfunction left (bb, box, options) {\n    return {\n        x: box.total.left + (box.innerWidth - bb.width)/2,\n        y: options.offsetY\n    };\n}\n\n\nfunction topLeft (bb, box, options) {\n    return {\n        x: box.total.left + (box.innerWidth - bb.width)/2,\n        y: options.offsetY\n    };\n}\n\n\nfunction topRight (bb, box, options) {\n    return {\n        x: box.width - bb.width - options.offsetX,\n        y: options.offsetY\n    };\n}\n\n\nfunction bottomLeft (bb, box, options) {\n    return {\n        x: box.total.left + (box.innerWidth - bb.width)/2,\n        y: box.height - bb.height - options.offsetY\n    };\n}\n\n\nfunction bottomRight (bb, box, options) {\n    return {\n        x: box.width - bb.width - options.offsetX,\n        y: box.height - bb.height - options.offsetY\n    };\n}\n","//\n// Use clusterize.js to render the table\nexport default function (table, options) {\n    return table.require('clusterize.js@0.17.6').then(Clusterize => clusterize(Clusterize, table, options));\n}\n\n\nfunction clusterize(Clusterize) {\n    var cl = new Clusterize();\n    return cl;\n}\n","export default function (table) {\n    return table;\n}\n","//\n//  bootstrap styling for tabular component\n//  ==========================================\n//\nimport assign from 'object-assign';\n\n\nconst defaults = {\n    over: true,\n    small: true,\n    bordered: true,\n    loadingClass: 'table-info',\n    loadingTextClass: 'text-center'\n};\n\n\nexport default function (table, options) {\n    var style = table.model.style;\n    style.$update(assign({}, defaults, options));\n\n    style.tableClass = 'table table-responsive';\n    if (style.striped) style.tableClass += ' table-striped';\n    if (style.over) style.tableClass += ' table-hover';\n    if (style.bordered) style.tableClass += ' table-bordered';\n    if (style.small) style.tableClass += ' table-sm';\n}\n","//\n//  Plugins for visuals and tabular\n//\n// visual plugins\nimport './menu';\nimport './data';\nimport './responsive';\nimport './title';\nimport './margin';\nimport './axis';\nimport './color';\nimport './legend';\n//\n//  This module depends on core but not on components\nimport clusterize from './clusterize';\nimport paginate from './paginate';\nimport bootstrap from './bootstrap';\n\n// plugins add functionalities to a d3 table\n// A plugin is a function accepting two parameters:\n//  * the table component\n//  * object with configuration parameters\nexport default {\n    bootstrap,\n    clusterize,\n    paginate\n};\n","import createVisual, {visuals} from './base';\n\n\nexport default createVisual('container', {\n\n    initialise () {\n        this.live = [];\n        if (this.visualParent) this.visualParent.live.push(this);\n    },\n\n    draw() {\n        visuals.events.call('before-draw', undefined, this);\n        this.live.forEach(visual => {\n            visual.draw();\n        });\n        visuals.events.call('after-draw', undefined, this);\n    },\n\n    destroy () {\n        this.pop(this.visualParent);\n    }\n});\n","import assign from 'object-assign';\nimport {isString, isObject} from 'd3-let';\n\nimport VisualContainer from '../core/container';\n\n//\n//  vizComponent base prototype\n//  =============================\n//\n//  Some common properties and methods for all visualize components\n//\nexport const vizComponent = {\n    props: [\n        'schema',\t    // Schema is a collection of fields to display in the table\n        'datasource',\t// Data source\n        'plugins',      // list of string/objects\n\t],\n\n    render (props, attrs, el) {\n        var self = this,\n            inner = this.select(el).html();\n        //\n        // build\n        return this.getSchema(props.schema, schema => {\n            if (!isObject(schema)) schema = {};\n            return self.build(schema, inner, attrs);\n        });\n    },\n\n    // get the schema from the input schema property\n    getSchema (input, build) {\n        var parent = this.model.visual;\n\n        // allow to specify the schema as an entry of\n        // visuals object in the dashboard schema\n        if (parent && parent !== this.model && isString(input)) {\n            var schema = parent.options.visuals[input];\n            if (schema) input = schema;\n        }\n\n        if (isString(input)) {\n            return this.json(input).then(build);\n        }\n        else return build(input);\n    },\n    //\n    // build the visual component has the schema available\n    build () {}\n};\n//\n//  Dashboard Component\n//  ========================\n//\n//  A collection of visual components arranged according\n//  to a custom layout.\n//\n//  * Dashboard visuals are independent of each other but\n//    interact via the data object\n//  * The Dashboard layout is given by the inner HTML elements\n//  * The configuration is obtained via the schema property which\n//    can be either:\n//      1) an object\n//      2) a url\nexport default assign({}, vizComponent, {\n\n    build (schema, inner, attrs) {\n        var model = this.model,\n            sel = this.createElement('div'),\n            root = model.root;\n        if (attrs.class) sel.attr('class', attrs.class);\n        if (!schema.visuals) schema.visuals = {};\n        model.visual = new VisualContainer(sel.node(), schema, model.visual);\n        if (!root.visualDashboard) root.visualDashboard = model.visual;\n        return this.mountInner(sel, inner);\n    }\n});\n","import assign from 'object-assign';\nimport {pop} from 'd3-let';\n\nimport {vizComponent} from './dashboard';\nimport Visual from '../core/visual';\n\n\n//\n//  Visual component\n//  ======================\n//\n//  An element containing a visualization\nexport default assign({}, vizComponent, {\n\n    build (schema) {\n        var sel = this.createElement('div'),\n            type = schema.type || 'visual',\n            model = this.model,\n            options = {},\n            layers;\n\n        if (type === 'visual') {\n            layers = pop(schema, 'layers');\n            options = schema;\n        }\n        else\n            options.visual = pop(schema, 'visual') || {};\n\n        model.visual = new Visual(sel.node(), options, model.visual);\n        if (type !== 'visual') model.visual.addVisual(schema);\n        else if (layers) {\n            layers.forEach(layer => model.visual.addVisual(layer));\n        }\n        return sel;\n    },\n\n    // once the element is mounted in the dom, draw the visual\n    mounted () {\n        this.model.visual.draw();\n    }\n});\n","import {isoParse} from 'd3-time-format';\n\nimport locale from './locale';\n\n\nexport const parsers = {\n    date: isoParse,\n\n    string (value) {\n        return ''+value;\n    }\n};\n\n// formatters\nexport const formatters = {\n\n    number (value) {\n        return value;\n    },\n\n    date (value) {\n        return locale.formatDate(value);\n    },\n\n    boolean (value) {\n        return value;\n    }\n};\n","import {isObject, isArray} from 'd3-let';\n\nimport {formatters, parsers} from '../data/formatters';\n\n\n//\n// Create table columns from schema\nexport default function (schema) {\n    var columns = [];\n    let col;\n\n\tif (!schema) return columns;\n\n    if (isArray(schema))\n        schema = {properties: schema};\n\n    if (isObject(schema.properties)) {\n        for (let key in schema.properties) {\n            col = schema.properties[key];\n            if (isObject(col)) {\n                if (!col.name) col.name = key;\n                columns.push(col);\n            }\n        }\n    } else\n        Array.prototype.push.apply(columns, schema.properties);\n\n    return columns.map((col) => {\n        if (!isObject(col)) col = {name: col};\n        if (!col.label) col.label = col.name;\n        if (!col.hidden) col.hidden = false;\n        if (!col.$parse) col.$parse = parsers[col.type] || parsers.string;\n        if (!col.$html) col.$html = formatters[col.type] || $html;\n        return col;\n    });\n}\n\n\nfunction $html (value) {\n    return value;\n}\n","// import {timeout} from 'd3-timer';\nimport assign from 'object-assign';\nimport {isString, isArray, isPromise} from 'd3-let';\n\nimport warn from '../utils/warn';\nimport createColumns from '../utils/columns';\nimport tablePlugins from '../plugins/index';\nimport {vizComponent} from './dashboard';\n\n\nconst tableTpl = `<table d3-class=\"[style.tableClass, loadingData ? 'loading' : null]\">\n<thead d3-class=\"style.headerClass\">\n<tr d3-class=\"style.headerRowClass\">\n  <th d3-for=\"col in columns\"\n        d3-html=\"col.label\"\n        d3-if=\"!col.hidden\">\n  </th>\n</tr>\n<tr d3-if=\"loadingData\" d3-class=\"style.loadingClass\">\n    <td d3-attr-colspan=\"columns.length\">\n        <p d3-class=\"style.loadingTextClass\">loading data</p>\n    </td>\n</tr>\n</thead>\n<tbody></tbody>\n</table>`;\n\n\nexport default assign({}, vizComponent, {\n\n\tmodel () {\n        return {\n            header: true,            // show header\n            columns: [],             // table columns\n            loadingData: false,\n            style: {\n                tableClass: null,\n                headerClass: null,\n                headerRowClass: null,\n                loadingClass: 'loading',\n                loadingTextClass: null\n            }\n        };\n\t},\n\n\tbuild (schema) {\n\t\tvar self = this,\n            model = this.model,\n            plugins = schema.plugins || [];\n        // model.allData = crossfilter([]);\n        this.records = {};\n        this.data = [];\n        this.template = tableTpl;\n\n\t\tmodel.columns = createColumns(schema);\n\t\t// if (data.dataurl) model.dataLoader = new DataLoader(data.dataurl);\n\n        if (!isArray(plugins)) {\n            warn('plugins should be an array');\n        } else {\n            var promises = [];\n            let promise;\n            plugins.forEach(plugin => {\n                if (isString(plugin)) plugin = {name: plugin};\n                if (!tablePlugins[plugin.name])\n                    warn(`Unknown table plugin ${plugin.name}`);\n                else {\n                    promise = tablePlugins[plugin.name](self, plugin);\n                    if (isPromise(promise)) promises.push(promise);\n                }\n            });\n            if (promises.length)\n                 return Promise.all(promises).then(() => self.viewElement(self.template));\n        }\n\n\t\treturn this.viewElement(this.template);\n\t},\n\n\tmounted () {\n        var vm = this,\n            model = this.model;\n\t\tif (model.dataLoader) {\n\t\t\tvar p = model.dataLoader.load(model.columns);\n            if (p) {\n                model.loadingData = true;\n                p.then((data) => {\n                    // var allData = model.allData;\n                    model.loadingData = false;\n                    addData(vm, data);\n                }, (err) => {\n                    model.loadingData = false;\n                    return err;\n                });\n            }\n        }\n\t}\n});\n\n// new data to include in the table\nfunction addData (vm, newData) {\n    var records = vm.records,\n        data = vm.data,\n        model = vm.model,\n        delayData = newData;\n\n    let record, value;\n\n    newData = delayData.splice(0, 100);\n\n    newData.forEach((d) => {\n        if (d.id) {\n            record = d.id ? records[d.id] : null;\n            if (record)\n                d = assign(record, d);\n            else {\n                data.push(d);\n                records[d.id] = d;\n            }\n        } else\n            data.push(d);\n        model.columns.forEach((col) => {\n            d[col.name] = col.$parse(d[col.name]);\n        });\n    });\n\n    //if (delayData.length)\n    //    timeout(() => addData(vm, delayData));\n\n    var rows = vm.sel.select('tbody')\n                .selectAll('tr').data(data);\n\n    rows\n        .enter()\n            .append('tr')\n            .attr('scope', 'row')\n            .selectAll('td')\n            .data(model.columns)\n            .enter()\n                .append('td')\n                .style('display', (col) => {\n                    return col.hidden ? 'none' : null;\n                })\n                .html(function (col) {\n                    record = this.parentNode.__data__;\n                    value = record[col.name];\n                    return col.$html(value === undefined ? '' : value);\n                });\n}\n","//\n//  d3-view components\n//  ======================\n//\n//  d3-view plugin for visualization components\n//\nimport tabularPlugins from '../plugins/index';\nimport dashboard from './dashboard';\nimport visual from './visual';\nimport tabular from './tabular';\n\n\n// Visual components plugin\nexport default {\n    tabularPlugins,\n\n    install (vm) {\n        vm.addComponent('dashboard', dashboard);\n        vm.addComponent('visual', visual);\n        vm.addComponent('tabular', tabular);\n    }\n\n};\n","export default function (x) {\n    return function constant() {\n        return x;\n    };\n}\n","export default function (a, b) {\n  return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n}\n","export default function (d) {\n    return d;\n}\n","import constant from \"../utils/constant\";\nimport descending from \"../utils/descending\";\nimport identity from \"../utils/identity\";\n\n//\n//  Pyramid Shape generator\n//  ============================\nexport default function () {\n    var value = identity,\n        pad = constant(0),\n        height = 1,\n        base = 1;\n\n    function pyramid (data) {\n        let i, j, k, points, fraction,\n            hi, x, y, v0, ph, pj;\n        var n = data.length,\n            r = 0.5*base/height,\n            polygons = new Array(n),\n            index = new Array(n);\n\n        for (i=0; i<n; ++i) {\n            polygons[index[i] = i] = +value(data[i], i, data);\n        }\n\n        // Sort the polygons\n        index.sort((i, j) => {return descending(polygons[i], polygons[j]);});\n\n        // Compute the polygons! They are stored in the original data's order.\n        v0 = polygons[index[0]];\n        hi = null;\n\n        for (i=n-1; i>=0; --i) {\n            points = [];\n            if (hi === null)\n                points.push([0, 0]);\n            else {\n                y = hi + ph;\n                x = y*r;\n                points.push([x, y]);\n                points.push([-x, y]);\n            }\n            j = index[i];\n            k = n - i - 1;\n            fraction = polygons[j]/v0;\n            pj = Math.sqrt(fraction);\n            hi = height*pj;\n            ph = i ? pad(pj, k) : 0;\n            y = hi - ph;\n            x = y*r;\n            points.push([-x, y]);\n            points.push([x, y]);\n            polygons[j] = {\n                index: k,\n                value: polygons[j],\n                fraction: fraction,\n                points: points,\n                data: data[j]\n            };\n        }\n        return polygons;\n    }\n\n    pyramid.value = function(_) {\n        return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), pyramid) : value;\n    };\n\n    pyramid.base = function (_) {\n        return arguments.length ? (base = _, pyramid) : base;\n    };\n\n    pyramid.height = function (_) {\n        return arguments.length ? (height = _, pyramid) : height;\n    };\n\n    pyramid.pad = function(_) {\n        return arguments.length ? (pad = typeof _ === \"function\" ? _ : constant(+_), pyramid) : pad;\n    };\n\n    return pyramid;\n}\n","import * as d3_shape from 'd3-shape';\nimport {extent} from 'd3-array';\n\nimport createChart from '../core/chart';\nimport warn from '../utils/warn';\nimport accessor from '../utils/accessor';\nimport camelFunction from '../utils/camelfunction';\n\n\nexport const lineDrawing = {\n\n    fill (data) {\n        var colors = this.colors(data.length);\n\n        function fill (d, index) {\n            return colors[index];\n        }\n\n        fill.colors = colors;\n\n        return fill;\n    },\n\n    curve (name) {\n        var obj = camelFunction(d3_shape, 'curve', name, true);\n        if (!obj) {\n            warn(`Could not locate curve type \"${name}\"`);\n            obj = camelFunction(d3_shape, 'curve', 'cardinalOpen', true);\n        }\n        return obj;\n    },\n\n    range (data, x, y, agg) {\n        var range = {\n            x: extent(data, x),\n            y: extent(data, y)\n        };\n        if (agg) {\n            Array.prototype.push.apply(agg.x, range.x);\n            Array.prototype.push.apply(agg.y, range.y);\n        }\n    },\n\n    newRange () {\n        return {\n            x: [],\n            y: []\n        };\n    }\n};\n\n//\n//  Line Chart\n//  =============\n//\n//  The barchart is one of the most flexible visuals.\n//  It can be used to display label data as well as\n//  timeserie data. It can display absulte values as\n//  proportional data via vertical staking and normalization\nexport default createChart('linechart', lineDrawing, {\n\n    options: {\n        lineWidth: 1,\n        curve: 'cardinalOpen',\n        x: 'x',\n        y: 'y',\n        scaleX: 'linear',\n        scaleY: 'linear'\n    },\n\n    doDraw (frame) {\n        var self = this,\n            range = this.newRange(),\n            model = this.getModel(),\n            color = this.getModel('color'),\n            x = accessor(model.x),\n            y = accessor(model.y),\n            data = frame.series.values(),\n            meta = frame.series.keys().map((label, index) => {\n                return {\n                    index: index,\n                    label: label,\n                    range: self.range(data[index], x, y, range)\n                };\n            }),\n            box = this.boundingBox(),\n            paper = this.paper(),\n            lines = paper.size(box).group()\n                .attr(\"transform\", this.translate(box.total.left, box.total.top))\n                .selectAll('.line').data(data),\n            strokeColor = this.fill(meta),\n            //merge = paper.transition('update'),\n            line = d3_shape.line()\n                .x(this.x(box, range.x))\n                .y(this.y(box, range.y))\n                .curve(this.curve(model.curve));\n\n        lines\n            .enter()\n                .append('path')\n                .attr('class', 'line')\n                .attr('fill', 'none')\n                .attr('stroke', strokeColor)\n                .attr('stroke-opacity', 0)\n                .attr('stroke-width', model.lineWidth)\n            .merge(lines)\n                //.transition(merge)\n                .attr('stroke', strokeColor)\n                .attr('stroke-opacity', color.strokeOpacity)\n                .attr('stroke-width', model.lineWidth)\n                .attr('d', line);\n\n        lines\n            .exit()\n            .remove();\n    },\n\n    x (box, ranges) {\n        var model = this.getModel(),\n            scale = this.getScale(model.scaleX)\n                .domain(extent(ranges))\n                .range([0, box.innerWidth]);\n        return function (d) {\n            return scale(d[model.x]);\n        };\n    },\n\n    y (box, ranges) {\n        var model = this.getModel(),\n            scale = this.getScale(model.scaleY)\n                .domain(extent(ranges))\n                .range([box.innerHeight, 0]);\n        return function (d) {\n            return scale(d[model.y]);\n        };\n    }\n});\n","import {stack} from 'd3-shape';\nimport {max} from 'd3-array';\n\nimport createChart from '../core/chart';\nimport {lineDrawing} from './line';\n//\n//  Bar Chart\n//  =============\n//\n//  The barchart is one of the most flexible visuals.\n//  It can be used to display label data as well as\n//  timeserie data. It can display absulte values as\n//  proportional data via vertical staking and normalization\nexport default createChart('barchart', lineDrawing, {\n\n    options: {\n        orientation: 'vertical',\n        // stack multiple y series?\n        sortby: null, // specify \"x\" or \"y\"\n        stack: true,\n        normalize: false,\n        scale: 'linear',\n        padding: 0.1,\n        x: 'x',\n        y: 'y',\n        groupby: null,  // group data by a field for staked or grouped bar chart\n        //\n        // legend & tooltip\n        valueformat: '.1f',\n        legendType: 'color',\n        legendLabel: 'label'\n    },\n\n    doDraw (frame) {\n        var model = this.getModel(),\n            color = this.getModel('color'),\n            data = frame.data,\n            box = this.boundingBox(),\n            paper = this.paper().size(box),\n            bars = paper.group()\n                .attr(\"transform\", this.translate(box.total.left, box.total.top))\n                .selectAll('.group'),\n            x = model.x,\n            y = model.y,\n            groupby = model.groupby,\n            sx = this.getScale('band'),\n            sy = this.getScale(model.scale),\n            sz = this.getScale('ordinal'),\n            stacked = false,\n            width = null,\n            height = null,\n            xrect = x0,\n            yrect = y0,\n            yi = 1,\n            groups,\n            axis;\n\n        if (model.orientation === 'vertical') {\n            sx.rangeRound([0, box.innerWidth]).paddingInner(model.padding);\n            sy.rangeRound([box.innerHeight, 0]);\n            width = sx.bandwidth;\n            height = bardim;\n        } else {\n            sx.rangeRound([0, box.innerHeight]).paddingInner(model.padding);\n            sy.rangeRound([0, box.innerWidth]);\n            yi = 0;\n            width = bardim;\n            height = sx.bandwidth;\n            xrect = y0;\n            yrect = x0;\n        }\n\n        if (groupby) {\n            groups = frame.dimension(groupby).group().top(Infinity).map(g => g['key']);\n            if (groups.length <= 1) groups = null;\n        }\n\n        if (groups) {\n            frame = frame.pivot(x, groupby, y);\n            if (model.sortby === 'y') frame = frame.sortby('total');\n            data = frame.data;\n            sz.domain(groups).range(this.colors(groups.length));\n            if (model.stack) {\n                if (model.normalize)\n                    this.normalize(frame.data);\n                stacked = true;\n            }\n        }\n\n        // set domain for the labels\n        sx.domain(data.map(d => d[x]));\n\n        if (stacked) {\n            sy.domain([0, max(data, d => d.total)]).nice();\n            data = stack().keys(groups)(data);\n            var rects = bars.data(data)\n                            .enter()\n                                .append('g')\n                                .classed('group', true)\n                                .attr('fill', d => sz(d.key))\n                            .merge(bars)\n                                .attr('fill', d => sz(d.key))\n                                .attr('stroke', color.stroke)\n                                .attr('stroke-opacity', color.strokeOpacity)\n                                .attr('fill-opacity', color.fillOpacity)\n                                .selectAll('rect')\n                                .data(d => d);\n            rects.enter()\n                .append('rect')\n                .merge(rects)\n                    .transition()\n                    .attr('x', xrect)\n                    .attr('y', yrect)\n                    .attr('height', height)\n                    .attr('width', width);\n\n        } else {\n            var x1 = self.getScale('band').padding(0.5*model.padding);\n            return x1;\n        }\n\n        if (model.orientation === 'vertical') {\n            axis = this.axis('bottom', sx).tickSizeOuter(0);\n            paper.group('axis')\n                .attr(\"transform\", this.translate(box.total.left, box.total.top+box.innerHeight))\n                .call(axis);\n        } else {\n            axis = this.axis('left', sx).tickSizeOuter(0);\n            paper.group('axis')\n                .attr(\"transform\", this.translate(box.total.left, box.total.top))\n                .call(axis);\n        }\n\n        if (model.legendType && groups) {\n            this.legend({scale: sz}, box);\n        }\n\n        function bardim (d) {\n            return sy(d[1-yi]) - sy(d[yi]);\n        }\n\n        function x0 (d) {\n            return sx(d.data[x]);\n        }\n\n        function y0 (d) {\n            return sy(d[yi]);\n        }\n    }\n});\n","import {pie, arc} from 'd3-shape';\nimport {scaleOrdinal} from 'd3-scale';\nimport {viewExpression} from 'd3-view';\nimport {format} from 'd3-format';\n\nimport createChart from '../core/chart';\nimport {sizeValue} from '../utils/size';\n\n\nconst pi = Math.PI;\nconst rad = pi/180;\n\n\nexport const proportional = {\n\n    fill (data) {\n        var colors = this.colors(data.length);\n\n        function fill (d, idx) {\n            return colors[idx];\n        }\n\n        fill.colors = colors;\n\n        return fill;\n    },\n\n    proportionalData (frame, field) {\n        return frame.dimension(field).top(Infinity);\n    },\n\n    total (field) {\n        var total = 0;\n\n        function value (d) {\n            total += d[field];\n            return d[field];\n        }\n\n        value.total = () => total;\n        return value;\n    }\n};\n\n//\n//  Pie Chart\n//  =============\n//\nexport default createChart('piechart', proportional, {\n\n    options: {\n        // The data values from this field will be encoded as angular spans.\n        // If omitted, all pie slices will have equal spans\n        field: 'data',\n        label: 'label',\n        startAngle: 0,\n        endAngle: 360,\n        sort: false,\n        innerRadius: 0,\n        padAngle: 0,\n        cornerRadius: 0,\n        lineWidth: 1,\n        //\n        fractionFormat: '.1%',\n        legendType: 'color',\n        legendLabel: \"label + ' - ' + format(fraction)\"\n    },\n\n    doDraw (frame) {\n        var model = this.getModel(),\n            color = this.getModel('color'),\n            field = model.field,\n            box = this.boundingBox(),\n            outerRadius = Math.min(box.innerWidth, box.innerHeight)/2,\n            innerRadius = sizeValue(model.innerRadius, outerRadius),\n            total = this.total(field),\n            angles = pie()\n                .padAngle(rad*model.padAngle)\n                .startAngle(rad*model.startAngle)\n                .endAngle(rad*model.endAngle)\n                .value(total),\n            arcs = arc()\n                .innerRadius(innerRadius)\n                .outerRadius(outerRadius)\n                .cornerRadius(model.cornerRadius),\n            paper = this.paper(),\n            //update = paper.transition('update'),\n            data = angles(this.proportionalData(frame, field)),\n            fill = this.fill(data),\n            slices = paper.size(box).group()\n                .attr(\"transform\", this.translate(box.total.left+box.innerWidth/2, box.total.top+box.innerHeight/2))\n                .selectAll('.slice').data(data);\n\n        slices\n            .enter()\n                .append('path')\n                .attr('class', 'slice')\n                .attr('stroke', color.stroke)\n                .attr('stroke-opacity', 0)\n                .attr('fill-opacity', 0)\n                .attr('fill', fill)\n                .attr('stroke-width', model.lineWidth)\n            .merge(slices)\n                .transition()\n                .attr('stroke', color.stroke)\n                .attr('stroke-opacity', color.strokeOpacity)\n                .attr('d', arcs)\n                .attr('fill', fill)\n                .attr('fill-opacity', color.fillOpacity);\n\n        slices.exit().remove();\n\n        if (!model.legendType) return;\n        total = total.total();\n        var expr = viewExpression(model.legendLabel),\n            fmt = format(model.fractionFormat),\n            labels = data.map((d, idx) => {\n                return expr.eval({\n                    d: d,\n                    value: d.value,\n                    format: fmt,\n                    total: total,\n                    fraction: d.value/total,\n                    label: d.data[model.label] || idx\n                });\n            });\n        this.legend({\n            scale: scaleOrdinal().domain(labels).range(fill.colors)\n        }, box);\n    }\n});\n","//\n//  Custom Symbol type\n//  =====================\n//\n//  Draw a polygon given an array of points\n//  This can be used as type in a d3-shape symbol\nexport default function (points) {\n\n    return {\n        draw (context) {\n            points.forEach((point, idx) => {\n                if (!idx) context.moveTo(point[0], point[1]);\n                else context.lineTo(point[0], point[1]);\n            });\n            context.closePath();\n        }\n    };\n}\n","import {symbol} from 'd3-shape';\nimport {viewExpression} from 'd3-view';\n\nimport createChart from '../core/chart';\nimport pyramid from '../transforms/pyramid';\nimport polygon from '../utils/polygon';\nimport {proportional} from './pie';\n\n\nexport default createChart('pyramidchart', proportional, {\n\n    options: {\n        field: 'data',\n        label: 'label',\n        pad: 0,\n        lineWidth: 1,\n        legendType: 'color',\n        legendLabel: \"label + ' - ' + format('.1%', fraction)\"\n    },\n\n    doDraw (frame) {\n        var model = this.getModel(),\n            field = model.field,\n            color = this.getModel('color'),\n            box = this.boundingBox(),\n            pad = this.dim(model.pad, Math.min(box.innerWidth, box.innerHeight)),\n            polygons = pyramid()\n                .base(box.innerWidth)\n                .height(box.innerHeight)\n                .pad(pad)\n                .value(d => d[field]),\n            data = frame.new(polygons(this.proportionalData(frame, field))).dimension('fraction').bottom(Infinity),\n            marks = symbol().type(d => polygon(d.points)).size(1),\n            fill = this.fill(data),\n            paper = this.paper(),\n            segments = paper.size(box).group()\n                .attr(\"transform\", this.translate(box.total.left+box.innerWidth/2, box.total.top))\n                .selectAll('.segment').data(data);\n\n        segments\n            .enter()\n                .append('path')\n                .attr('class', 'segment')\n                .attr('stroke', color.stroke)\n                .attr('stroke-opacity', 0)\n                .attr('fill-opacity', 0)\n                .attr('fill', fill)\n                .attr('stroke-width', model.lineWidth)\n            .merge(segments)\n                .transition()\n                .attr('stroke', color.stroke)\n                .attr('stroke-opacity', color.strokeOpacity)\n                .attr('d', marks)\n                .attr('fill', fill)\n                .attr('fill-opacity', color.fillOpacity);\n\n        segments.exit().remove();\n\n        if (!model.legendType) return;\n        var expr = viewExpression(model.legendLabel),\n            self = this,\n            labels = data.map((d, idx) => {\n                return expr.eval(self.getContext({\n                    d: d,\n                    value: d.value,\n                    fraction: d.fraction,\n                    label: d.data[model.label] || idx\n                }));\n            });\n        this.legend({\n            scale: this.getScale('ordinal').domain(labels).range(fill.colors)\n        }, box);\n    }\n\n});\n","import createChart from '../core/chart';\n\n//\n//  Treemap\n//  =============\n//\nexport default createChart('treemap', {\n    requires: ['d3-treemap']\n\n});\n","import createChart from '../core/chart';\n\n\nexport default createChart('text', {\n\n    options: {\n        scale: 'linear',\n        field: 'data',\n        label: 'label'\n    },\n\n    doDraw () {\n    }\n});\n","//\nexport {version as visualizeVersion} from './package.json';\n//\nexport {default as randomPath} from './src/utils/randompath';\n//\n// Data layer\nexport {default as DataStore} from './src/data/store';\nexport {default as dataSources} from './src/data/sources';\nexport {default as dataLocale} from './src/data/locale';\n\n//\n//  Core API\nexport {visuals} from './src/core/base';\nexport {default as crateChart} from './src/core/chart';\nexport {default as cratePaper, Svg} from './src/core/paper';\n//\n//  Components\nexport {default as visualComponents} from './src/components/index';\n\n// utilities\nexport {colorScales} from './src/plugins/color';\nexport {default as pyramid} from './src/transforms/pyramid';\n//\n//  Charts\n//  =========\n//\n//  Last import, important!\nexport {default as Visual} from './src/core/visual';\nexport {default as BarChart} from './src/charts/bar';\nexport {default as LineChart} from './src/charts/line';\nexport {default as PieChart} from './src/charts/pie';\nexport {default as PyramidChart} from './src/charts/pyramid';\nexport {default as Treemap} from './src/charts/treemap';\nexport {default as TextChart} from './src/charts/text';\n"],"names":["defaults","size","options","assign","t","range","S","sigma","drift","data","x","y","norm","randomNormal","dx","i","length","config","_data","isArray","isObject","resolvedPromise","asFrame","prefix","msg","logger","warn","schemes","value","isString","indexOf","split","isUrl","url","fetch","viewProviders","self","then","parse","response","ct","headers","get","text","csvParse","json","source","store","frame","Promise","all","map","getData","frames","mergeFrames","expression","viewExpression","model","eval","field","d","DataFrame","serie","defineProperties","dimensions","series","prototype","_inner","cf","crossfilter","name","keepExisting","arguments","current","dispose","accessor","dimension","top","new","Infinity","key","total","group","reduce","pivoter","Object","m","pk","pv","o","record","mapper","filter","a","Array","fill","operations","count","array","v","undefined","fields","ops","as","countAll","fillArray","aggregate","op","forEach","index","push","sortby","groupby","timeseries","dim","groups","newframe","tmp","filterExact","set","globalOptions","dateFormat","converters","entry","utcParse","parseFloat","converter","mapfields","mappers","each","type","applyTransforms","transforms","ts","transform","dataEvents","dispatch","dataSourcePrototype","transformStore","constructor","DataSource","sources","values","cfg","getConfig","initDataSource","dataSource","dataName","pop","initialise","addTransforms","call","dataSources","add","remote","composite","DataStore","dataCount","create","p","remove","ds","cachedFrame","Error","def","timeFormat","symbol","locales","source1","source2","load","number","locale","time","formatDate","date","formatDateTime","dateTime","n","Math","round","pow","WIDTH","HEIGHT","sizeValue","getSize","element","width","height","getWidth","widthElement","getWidthElement","getHeight","heightElement","getHeightElement","el","getParentElementRect","elementWidth","elementHeight","w","getBoundingClientRect","s","select","left","padding","style","right","bottom","parent","node","tagName","parentNode","substring","CONTAINERS","visuals","visualPrototype","visualType","visualParent","getModel","$child","$new","$update","$on","draw","refSize","minSize","maxSize","max","min","container","idx","live","splice","viewBase","proto","opts","Visual","viewModel","events","types","createVisual","append","classed","sel","layers","drawCount","__visual__","uid","fit","clear","e","visual","toString","VisualClass","resize","currentSize","viewDebug","paper","inBrowser","observer","MutationObserver","visualManager","observe","document","documentElement","records","nodes","removedNodes","nodeName","selectAll","destroy","viz","objectOnly","toUpperCase","protos","vizPrototype","chartPrototype","apply","_paper","paperType","render","PaperType","papers","isFunction","xt","yt","camelFunction","d3_scale","doDraw","displayError","err","createPaper","Paper","paperPrototype","box","attr","cname","enter","Svg","svg","menu","on","display","insert","refreshMenu","minHeight","maxHeight","formats","specifier","fmt","format","dataContext","cachedFormat","dataStore","getContext","context","isViz","setupLayer","setupVisual","addSources","layer","$set","resizeDelay","viewDebounce","window","title","menuTitle","maxFontSize","fontSize","minFontSize","html","px","KEYS","LEFTRIGHT","margin","boundingBox","calculate","margins","axisOrientation","axisTop","axisBottom","axisLeft","axisRight","xAxis","axis","orientation","scale","colorScales","color","scaleSequential","interpolateViridis","interpolateInferno","interpolateMagma","interpolatePlasma","interpolateWarm","interpolateCool","interpolateRainbow","interpolateCubehelixDefault","colors","scaleDef","minPoints","scaleMinPoints","points","domain","reversed","legend","legends","legendColor","legendSize","legendSymbol","vizModel","lgModel","legendType","orient","titleWidth","titleMinWidth","titleMaxWidth","g","bb","locations","location","getBBox","translate","topLeft","topRight","bottomLeft","bottomRight","innerWidth","offsetY","offsetX","table","require","clusterize","Clusterize","cl","tableClass","striped","over","bordered","small","vizComponent","props","attrs","inner","getSchema","schema","build","input","createElement","root","class","VisualContainer","visualDashboard","mountInner","addVisual","parsers","isoParse","formatters","columns","col","properties","label","hidden","$parse","string","$html","tableTpl","plugins","template","createColumns","promises","promise","plugin","tablePlugins","isPromise","viewElement","vm","dataLoader","loadingData","addData","newData","delayData","id","rows","__data__","addComponent","dashboard","tabular","constant","b","NaN","identity","pad","base","pyramid","j","k","fraction","hi","v0","ph","pj","r","polygons","sort","descending","sqrt","_","lineDrawing","obj","d3_shape","agg","extent","createChart","newRange","meta","keys","lines","strokeColor","curve","lineWidth","merge","strokeOpacity","line","exit","ranges","getScale","scaleX","scaleY","innerHeight","bars","sx","sy","sz","stacked","xrect","x0","yrect","y0","yi","rangeRound","paddingInner","bandwidth","bardim","pivot","stack","normalize","nice","rects","stroke","fillOpacity","transition","x1","tickSizeOuter","pi","PI","rad","proportional","outerRadius","innerRadius","angles","pie","padAngle","startAngle","endAngle","arcs","arc","cornerRadius","proportionalData","slices","expr","legendLabel","fractionFormat","labels","scaleOrdinal","point","moveTo","lineTo","closePath","marks","polygon","segments"],"mappings":"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"}