!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("d3-array"),require("d3-let"),require("d3-random")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-let","d3-random"],r):r(t.d3={},t.d3,t.d3Let,t.d3Random)}(this,function(t,r,n,e){"use strict";function i(t){if(t<1||t>y.length)throw new Error("Out of range dimension");var r,n=[],e=[],i=[],o=[],a=y,s=0;for(Object.defineProperties(this,{dimension:{get:function(){return t}},count:{get:function(){return s}}}),this.next=function(){if(0===s)return s++,i.slice();for(var n=[],a=1,h=s-1;1==(1&h);)h>>=1,a++;for(r=0;r<t;r++)o[r]^=e[r][a],n[r]=o[r]/g;return s++,n},r=0;r<=v;r++)n.push(0);for(r=0;r<t;r++)e[r]=n.slice(),o[r]=0,i[r]=0;for(r=1;r<=v;r++)e[0][r]=1<<v-r;for(var h=1;h<t;h++){var u=a[h].split(/\s+/),f=+u[1],d=+u[2],p=[0];for(r=0;r<f;r++)p.push(+u[3+r]);for(r=1;r<=f;r++)e[h][r]=p[r]<<v-r;for(r=f+1;r<=v;r++){e[h][r]=e[h][r-f]^e[h][r-f]>>f;for(var c=1;c<=f-1;c++)e[h][r]^=(d>>f-1-c&1)*e[h][r-c]}}}function o(t){return t instanceof o?t:(new a).addTenure(t)}function a(){this.$months=0,this.$days=0,Object.defineProperties(this,{years:{get:function(){return Math.trunc(this.$months/12)}},months:{get:function(){return this.$months%12}},weeks:{get:function(){return Math.trunc(this.$days/7)}},days:{get:function(){return this.$days%7}},totalDays:{get:function(){return 30*this.$months+this.$days}}})}function s(){return new h}function h(){this.root=null}function u(t){this.score="number"==typeof t?t:t.score,this.value=t.value,this.parent=null,this.left=null,this.right=null,this.red=!1,Object.defineProperty(this,"root",{get:function(){return this.parent?this.parent.root:this}})}function f(t){var r;return t.parent&&t.parent.red?(t.parent===t.parent.parent.left?(r=t.parent.parent.right)&&r.red?(t.parent.red=!1,r.red=!1,t.parent.parent.red=!0,t=t.parent.parent):(t===t.parent.right&&d(t=t.parent),t.parent.red=!1,t.parent.parent.red=!0,p(t.parent.parent)):(r=t.parent.parent.left)&&r.red?(t.parent.red=!1,r.red=!1,t.parent.parent.red=!0,t=t.parent.parent):(t===t.parent.left&&p(t=t.parent),t.parent.red=!1,t.parent.parent.red=!0,d(t.parent.parent)),f(t)):(t=t.root,t.red=!1,t)}function d(t){var r=t.right;t.right=r.left,r.left&&(r.left.parent=t),r.parent=t.parent,t.parent&&(t===t.parent.left?t.parent.left=r:t.parent.right=r),r.left=t,t.parent=r}function p(t){var r=t.left;t.left=r.right,r.right&&(r.right.parent=t),r.parent=t.parent,t.parent&&(t===t.parent.right?t.parent.right=r:t.parent.left=r),r.right=t,t.parent=r}function c(t){return new l(t)}function l(t){Object.assign(this,w,t)}function m(t,r,n,e,i){return{period:t,outstanding:r,totalInterest:n||0,principal:e||0,interest:i||0,payment:(e||0)+(i||0)}}var v=52,g=2<<51,y=["d       s       a       m_i","2       1       0       1","3       2       1       1 3","4       3       1       1 3 1","5       3       2       1 1 1","6       4       1       1 1 3 3","7       4       4       1 3 5 13","8       5       2       1 1 5 5 17","9       5       4       1 1 5 5 5","10      5       7       1 1 7 11 1"];i.prototype={generate:function(t){for(var r=[],n=0;n<t;++n)r.push(this.next());return r}};var M=Object.freeze({euclidean:function(t,r){for(var n=0,e=0;e<t.length;e++)n+=Math.pow(r[e]-t[e],2);return Math.sqrt(n)}}),x={Y:"Years",M:"Months",W:"Weeks",D:"Days"};a.prototype=o.prototype={addTenure:function(t){if(t instanceof o)this.$months+=t.$months,this.$days+=t.$days;else{var r,n,e=(""+t).toUpperCase(),i=0,a="DWMY"[i],s=1;for("-"===e[0]&&(s=-1,e=e.substring(1));e.length;){if(!a)throw new Error('Unknown period "'+t+'"');if(-1!=(r=e.indexOf(a))){for(n=0;r-n-1>=0&&+e[r-n-1]==+e[r-n-1];)n++;if(!n)throw new Error('Unknown period "'+t+'"');this["add"+x[a]](s*e.substring(r-n,r)),e=e.substring(0,r-n)+e.substring(r+1)}else a="DWMY"[++i]}}return this},addDays:function(t){this.$days+=t},addWeeks:function(t){this.$days+=7*t},addMonths:function(t){this.$months+=t},addYears:function(t){this.$months+=12*t}};h.prototype=s.prototype={insert:function(t,r){this.root?this.root=this.root.insert(t,r):(this.root=new u(t),r&&r(this.root))},size:function(){return this.root?this.root.size():0},maxDepth:function(){return this.root?this.root.maxDepth():0},traverse:function(t){this.root&&this.root.traverse(t)},traverseInOrder:function(t){this.root&&this.root.traverseInOrder(t)},nodes:function(){return this.root?this.root.nodes():[]},links:function(){return this.root?this.root.links():[]}},u.prototype={insert:function(t,r){var n,e="number"==typeof t?t:t.score;if(e>this.score){if(this.right)return this.right.insert(t);this.right=n=new u(e)}else{if(this.left)return this.left.insert(t);this.left=n=new u(e)}n.red=!0,n.parent=this;var i=f(n);return r&&r(n),i},size:function(){var t=0;return this.traverse(function(){t++}),t},depth:function(){return this.parent?this.parent.depth()+1:0},maxDepth:function(){var t=this.left?this.left.maxDepth()+1:0,r=this.right?this.right.maxDepth()+1:0;return Math.max(t,r)},traverse:function(t){t(this),this.left&&this.left.traverse(t),this.right&&this.right.traverse(t)},traverseInOrder:function(t){this.left&&this.left.traverseInOrder(t),t(this),this.right&&this.right.traverseInOrder(t)},nodes:function(){var t=[];return this.traverseInOrder(function(r){t.push(r)}),t},links:function(){var t=[];return this.traverse(function(r){r.parent&&t.push({source:r.parent.index,target:r.index})}),t}};var b={tolerance:1e-6,epsilon:1e-12,maxIterations:20},w={interestRate:6.5,loanAmmount:1e4,feeRate:2,deferred:0,monthlyPayment:0,term:36};l.prototype=c.prototype={fromRate:function(){var t=[],r=function(t){return function(r,n){var e=t.loanAmmount,i=0,o=void 0,a=void 0,s=0;n&&n.push(m(0,e));for(var h=1;h<=t.term;++h)h>t.deferred&&(e+=i),o=t.interest(e),h>t.deferred?a=r-o:(i+=o,a=0,o=0),e-=a,n&&(s+=o,n.push(m(h,e,s,a,o)));return e}}(this),n=this.loanAmmount/this.term;return this.monthlyPayment=function(t,r,n,e){for(var i=(e=e||{}).tolerance||b.tolerance,o=e.epsilon||b.epsilon,a=e.maxIterations||b.maxIterations,s=n,h=void 0,u=0;u<a;++u){if(h=r(n),Math.abs(h)<o)return s;if(s=n-t(n)/h,Math.abs(s-n)<i)return s;n=s}return s}(r,function(t){return function(r){var n=.001*r;return.5*(t(r+n)-t(r-n))/n}}(r),n),r(this.monthlyPayment,t),t},interest:function(t){return.01*this.interestRate*t/12}};var $={sigma:.1,drift:0};t.sobol=function(t){return new i(t)},t.kmeans=function(){var t,n,e=300,i={centroids:function(t){return arguments.length?(n=t,i):n},maxIters:function(t){return arguments.length?(e=+t,i):e},distance:function(r){return arguments.length?("string"==typeof(r=r||"euclidean")&&(r=M[r]),t=r,i):t},randomCentroids:function(t,r){var n=t.slice(0);return n.sort(function(){return Math.round(Math.random())-.5}),n.slice(0,r)},classify:function(r){var e=1/0,i=0,o=void 0,a=void 0;for(o=0;o<n.length;o++)(a=t(r,n[o]))<e&&(e=a,i=o);return i},cluster:function(t,e){var o,a,s,h=0,u=!0,f=t.length;n||(n=i.randomCentroids(t,f),i.centroids(n));var d=n.length,p=new Array(d);if(f<d)throw Error("Number of points less than the number of clusters in K-means classification");for(;u&&h<i.maxIters();){for(u=!1,++h,s=0;s<d;++s)p[s]={centroid:n[s],points:[],indices:[]};for(a=0;a<f;a++)p[s=i.classify(t[a])].points.push(t[a]),p[s].indices.push(a);for(o=[],s=0;s<d;++s){if(!p[s].points.length){o=i.randomCentroids(t,d);break}o.push(r.mean(p[s].points))}for(s=0;s<d;++s)if(o[s]!=n[s]){n=o,u=!0;break}i.centroids(n),e&&e(p,h)}return p}};return i.distance("euclidean")},t.poisson=function(t,r,n){function e(t,r){var n=[t,r];return f.push(n),u[s*(r/a|0)+(t/a|0)]=n,++p,++d,n}var i=n*n,o=3*i,a=n*Math.SQRT1_2,s=Math.ceil(t/a),h=Math.ceil(r/a),u=new Array(s*h),f=[],d=0,p=0;return function(){if(!p)return e(Math.random()*t,Math.random()*r);for(;d;){for(var n=Math.random()*d|0,c=f[n],l=0;l<30;++l){var m=2*Math.PI*Math.random(),v=Math.sqrt(Math.random()*o+i),g=c[0]+v*Math.cos(m),y=c[1]+v*Math.sin(m);if(0<=g&&g<t&&0<=y&&y<r&&function(t,r){var n=t/a|0,e=r/a|0,o=Math.max(n-2,0),f=Math.max(e-2,0),d=Math.min(n+3,s),p=Math.min(e+3,h);for(e=f;e<p;++e){var c=e*s;for(n=o;n<d;++n)if(l=u[c+n]){var l,m=l[0]-t,v=l[1]-r;if(m*m+v*v<i)return!1}}return!0}(g,y))return e(g,y)}f[n]=f[--d],f.length=d}}},t.period=o,t.round=function(t,r){return r?Math.round(t*(r=Math.pow(10,r)))/r:Math.round(t)},t.binaryTree=s,t.amortisation=c,t.randomPath=function(t,i){i=n.assign({},$,i);for(var o,a=r.range(0,+t,1),s=i.sigma,h=i.drift,u=[{x:0,y:0}],f=e.randomNormal(0,1),d=1;d<a.length;d++)o=h+s*f(),u[d]={x:d,y:u[d-1].y+o};return u},t.quantVersion="0.4.3",Object.defineProperty(t,"__esModule",{value:!0})});